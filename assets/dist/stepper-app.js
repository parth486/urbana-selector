import{f as de,u as ue,a as me,c as pe,j as e,b as L,I as v,R as M,r as y,d as q,e as U,i as V,s as he,l as fe,g as ge,h as xe}from"./client.js";import{i as be,a as we,b as X,p as Q,c as Z,T as ye}from"./productData.js";import{m as E}from"./proxy.js";import{c as je,t as ie,a as G}from"./chunk-ML27DD5T.js";import{t as oe,c as le,a as ve,d as Ne,p as Se,H as _e}from"./middleware.js";import"./accelerated-values.js";import"./create-visual-element.js";var ce=de((t,a)=>{var s;const{as:r,className:p,children:c,...l}=t,i=r||"div",x=ue(a),{slots:w,classNames:g}=me(),_=pe(g==null?void 0:g.footer,p);return e.jsx(i,{ref:x,className:(s=w.footer)==null?void 0:s.call(w,{class:_}),...l,children:c})});ce.displayName="HeroUI.CardFooter";var ke=ce;const Ce=({currentStep:t,totalSteps:a,onNext:s,onPrevious:r,canProceed:p,isLastStep:c,isSubmitting:l,isSubmitted:i,onSubmit:x})=>e.jsxs("div",{className:"flex justify-between items-center pt-4",children:[e.jsx("div",{children:t>1&&e.jsx(L,{variant:"flat",color:"default",onPress:r,startContent:e.jsx(v,{icon:"lucide:arrow-left",width:18}),children:"Previous"})}),e.jsxs("div",{className:"text-default-500 text-sm",children:["Step ",t," of ",a]}),e.jsx("div",{children:c?e.jsx(L,{color:"primary",isDisabled:!p||l||i,isLoading:l,onPress:x,endContent:!l&&!i&&e.jsx(v,{icon:"lucide:send",width:18}),children:i?e.jsxs(E.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},className:"flex items-center gap-2",children:[e.jsx(v,{icon:"lucide:check",width:18}),"Submitted"]}):"Submit"}):e.jsx(L,{color:"primary",isDisabled:!p,onPress:s,endContent:e.jsx(v,{icon:"lucide:arrow-right",width:18}),children:"Next"})})]}),Pe=({currentStep:t,totalSteps:a,steps:s,selections:r,onStepClick:p})=>{const c=l=>l===1?!0:l===2?!!r.productGroup:l===3?!!r.productRange:l===4||l===5||l===6?!!r.individualProduct:!1;return e.jsx("div",{className:"hidden md:block mb-8",children:e.jsx("div",{className:"flex items-center justify-between",children:s.map(l=>{const i=l.step===t,x=l.step<t,w=c(l.step);return e.jsxs(M.Fragment,{children:[e.jsxs("div",{className:"flex flex-col items-center relative",children:[e.jsx("button",{className:`w-10 h-10 rounded-full flex items-center justify-center transition-all duration-200 ${i?"bg-primary text-white":x?"bg-success text-white":"bg-default-100 text-default-500"} ${w?"cursor-pointer hover:opacity-80":"cursor-not-allowed opacity-60"}`,onClick:()=>w&&p(l.step),disabled:!w,"aria-label":`Go to step ${l.step}: ${l.title}`,children:x?e.jsx(v,{icon:"lucide:check",width:20}):e.jsx("span",{children:l.step})}),e.jsx("span",{className:`text-xs mt-2 text-center max-w-[80px] ${i?"text-primary font-medium":"text-default-500"}`,children:l.title})]}),l.step<a&&e.jsx("div",{className:"flex-1 h-[2px] mx-2 bg-default-200",children:e.jsx("div",{className:"h-full bg-primary transition-all duration-300",style:{width:x?"100%":"0%"}})})]},l.step)})})})},Ee=({data:t,selection:a,onSelect:s})=>{const r=y.useMemo(()=>{var l;return t.productGroups&&Array.isArray(t.productGroups)?t.productGroups.filter(i=>i.active!==!1):((l=t.categories)==null?void 0:l.map(i=>({id:i.toLowerCase().replace(/\s+/g,"-"),name:i,icon:Me(i),description:Oe(i),active:!0})))||[]},[t.productGroups,t.categories]),p={hidden:{opacity:0},show:{opacity:1,transition:{staggerChildren:.1}}},c={hidden:{opacity:0,y:20},show:{opacity:1,y:0}};return e.jsxs("div",{children:[e.jsx("p",{className:"text-default-600 mb-6",children:"Please select a product category to begin your configuration."}),e.jsx(E.div,{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4",variants:p,initial:"hidden",animate:"show",children:r.map(l=>e.jsx(E.div,{variants:c,children:e.jsx(q,{isPressable:!0,onPress:()=>s(l.name),className:`transition-all duration-200 ${a===l.name?"border-2 border-primary shadow-md":"border border-default-200 hover:border-primary hover:shadow-sm"}`,children:e.jsxs(U,{className:"flex flex-col items-center text-center p-6",children:[e.jsx("div",{className:`w-12 h-12 rounded-full flex items-center justify-center mb-3 ${a===l.name?"bg-primary text-white":"bg-default-100 text-default-500"}`,children:e.jsx(v,{icon:l.icon,width:24})}),e.jsx("h3",{className:"text-lg font-medium",children:l.name}),e.jsx("p",{className:"text-default-500 text-sm mt-1",children:l.description})]})})},l.id))})]})};function Me(t){return{Shelter:"lucide:home",Toilet:"lucide:bath",Bridge:"lucide:route",Access:"lucide:wheelchair",Seating:"lucide:armchair",Lighting:"lucide:lamp"}[t]||"lucide:box"}function Oe(t){return{Shelter:"Outdoor structures for shade and protection",Toilet:"Public and portable sanitation facilities",Bridge:"Pedestrian and light vehicle crossings",Access:"Ramps, stairs, and accessibility solutions",Seating:"Benches and outdoor furniture options",Lighting:"Outdoor and pathway lighting solutions"}[t]||"Product category"}const De=({data:t,productGroup:a,selection:s,onSelect:r})=>{t.ranges[a];const p=y.useMemo(()=>{var x,w;if(t.productRanges&&t.relationships){const g=a.toLowerCase().replace(/\s+/g,"-"),_=((x=t.relationships.groupToRanges)==null?void 0:x[g])||[];return t.productRanges.filter(m=>_.includes(m.id)&&m.active!==!1)}return(((w=t.ranges)==null?void 0:w[a])||[]).map(g=>({id:g.toLowerCase().replace(/\s+/g,"-"),name:g,image:"",description:Ie(g),tags:Le(g),active:!0}))},[t.productRanges,t.relationships,t.ranges,a]),c={hidden:{opacity:0},show:{opacity:1,transition:{staggerChildren:.1}}},l={hidden:{opacity:0,y:20},show:{opacity:1,y:0}};return e.jsxs("div",{children:[e.jsxs("p",{className:"text-default-600 mb-6",children:["Select a product range from the ",a," category:"]}),e.jsx(E.div,{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",variants:c,initial:"hidden",animate:"show",children:p.map((i,x)=>{const w=s===i.name;return e.jsx(E.div,{variants:l,children:e.jsx(q,{isPressable:!0,onPress:()=>r(i.name),className:`transition-all duration-200 ${w?"border-2 border-primary shadow-md":"border border-default-200 hover:border-primary hover:shadow-sm"}`,children:e.jsx(U,{className:"p-0",children:e.jsxs("div",{className:"flex flex-col sm:flex-row",children:[i.image&&e.jsx(je,{className:"p-0",children:e.jsx(be,{src:i.image,alt:i.name,className:"w-full h-40 object-cover",radius:"none"})}),e.jsxs("div",{className:"p-4 flex-1",children:[e.jsx("h3",{className:"text-lg font-medium",children:i.name}),e.jsx("p",{className:"text-default-500 text-sm mt-2",children:i.description}),e.jsx("div",{className:"mt-3 flex flex-wrap gap-2",children:i.tags.map(g=>e.jsx("span",{className:"text-xs px-2 py-1 bg-default-100 text-default-700 rounded-medium",children:g},g))})]})]})})})},i.id)})})]})};function Ie(t){return{Peninsula:"Modern shelters with excellent weather protection for parks and urban settings",Whyalla:"Robust shelters designed for coastal and high-wind environments",Coastal:"Corrosion-resistant designs perfect for beachfront and marine locations",Urban:"Contemporary designs that blend with modern city landscapes",Heritage:"Traditional designs that complement historic and cultural settings",EcoSan:"Environmentally friendly composting toilet solutions with minimal water usage",Standard:"Reliable and cost-effective public toilet facilities",Accessible:"Fully compliant accessible toilet facilities with enhanced features",Premium:"High-end toilet facilities with superior finishes and amenities",Compact:"Space-saving designs for areas with limited footprint","Small Span":"Compact bridges for garden paths and small water crossings","Large Span":"Extended bridges for wider crossings and heavier loads",Pedestrian:"Dedicated walkways designed for high foot traffic areas","Decorative Bridge":"Ornamental bridges that serve as landscape features","Heavy Duty":"Reinforced bridges capable of supporting maintenance vehicles",Ramp:"Gentle slope access solutions for wheelchairs and strollers",Staircase:"Step access with various configurations and safety features",Pathway:"Connected walkway systems for parks and public spaces",Boardwalk:"Elevated walkways for wetlands and sensitive environments",Platform:"Viewing platforms and elevated observation areas",Bench:"Traditional seating options for parks and public spaces","Table Setting":"Combined table and seating arrangements for picnic areas",Lounge:"Comfortable extended seating for relaxation areas",Stadium:"Tiered seating solutions for sports and event venues",Custom:"Bespoke seating arrangements designed to specification",Solar:"Self-sufficient lighting powered by renewable energy","Mains Powered":"Connected lighting solutions with reliable performance","Decorative Light":"Aesthetic lighting features that enhance landscapes",Security:"High visibility lighting for safety and security","Pathway Light":"Directional lighting for walkways and pedestrian areas"}[t]||`${t} product line with various options and configurations.`}function Le(t,a){const s={Peninsula:["Modern","Weather-resistant","Versatile"],Whyalla:["Robust","Wind-resistant","Durable"],Coastal:["Corrosion-resistant","Salt-proof","UV-stable"],Urban:["Contemporary","Modular","Space-efficient"],Heritage:["Traditional","Ornate","Classic"],EcoSan:["Eco-friendly","Low-water","Composting"],Standard:["Cost-effective","Reliable","Low-maintenance"],Accessible:["ADA Compliant","Spacious","Universal"],Premium:["High-end","Enhanced features","Superior finishes"],Compact:["Space-saving","Efficient","Urban-friendly"],"Small Span":["Compact","Decorative","Easy-install"],"Large Span":["Extended","Reinforced","Heavy-load"],Pedestrian:["High-traffic","Safety-focused","Accessible"],Decorative:["Ornamental","Artistic","Feature piece"],"Heavy Duty":["Vehicle-rated","Industrial","Maximum strength"],default:["Quality","Durable","Customizable"]};return s[t]||s.default}const Re=({data:t,productRange:a,selection:s,onSelect:r})=>{t.products[a];const p=y.useMemo(()=>{var x;if(t.productsData&&t.relationships){const w=a.toLowerCase().replace(/\s+/g,"-"),g=t.relationships.rangeToProducts[w]||[];return t.productsData.filter(_=>g.includes(_.id)&&_.active!==!1)}return(((x=t.products)==null?void 0:x[a])||[]).map(w=>({id:w.toLowerCase(),code:w,name:`${w} Product`,overview:ee(w),description:ee(w),specifications:[],imageGallery:[],files:{},active:!0}))},[t.productsData,t.relationships,t.products,a]),c={hidden:{opacity:0},show:{opacity:1,transition:{staggerChildren:.05}}},l={hidden:{opacity:0,y:10},show:{opacity:1,y:0}};return e.jsxs("div",{children:[e.jsxs("p",{className:"text-default-600 mb-6",children:["Select a specific product from the ",a," range:"]}),e.jsx(E.div,{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4",variants:c,initial:"hidden",animate:"show",children:p.map(i=>{const x=s===i.code;return i.imageGallery.length>0,e.jsx(E.div,{variants:l,children:e.jsxs(q,{isPressable:!0,onPress:()=>r(i.code),className:`h-full w-full transition-all duration-200 ${x?"border-2 border-primary shadow-md":"border border-default-200 hover:border-primary hover:shadow-sm"}`,children:[e.jsxs(U,{className:"p-4",children:[e.jsx("div",{className:"flex items-center justify-center mb-3",children:e.jsx("h3",{className:"text-lg font-medium",children:i.name})}),e.jsx("p",{className:"text-default-500 text-sm text-center",children:i.overview||i.description}),i.specifications.length>0&&e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-xs font-semibold text-default-700 text-center",children:"Key Features:"}),e.jsxs("div",{className:"text-xs text-default-500",children:[i.specifications.slice(0,3).map((w,g)=>e.jsxs("div",{className:"flex items-start justify-center",children:[e.jsx(v,{icon:"lucide:check",width:14,className:"mr-1 mt-0.5 text-success"}),e.jsx("span",{children:w})]},g)),i.specifications.length>3&&e.jsxs("div",{className:"text-default-400 mt-1",children:["+",i.specifications.length-3," more features"]})]})]})]}),Object.keys(i.files).length>0&&e.jsx(ke,{className:"border-t border-default-100 px-4 py-2 justify-center",children:e.jsxs("div",{className:"flex items-center gap-2 text-xs text-default-600",children:[e.jsx(v,{icon:"lucide:file-text",width:14}),e.jsxs("span",{children:[Object.keys(i.files).length," document",Object.keys(i.files).length!==1?"s":""," available"]})]})})]})},i.id)})})]})};function ee(t){const a=t.match(/[A-Z]+\d+/),s=a?a[0]:t;return{K301:"Compact shelter with modern design, suitable for parks and urban settings.",K302:"Medium-sized shelter with extended roof coverage for picnic areas.",K308:"Large shelter with multiple seating options and enhanced weather protection.",K310:"Premium shelter with architectural design elements and superior materials.",K315:"Deluxe shelter with integrated seating and optional power connections.",E201:"Eco-friendly toilet with composting technology and minimal water usage.",E202:"Solar-powered toilet facility with self-contained waste management.",SS101:"Small pedestrian bridge for garden paths and decorative water crossings.",SS102:"Compact bridge with enhanced load capacity for light maintenance vehicles.",R101:"ADA compliant access ramp with gentle slope and non-slip surface.",R102:"Modular ramp system adaptable to various height requirements."}[s]||`${t} model with standard features and customization options.`}const A=new Map,W=new Map;async function H(t,a){if(!t)return null;if(A.has(t))return A.get(t);if(W.has(t))return W.get(t);const s=(async()=>{var l,i;const r=((l=window.urbanaPublic)==null?void 0:l.nonce)||((i=window.urbanaAdmin)==null?void 0:i.nonce)||"",p=await fetch("/wp-json/urbana/v1/image-proxy",{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":r},body:JSON.stringify({image_path:t})});if(!p.ok)throw new Error(`HTTP ${p.status}: ${p.statusText}`);const c=await p.json();if(c.success&&c.method==="presigned_url"&&c.image_url){const x={url:c.image_url,method:"presigned_url"};return A.set(t,x),W.delete(t),x}if(c.success&&c.image_data){const x={url:c.image_data,method:c.method||"base64"};return A.set(t,x),W.delete(t),x}throw W.delete(t),new Error(c.error||c.message||"Failed to fetch image")})();return W.set(t,s),s}const z=({imagePath:t,productCode:a,className:s="",alt:r="Product image",onClick:p,loading:c="lazy",fetchPriority:l="auto"})=>{var C,b;const[i,x]=y.useState(""),[w,g]=y.useState(!0),[_,m]=y.useState(""),[S,k]=y.useState(""),N=window.urbanaDebugMode||((C=window.urbanaAdmin)==null?void 0:C.debugMode)||((b=window.urbanaPublic)==null?void 0:b.debugMode)||!1;return y.useEffect(()=>{t&&(async()=>{var I,d;try{g(!0),m("");const n=((I=window.urbanaPublic)==null?void 0:I.nonce)||((d=window.urbanaAdmin)==null?void 0:d.nonce)||"";N&&console.log(`[SecureImage] Fetching: ${t}`,{productCode:a,nonce:n?"present":"missing",debugMode:N});try{const f=A.get(t);if(f){N&&console.log("[SecureImage] Using cached signed URL",t),k(f.method||"cached"),x(f.url);return}const u=await H(t,a);if(u){N&&console.log("[SecureImage] Prefetch result",u),k(u.method||"fetched"),x(u.url);return}}catch(f){N&&console.warn("[SecureImage] prefetchImage failed, falling back to inline fetch",f)}const h=await fetch("/wp-json/urbana/v1/image-proxy",{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":n},body:JSON.stringify({image_path:t})});if(!h.ok)throw new Error(`HTTP ${h.status}: ${h.statusText}`);const o=await h.json();if(N&&console.log(`[SecureImage] Response for ${t}:`,{method:o.method,success:o.success,hasImageUrl:!!o.image_url,hasImageData:!!o.image_data,error:o.error,message:o.message}),o.success)if(o.method==="presigned_url"&&o.image_url)N&&console.log("âœ… Using presigned URL method (instant loading from DO)"),k("presigned_url"),x(o.image_url),A.set(t,{url:o.image_url,method:"presigned_url"});else if(o.method==="base64_fallback"&&o.image_data)N&&console.log("âš ï¸ Using base64 fallback method (slower, full data transfer)"),k("base64_fallback"),x(o.image_data),A.set(t,{url:o.image_data,method:"base64_fallback"});else if(o.image_data)N&&console.log("âš ï¸ Using legacy base64 format"),k("base64_legacy"),x(o.image_data),A.set(t,{url:o.image_data,method:"base64_legacy"});else if(o.imageData)N&&console.log("âš ï¸ Using legacy imageData format"),k("imageData_legacy"),x(o.imageData),A.set(t,{url:o.imageData,method:"imageData_legacy"});else throw N&&console.error("No image URL or data received from server"),new Error("No image URL or data received");else if(o.use_svg_icon)N&&console.warn("Server requested SVG icon fallback:",o.error),k("svg_fallback"),m("Failed to load image - using SVG icon instead");else throw new Error(o.error||o.message||"Failed to get image")}catch(n){N&&console.error(`[SecureImage] Fetch error for ${t}:`,n.message,n),m(n.message)}finally{g(!1)}})()},[t,a]),w?e.jsx("div",{className:`${s} bg-gray-100 animate-pulse flex items-center justify-center`,children:e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",className:"text-gray-400",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"2",fill:"none"}),e.jsx("path",{d:"M12 6v6l4 2",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]})}):_||!i?e.jsxs("div",{className:`${s} bg-orange-100 border-2 border-orange-300 flex items-center justify-center relative group`,title:_||"Image failed to load",children:[e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",className:"text-orange-600",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"2",fill:"none"}),e.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"}),e.jsx("line",{x1:"12",y1:"16",x2:"12.01",y2:"16",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})]}),N&&_&&e.jsxs("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 bg-gray-900 text-white text-xs rounded px-2 py-1 whitespace-nowrap opacity-0 group-hover:opacity-100 transition-opacity z-10 pointer-events-none",children:[_.substring(0,50),"..."]})]}):e.jsxs("div",{className:"relative group h-full",children:[e.jsx("img",{src:i,alt:r,className:s,loading:c,decoding:"async",fetchpriority:l,onClick:D=>{var d,n;(window.urbanaDebugMode||((d=window.urbanaAdmin)==null?void 0:d.debugMode)||((n=window.urbanaPublic)==null?void 0:n.debugMode)||!1)&&console.log("[SecureImage] image clicked",t),p&&p(D)},title:N&&S?`Loaded via: ${S}`:"",onError:()=>{m("Image load failed")}}),N&&S&&e.jsx("div",{className:"absolute top-0 left-0 bg-blue-500 text-white text-xs px-1.5 py-0.5 rounded opacity-70 group-hover:opacity-100 transition-opacity font-semibold",title:`Method: ${S}`,children:S==="presigned_url"?"ðŸ”— URL":S==="base64_fallback"?"ðŸ“¦ B64":"âš ï¸"})]})},Y=({data:t,contactInfo:a,onContactInfoChange:s,isSubmitting:r,isSubmitted:p,onSubmit:c,submitLabel:l,maxMessageLength:i=2e3})=>{M.useEffect(()=>{try{if(!L)try{window.__urbana_diag=window.__urbana_diag||{errors:[],events:[]},window.__urbana_diag.events.push({type:"missing_button_import",timestamp:new Date().toISOString()})}catch{}}catch{}},[]);const[x,w]=M.useState(!1),[g,_]=M.useState({}),m=(b,D)=>{const I=b==="message"&&typeof D=="string"?D.slice(0,i):D;s({...a,[b]:I}),g[b]&&_({...g,[b]:""})},S=()=>{const b={};return a.fullName.trim()||(b.fullName="Full name is required"),a.email.trim()?/^\S+@\S+\.\S+$/.test(a.email)||(b.email="Please enter a valid email address"):b.email="Email is required",x||(b.terms="You must accept the terms and conditions"),_(b),Object.keys(b).length===0},k=()=>{S()&&c()},N={hidden:{opacity:0},show:{opacity:1,transition:{staggerChildren:.1}}},C={hidden:{opacity:0,y:20},show:{opacity:1,y:0}};return p?e.jsxs(E.div,{className:"text-center py-8",initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:.5},children:[e.jsx("div",{className:"w-16 h-16 bg-success/20 rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx(v,{icon:"lucide:check",className:"text-success",width:32})}),e.jsx("h3",{className:"text-xl font-semibold mb-2",children:"Thank You!"}),e.jsx("p",{className:"text-default-600 max-w-md mx-auto mb-6",children:"Your product configuration has been submitted successfully. Our team will review your selections and contact you shortly with pricing and next steps."})]}):e.jsxs(E.div,{className:"space-y-6",variants:N,initial:"hidden",animate:"show",children:[e.jsx(E.p,{variants:C,className:"text-default-600",children:"Please provide your contact information to receive a detailed quote for your configured product."}),e.jsxs(E.div,{variants:C,className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(V,{label:"Full Name",placeholder:"Enter your full name",value:a.fullName,onValueChange:b=>m("fullName",b),isRequired:!0,isInvalid:!!g.fullName,errorMessage:g.fullName}),e.jsx(V,{label:"Email Address",placeholder:"Enter your email address",type:"email",value:a.email,onValueChange:b=>m("email",b),isRequired:!0,isInvalid:!!g.email,errorMessage:g.email})]}),e.jsxs(E.div,{variants:C,className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(V,{label:"Phone Number",placeholder:"Enter your phone number",type:"tel",value:a.phone,onValueChange:b=>m("phone",b)}),e.jsx(V,{label:"Company/Organization",placeholder:"Enter your company or organization",value:a.company,onValueChange:b=>m("company",b)})]}),e.jsxs(E.div,{variants:C,children:[e.jsx(oe,{label:"Additional Notes",placeholder:"Enter any specific requirements or questions",value:a.message,onValueChange:b=>m("message",b),minRows:3}),e.jsxs("div",{className:"text-xs text-default-500 mt-1",children:[(a.message||"").length,"/",i," characters"]})]}),e.jsxs(E.div,{variants:C,className:"space-y-4",children:[e.jsx(le,{isSelected:x,onValueChange:w,isInvalid:!!g.terms,children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{children:"I agree to the Terms and Conditions and Privacy Policy"}),g.terms&&e.jsx("span",{className:"text-danger text-xs mt-1",children:g.terms})]})}),e.jsx("div",{className:"bg-default-50 p-4 rounded-medium text-sm text-default-600",children:e.jsxs("p",{className:"flex items-start gap-2",children:[e.jsx(v,{icon:"lucide:shield",className:"text-default-500 mt-0.5 flex-shrink-0",width:16}),e.jsx("span",{children:"Your information is secure and will only be used to process your product inquiry. We will never share your details with third parties without your consent."})]})})]}),e.jsx(E.div,{variants:C,className:"pt-4",children:e.jsx(L,{color:"primary",size:"lg",className:"w-full md:w-auto",isDisabled:r,isLoading:r,onPress:k,endContent:!r&&e.jsx(v,{icon:"lucide:send",width:18}),children:l??"Submit Configuration"})})]})},te={productGroup:null,productRange:null,individualProduct:null,options:{},contactInfo:{fullName:"",email:"",phone:"",company:"",message:""}},R=ve()(Ne(Se((t,a)=>({productData:null,currentStep:1,selections:te,isSubmitting:!1,isSubmitted:!1,initializeProductData:()=>{const s=window.urbanaPublic;s!=null&&s.productData?(console.log("Initializing stepper with database product data"),t({productData:s.productData})):console.warn("No database product data found in window.urbanaPublic")},setProductData:s=>{t({productData:s})},setCurrentStep:s=>t({currentStep:s}),updateSelection:(s,r)=>t(p=>{const c={...p.selections};return s==="productGroup"?(c.productGroup=r,c.productRange=null,c.individualProduct=null):s==="productRange"?(c.productRange=r,c.individualProduct=null):s==="options"?c.options={...c.options,...r}:s==="contactInfo"?c.contactInfo={...c.contactInfo,...r}:c[s]=r,{selections:c}}),nextStep:()=>t(s=>({currentStep:Math.min(s.currentStep+1,6)})),previousStep:()=>t(s=>({currentStep:Math.max(s.currentStep-1,1)})),goToStep:s=>{var l,i;const{selections:r,productData:p}=a(),c=((i=(l=p==null?void 0:p.stepperForm)==null?void 0:l.steps)==null?void 0:i.length)||6;return s<1||s>c?!1:s===1||s===2&&r.productGroup||s===3&&r.productRange||s>=4&&r.individualProduct?(t({currentStep:s}),!0):!1},setSubmitting:s=>t({isSubmitting:s}),setSubmitted:s=>t({isSubmitted:s}),resetStepper:()=>t({currentStep:1,selections:te,isSubmitting:!1,isSubmitted:!1}),canProceedToStep:s=>{var l,i;const{selections:r,productData:p}=a(),c=((i=(l=p==null?void 0:p.stepperForm)==null?void 0:l.steps)==null?void 0:i.length)||6;if(s>c)return!1;switch(s){case 1:return!0;case 2:return!!r.productGroup;case 3:return!!r.productRange;case 4:case 5:case 6:return!!r.individualProduct;default:return!1}}}),{name:"urbana-stepper-storage",partialize:t=>({selections:t.selections,currentStep:t.currentStep})}),{name:"urbana-stepper"})),$=({open:t,onClose:a})=>{var D,I,d,n;const s=R(h=>h.productData),r=R(h=>h.selections),p=R(h=>h.setSubmitting),c=R(h=>h.setSubmitted);R(h=>h.updateSelection);const[l,i]=M.useState(()=>({...r.contactInfo})),[x,w]=M.useState(!1),[g,_]=M.useState(!1),[m,S]=M.useState(null);M.useEffect(()=>{t&&(i({...r.contactInfo,message:""}),_(!1))},[t,r.contactInfo]);const k=((d=(I=(D=s==null?void 0:s.stepperForm)==null?void 0:D.steps)==null?void 0:I[5])==null?void 0:d.fields)||[],N=h=>{i(h)};M.useEffect(()=>{try{if(!Y)try{window.__urbana_diag=window.__urbana_diag||{errors:[],events:[]},window.__urbana_diag.events.push({type:"missing_step6_component",timestamp:new Date().toISOString()})}catch{}}catch{}},[]);const C=async()=>{var h;try{w(!0),p(!0);const o={productGroup:r.productGroup,productRange:r.productRange,individualProduct:r.individualProduct,options:r.options,contactInfo:l},f=await fetch("/wp-json/urbana/v1/submit-form",{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":((h=window.urbanaPublic)==null?void 0:h.nonce)||""},body:JSON.stringify({selections:o,submittedAt:new Date().toISOString()})});let u=null;try{u=await f.json()}catch{try{u=await f.text()}catch{u=null}}try{window.__urbana_diag=window.__urbana_diag||{errors:[],events:[]},window.__urbana_diag.events.push({type:"submit_response",timestamp:new Date().toISOString(),status:f.status,body:u})}catch{}_(!0),c(!0)}catch(o){console.error("Failed to submit enquiry",o),alert("Failed to submit enquiry. Please try again.")}finally{w(!1),p(!1)}};if(!t)return null;const b=M.useRef(null);if(M.useEffect(()=>{if(g&&b.current)try{b.current.focus()}catch{}},[g,m]),M.useEffect(()=>{try{window.__urbana_diag=window.__urbana_diag||{errors:[],events:[]},window.__urbana_diag.events.push({type:"contact_modal_mount",timestamp:new Date().toISOString(),open:t})}catch{}return()=>{try{window.__urbana_diag.events.push({type:"contact_modal_unmount",timestamp:new Date().toISOString()})}catch{}}},[]),g){try{window.__urbana_diag=window.__urbana_diag||{errors:[],events:[]},window.__urbana_diag.events.push({type:"submit_ui_shown",timestamp:new Date().toISOString(),status:(m==null?void 0:m.status)??null})}catch{}return e.jsxs("div",{className:"fixed inset-0 z-60 flex items-center justify-center p-4",role:"dialog","aria-modal":"true",children:[e.jsx("div",{className:"fixed inset-0 bg-black/60",onClick:a,"aria-hidden":"true"}),e.jsxs("div",{className:"relative w-full max-w-2xl bg-white rounded-medium shadow-lg z-10 p-6 max-h-[85vh] overflow-auto",children:[e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"w-16 h-16 bg-success/20 rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx(v,{icon:"lucide:check",className:"text-success",width:32})}),e.jsx("h3",{className:"text-xl font-semibold mb-2",children:"Thank You!"}),e.jsxs("p",{className:"text-default-600 max-w-md mx-auto mb-6",children:["Your enquiry has been submitted successfully.",(n=m==null?void 0:m.body)!=null&&n.id?e.jsxs("span",{children:[" Reference: ",String(m.body.id)]}):null]}),m&&e.jsxs("div",{className:"mt-4 p-3 bg-default-50 rounded text-xs text-default-600",children:[e.jsx("strong",{children:"Server response:"}),e.jsxs("div",{children:["Status: ",String(m.status)]}),e.jsx("pre",{className:"mt-2 text-xs whitespace-pre-wrap",children:typeof m.body=="string"?m.body:JSON.stringify(m.body,null,2)})]})]}),e.jsx("div",{className:"mt-6 flex justify-end",children:e.jsx(L,{ref:b,color:"primary",onPress:a,"aria-label":"Close enquiry dialog",children:"Close"})})]})]})}return e.jsxs("div",{className:"fixed inset-0 z-60 flex items-center justify-center p-4",role:"dialog","aria-modal":"true",children:[e.jsx("div",{className:"fixed inset-0 bg-black/60",onClick:g?a:void 0,"aria-hidden":"true"}),e.jsxs("div",{className:"relative w-full max-w-2xl bg-white rounded-medium shadow-lg z-10 p-6 max-h-[85vh] overflow-auto",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Enquire about this product"}),e.jsx("p",{className:"text-sm text-default-500",children:"Leave your contact details and we will get back to you with pricing and next steps."})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(L,{variant:"flat",color:"default",onPress:()=>i({fullName:"",email:"",phone:"",company:"",message:""}),"aria-label":"Clear enquiry form",children:"Clear"}),e.jsx(L,{variant:"flat",color:"default",onPress:a,"aria-label":"Close enquiry dialog",children:e.jsx(v,{icon:"lucide:x",width:18})})]})]}),e.jsx("div",{children:(()=>{if(typeof Y!="function")return e.jsxs("div",{className:"p-4 bg-warning/5 border border-warning/10 rounded-medium",children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Error loading enquiry form"}),e.jsx("p",{className:"text-sm text-default-600",children:"The contact form component could not be rendered. This is likely a build/import issue. See the console for diagnostic details."}),e.jsx("pre",{className:"text-xs mt-2",children:JSON.stringify({Step6ContactInfo:typeof Y,Input:typeof V,Textarea:typeof oe,Checkbox:typeof le,Button:typeof L},null,2)})]});try{return e.jsx(Y,{data:{fields:k},contactInfo:l,onContactInfoChange:h=>N(h),isSubmitting:x,isSubmitted:g,onSubmit:C,submitLabel:"Enquire Now",maxMessageLength:2e3})}catch(h){try{window.__urbana_diag=window.__urbana_diag||{errors:[],events:[]},window.__urbana_diag.errors.push({type:"render_error_step6",message:String(h&&h.message),stack:h&&h.stack})}catch{}return e.jsxs("div",{className:"p-4 bg-warning/5 border border-warning/10 rounded-medium",children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Error rendering enquiry form"}),e.jsx("p",{className:"text-sm text-default-600",children:"An unexpected error occurred while rendering the form. See diagnostics for details."}),e.jsx("pre",{className:"text-xs mt-2",children:String(h&&h.message)})]})}})()}),m&&e.jsxs("div",{className:"mt-4 p-3 bg-default-50 rounded text-xs text-default-600",children:[e.jsx("strong",{children:"Last submission:"}),e.jsxs("div",{children:["Status: ",String(m.status)]}),e.jsx("pre",{className:"mt-2 text-xs whitespace-pre-wrap",children:typeof m.body=="string"?m.body:JSON.stringify(m.body,null,2)})]}),g&&e.jsx("div",{className:"mt-6 flex justify-end",children:e.jsx(L,{ref:b,color:"primary",onPress:a,"aria-label":"Close enquiry dialog",children:"Close"})})]})]})},K=({images:t,productCode:a="",open:s,initialIndex:r=0,onClose:p,onIndexChange:c})=>{var g,_;const[l,i]=M.useState(r);try{(window.urbanaDebugMode||((g=window.urbanaAdmin)==null?void 0:g.debugMode)||((_=window.urbanaPublic)==null?void 0:_.debugMode)||!1)&&console.warn("[Lightbox] props",{open:s,initialIndex:r,imagesLength:t==null?void 0:t.length,productCode:a})}catch{}if(y.useEffect(()=>{i(r)},[r]),y.useEffect(()=>{if(s)try{t[l+1]&&H(t[l+1],a).catch(()=>{}),t[l-1]&&H(t[l-1],a).catch(()=>{})}catch{}},[s,l,t,a]),y.useEffect(()=>{var k,N;if((window.urbanaDebugMode||((k=window.urbanaAdmin)==null?void 0:k.debugMode)||((N=window.urbanaPublic)==null?void 0:N.debugMode)||!1)&&console.warn("[Lightbox] effect open changed",{open:s,index:l,imagesLength:t.length}),!s)return;const S=C=>{console.warn("[Lightbox] keydown",C.key),C.key==="Escape"&&p(),C.key==="ArrowLeft"&&i(b=>Math.max(0,b-1)),C.key==="ArrowRight"&&i(b=>Math.min(t.length-1,b+1))};return window.addEventListener("keydown",S),()=>window.removeEventListener("keydown",S)},[s,t.length,p]),y.useEffect(()=>{window.urbanaDebugMode&&console.log(`[Lightbox] open: ${s}, index: ${l}, images: ${t.length}`)},[s,l,t.length]),y.useEffect(()=>{c&&c(l)},[l]),!s)return null;const x=()=>{window.urbanaDebugMode&&console.log("[Lightbox] prev clicked"),i(m=>Math.max(0,m-1))},w=()=>{window.urbanaDebugMode&&console.log("[Lightbox] next clicked"),i(m=>Math.min(t.length-1,m+1))};return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/70 p-4",children:e.jsxs("div",{className:"relative w-full max-w-6xl mx-auto",children:[e.jsx("button",{"aria-label":"Close",onClick:()=>{window.urbanaDebugMode&&console.log("[Lightbox] close clicked"),p()},className:"absolute right-2 top-2 z-50 rounded-full bg-white/10 hover:bg-white/20 p-2 text-white",children:e.jsx(v,{icon:"lucide:x",width:18})}),e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx("button",{"aria-label":"Previous",onClick:x,className:"flex items-center justify-center w-10 h-10 md:w-12 md:h-12 rounded-full bg-white/10 hover:bg-white/20 text-white mr-4",children:e.jsx(v,{icon:"lucide:chevron-left",width:20})}),e.jsx("div",{className:"flex-1 flex items-center justify-center",children:e.jsx("div",{className:"max-h-[85vh] w-full flex items-center justify-center",children:e.jsx(z,{imagePath:t[l],productCode:a,className:"max-w-full max-h-[85vh] object-contain",alt:`Image ${l+1} of ${t.length}`,loading:"eager",fetchPriority:"high"})})}),e.jsx("button",{"aria-label":"Next",onClick:w,className:"flex items-center justify-center w-10 h-10 md:w-12 md:h-12 rounded-full bg-white/10 hover:bg-white/20 text-white ml-4",children:e.jsx(v,{icon:"lucide:chevron-right",width:20})})]}),t.length>1&&e.jsx("div",{className:"mt-4 flex gap-2 overflow-x-auto px-2",children:t.map((m,S)=>e.jsx("button",{onClick:()=>i(S),onMouseEnter:()=>H(m).catch(()=>{}),className:`flex-shrink-0 w-20 h-20 rounded-small overflow-hidden border-2 ${S===l?"border-primary":"border-transparent"}`,"aria-label":`View image ${S+1}`,children:e.jsx(z,{imagePath:m,productCode:a,className:"w-full h-full object-cover",alt:`Thumb ${S+1}`,loading:"lazy"})},S))})]})})},qe=({data:t,productId:a})=>{const s=t.productDetails[a],r=window.urbanaDebugMode||!1;y.useEffect(()=>{try{const d=[];z||d.push("SecureImage"),K||d.push("Lightbox"),$||d.push("ContactModal"),v||d.push("Icon"),d.length>0&&console.error("[Step4] Missing imports detected:",d)}catch{}},[]);const p=y.useCallback(async(d,n)=>{try{const h=d.includes("digitaloceanspaces.com");let o=d;if(h)try{let j=(new URL(d).pathname||"").replace(/^\//,"");if(j){const P=new URL("/wp-json/urbana/v1/proxy-download",window.location.origin);P.searchParams.set("path",j),o=P.toString()}else{const P=new URL("/wp-json/urbana/v1/proxy-download",window.location.origin);P.searchParams.set("url",d),o=P.toString()}}catch{const j=new URL("/wp-json/urbana/v1/proxy-download",window.location.origin);j.searchParams.set("url",d),o=j.toString()}else if(!/^https?:\/\//i.test(d)){const u=new URL("/wp-json/urbana/v1/proxy-download",window.location.origin);u.searchParams.set("path",d),o=u.toString()}const f=document.createElement("a");f.href=o,f.download=n,f.style.display="none",f.target="_blank",document.body.appendChild(f),f.click(),document.body.removeChild(f)}catch(h){r&&console.error("Download failed:",h),alert("Failed to download file. Please try again or contact support.")}},[]);if(!s)return e.jsxs("div",{className:"text-center p-8",children:[e.jsx(v,{icon:"lucide:file-question",className:"mx-auto mb-4 text-default-400",width:48}),e.jsx("h3",{className:"text-xl font-medium mb-2",children:"Product Information Unavailable"}),e.jsxs("p",{className:"text-default-500",children:["Detailed information for ",a," is not available at this time. Please continue to the next step or contact our support team for assistance."]})]});const c={hidden:{opacity:0},show:{opacity:1,transition:{duration:.5}}},l=s.imageGallery.length>0?s.imageGallery[0]:"",i=y.useRef(null),[x,w]=y.useState(!1),[g,_]=y.useState(0),m=d=>{r&&console.warn(`[Step4] openLightboxAt called with index: ${d}`),_(d),w(!0)};y.useEffect(()=>{r&&console.warn("[Step4] lightboxOpen state changed",{lightboxOpen:x,lightboxIndex:g})},[x,g]);const S=()=>w(!1),[k,N]=y.useState(!1),[C,b]=y.useState(null),D=()=>{try{if(typeof $!="function"){b("ContactModal is not a function - check import/export");try{window.__urbana_diag=window.__urbana_diag||{errors:[],events:[]},window.__urbana_diag.events.push({type:"contact_modal_invalid",value:String($)})}catch{}return}}catch(d){try{window.__urbana_diag=window.__urbana_diag||{errors:[],events:[]},window.__urbana_diag.errors.push({type:"step4_open_enquire_error",message:String(d&&d.message)})}catch{}}b(null),N(!0)},I=()=>N(!1);return y.useEffect(()=>{r&&console.log("[Step4] useEffect mount â€” Step4ProductContent mounted",{galleryRefPresent:!!i.current});const d=n=>{var h,o;try{const f=i.current;if(!f)return;r&&console.log("[Step4 gallery container click] event",n.type,"target:",(h=n.target)==null?void 0:h.tagName,"defaultPrevented",n.defaultPrevented);let u=n.target;for(;u&&u!==f;){if(u.nodeType!==Node.ELEMENT_NODE){u=u.parentNode;continue}const T=u,F=(o=T.getAttribute)==null?void 0:o.call(T,"data-gallery-index");if(F!=null){r&&console.log(`[Step4 gallery container click] index found: ${F}`),m(parseInt(F,10));return}const B=window.getComputedStyle(T);r&&console.log("[Step4 gallery container click] ancestor:",T.tagName,"pointer-events:",B.pointerEvents),u=u.parentNode}const j=n.clientX,P=n.clientY,O=f.querySelectorAll("[data-gallery-index]");for(let T=0;T<O.length;T++){const F=O[T],B=F.getBoundingClientRect();if(j>=B.left&&j<=B.right&&P>=B.top&&P<=B.bottom){const J=F.getAttribute("data-gallery-index");r&&console.log(`[Step4 gallery container click] bounding-match index: ${J}`),m(parseInt(J||"0",10));return}}}catch(f){console.error("Gallery handler error",f)}};return document.addEventListener("click",d,!0),()=>document.removeEventListener("click",d,!0)},[i,m,r]),e.jsxs(E.div,{className:"space-y-8",initial:"hidden",animate:"show",variants:c,children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-6",children:[e.jsx("div",{className:"w-full md:w-1/2",children:l?e.jsx("div",{"data-gallery-index":0,className:"cursor-pointer",onClick:()=>{r&&console.log("[Step4] featured image clicked index: 0"),m(0)},onMouseEnter:()=>{H(l).catch(()=>{})},children:e.jsx(z,{imagePath:l,productCode:a,alt:s.name,className:"w-full h-64 object-cover rounded-medium",onClick:()=>m(0),loading:"eager",fetchPriority:"high"})}):e.jsx("div",{className:"w-full h-64 bg-gray-100 rounded-medium flex items-center justify-center",children:e.jsx(v,{icon:"lucide:image",width:48,className:"text-gray-400"})})}),e.jsxs("div",{className:"w-full md:w-1/2",children:[e.jsx("h3",{className:"text-xl font-semibold mb-2",children:s.name}),e.jsx("p",{className:"text-default-600 mb-4",children:s.overview}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(v,{icon:"lucide:check-circle",className:"text-success",width:20}),e.jsx("span",{children:"In Stock"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(v,{icon:"lucide:truck",className:"text-default-500",width:20}),e.jsx("span",{children:"Standard Delivery: 2-4 weeks"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(v,{icon:"lucide:shield",className:"text-default-500",width:20}),e.jsx("span",{children:"10 Year Warranty"})]})]}),e.jsx("div",{className:"mt-4",children:e.jsx(L,{color:"primary",size:"md",onPress:D,endContent:e.jsx(v,{icon:"lucide:arrow-right",width:18}),"aria-label":"Enquire Now",children:"Enquire Now"})})]})]}),(()=>{if(!k)return null;try{if($==null||typeof $!="function"&&typeof $!="object"){console.error("[Step4] ContactModal invalid at render",$);try{window.__urbana_diag=window.__urbana_diag||{errors:[]},window.__urbana_diag.errors.push({type:"contact_modal_invalid",value:String($)})}catch{}return e.jsxs("div",{className:"p-4 bg-warning/5 border border-warning/10 rounded-medium",children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Enquiry form failed to open"}),e.jsx("p",{className:"text-sm text-default-600",children:"The enquiry form component is not available. This is likely a build/import issue. See the console for diagnostic details."}),e.jsx("pre",{className:"text-xs mt-2",children:JSON.stringify({ContactModal:String($),typeofContactModal:typeof $},null,2)})]})}return e.jsx($,{open:k,onClose:I})}catch(d){console.error("[Step4] Error mounting ContactModal",d,d&&d.stack);try{window.__urbana_diag=window.__urbana_diag||{errors:[]},window.__urbana_diag.errors.push({type:"contact_modal_mount_error",message:String(d&&d.message),stack:d&&d.stack})}catch{}return e.jsxs("div",{className:"p-4 bg-warning/5 border border-warning/10 rounded-medium",children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Enquiry form failed to open"}),e.jsx("p",{className:"text-sm text-default-600",children:"An error occurred while opening the enquiry form. See console for details."}),e.jsx("pre",{className:"text-xs mt-2",children:String(d&&d.message)})]})}})(),e.jsxs(ie,{"aria-label":"Product information tabs",variant:"underlined",color:"primary",children:[e.jsx(G,{title:"Details",children:e.jsx(q,{children:e.jsx(U,{className:"p-6",children:e.jsxs("div",{className:"prose max-w-none",children:[e.jsx("p",{className:"text-default-700",children:s.description}),e.jsx("h4",{className:"text-lg font-medium mt-6 mb-3",children:"Specifications"}),e.jsx("ul",{className:"space-y-2",children:s.specifications.map((d,n)=>e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(v,{icon:"lucide:chevron-right",className:"text-primary mt-1 flex-shrink-0",width:16}),e.jsx("span",{children:d})]},n))})]})})})},"details"),e.jsx(G,{title:"Image Gallery",children:e.jsx(q,{children:e.jsx(U,{className:"p-6",children:e.jsx("div",{ref:i,className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4",children:s.imageGallery.map((d,n)=>e.jsx("div",{"data-gallery-index":n,className:"aspect-square cursor-pointer pointer-events-auto",onClick:h=>{r&&console.log(`[Step4 wrapper click] index: ${n}`),h.stopPropagation(),m(n)},onMouseEnter:()=>{H(d).catch(()=>{})},children:e.jsx(z,{imagePath:d,productCode:a,alt:`${s.name} - Image ${n+1}`,className:"w-full h-full object-cover rounded-medium",onClick:()=>m(n),loading:"lazy"})},n))})})})},"gallery"),e.jsx(G,{title:"Downloads",children:e.jsx(q,{children:e.jsx(U,{className:"p-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-default-600 mb-4",children:"Download product documentation and technical files:"}),e.jsx("div",{className:"space-y-3",children:Object.entries(s.files).map(([d,n])=>e.jsxs("div",{className:"flex items-center justify-between p-3 border border-default-200 rounded-medium hover:border-primary transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-default-100 rounded-medium",children:e.jsx(v,{icon:Ue(n),className:"text-default-600",width:20})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:d}),e.jsx("p",{className:"text-xs text-default-500",children:Te(n)})]})]}),e.jsx(L,{size:"sm",variant:"flat",color:"primary",onPress:()=>p(n,$e(n,d)),endContent:e.jsx(v,{icon:"lucide:download",width:16}),children:"Download"})]},n))})]})})})},"files"),e.jsx(G,{title:"FAQ",children:e.jsx(q,{children:e.jsx(U,{className:"p-6",children:e.jsx(we,{children:s.faqs&&s.faqs.length>0?s.faqs.map((d,n)=>e.jsx(X,{title:d.question,children:d.answer},n)):[{q:"What is the installation process?",a:"Installation typically requires a concrete foundation and can be completed by our certified installers. The process usually takes 1-3 days depending on the product complexity and site conditions."},{q:"What maintenance is required?",a:"Our products are designed for minimal maintenance. We recommend a visual inspection every 6 months and cleaning as needed. Specific maintenance schedules are provided in the product documentation."},{q:"Are customizations available?",a:"Yes, most products can be customized with different colors, materials, and additional features. Custom options can be selected in the next step of this configuration process."},{q:"What warranty is provided?",a:"Standard warranty is 10 years on structural components and 5 years on other elements. Extended warranties are available for purchase. All warranties cover manufacturing defects and normal wear."}].map((d,n)=>e.jsx(X,{title:d.q,children:d.a},`fallback-${n}`))})})})},"faq")]}),e.jsx(K,{images:s.imageGallery,productCode:a,open:x,initialIndex:g,onClose:S})]})};function Ue(t){var r;const a=(r=t.split(".").pop())==null?void 0:r.toLowerCase(),s={pdf:"lucide:file-text",dwg:"lucide:file-cog",rvt:"lucide:file-3d",doc:"lucide:file-text",docx:"lucide:file-text",xls:"lucide:file-spreadsheet",xlsx:"lucide:file-spreadsheet",zip:"lucide:file-archive",default:"lucide:file"};return s[a||""]||s.default}function Te(t){var r;const a=(r=t.split(".").pop())==null?void 0:r.toLowerCase(),s={pdf:"2.4 MB",dwg:"5.8 MB",rvt:"12.6 MB",doc:"1.2 MB",docx:"1.5 MB",xls:"3.1 MB",xlsx:"3.4 MB",zip:"8.7 MB",default:"1.0 MB"};return s[a||""]||s.default}function $e(t,a){try{let r="";try{r=(new URL(t).pathname||"").split("/").pop()||""}catch{const c=t.split("/");r=c[c.length-1]||""}if(r=r.split("?")[0].split("#")[0],r&&r.includes("."))return decodeURIComponent(r)}catch(r){debugMode&&console.error("Error extracting filename from URL:",r)}const s=(t.split(".").pop()||"").toLowerCase().split("?")[0].split("#")[0];return s&&!a.includes(".")?`${a}.${s}`:a}const Ae=({data:t,options:a,onOptionsChange:s,selectedProductCode:r})=>{const p=window.urbanaDebugMode||!1,c=y.useRef(r),l=y.useRef(null),i=y.useMemo(()=>{var o;return r?(o=t.productOptions)!=null&&o[r]?t.productOptions[r]:{}:t.options},[r,t.productOptions,t.options]);p&&console.log(t);const x=y.useMemo(()=>Object.keys(i).length>0,[i]),w=y.useMemo(()=>{const o={};return Object.keys(i).forEach(u=>{a[u]&&(o[u]=a[u])}),o},[a,i]);y.useEffect(()=>{if(c.current!==r){c.current=r;const o=Object.keys(i),f=Object.keys(a);if(f.some(j=>!o.includes(j))||f.length===0){const j={};f.forEach(O=>{o.includes(O)&&(j[O]=a[O])}),JSON.stringify(j)!==JSON.stringify(a)&&s(j)}}},[r,i]);const g=y.useCallback((o,f)=>{l.current=o,s({...w,[o]:f})},[w,s]),_=y.useMemo(()=>{var f;const o=Object.keys(i);if(o.length===0)return null;if(l.current&&a[l.current]){const u=(f=i[l.current])==null?void 0:f.find(j=>j.value===a[l.current]);if(u!=null&&u.imageUrl)return u.imageUrl}for(let u=o.length-1;u>=0;u--){const j=o[u],P=a[j];if(P&&i[j]){const O=i[j].find(T=>T.value===P);if(O!=null&&O.imageUrl)return O.imageUrl}}return null},[a,i]),m=y.useMemo(()=>{var o;if(r&&((o=t.productDetails)!=null&&o[r])){const f=t.productDetails[r].imageGallery;if(f&&f.length>0)return f[0]}return"https://img.heroui.chat/image/landscape?w=800&h=600&u=preview_default"},[r,t.productDetails]),S=_||m,k={hidden:{opacity:0},show:{opacity:1,transition:{duration:.5}}};if(!x)return e.jsx(E.div,{className:"space-y-6",initial:"hidden",animate:"show",variants:k,children:e.jsx(q,{children:e.jsxs(U,{className:"p-8 text-center",children:[e.jsx(v,{icon:"lucide:settings",width:48,className:"text-default-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"No Configuration Options"}),e.jsx("p",{className:"text-default-600",children:r?e.jsxs(e.Fragment,{children:["This product doesn't have any configurable options.",e.jsxs("span",{className:"block mt-2 text-sm",children:["Product: ",e.jsx("strong",{children:r})]})]}):"Please select a product first to see available configuration options."}),e.jsx("p",{className:"text-sm text-default-500 mt-4",children:r?"Proceed to the next step to complete your inquiry.":"Go back to the previous step and select a product."})]})})});const[N,C]=y.useState(!1),[b,D]=y.useState(0),[I,d]=y.useState([]),n=(o,f=0)=>{d(o||[]),D(f),C(!0)},h=()=>C(!1);return e.jsxs(E.div,{className:"space-y-6",initial:"hidden",animate:"show",variants:k,children:[r&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-default-600",children:[e.jsx(v,{icon:"lucide:package",width:16}),e.jsxs("span",{children:["Configuring options for: ",e.jsx("strong",{children:r})]})]}),e.jsx("p",{className:"text-default-600 mb-4",children:"Customize your product by selecting from the available options below:"}),e.jsxs(ie,{"aria-label":"Product configuration tabs",variant:"underlined",color:"primary",children:[e.jsx(G,{title:"Configuration Options",children:e.jsx(q,{children:e.jsx(U,{className:"p-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx("div",{className:"space-y-4",children:Object.entries(i).map(([o,f])=>e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-default-700",children:o}),e.jsx(he,{label:o,placeholder:`Select ${o}`,selectedKeys:a[o]?[a[o]]:[],onChange:u=>{const j=u.target.value;l.current=o,g(o,j)},className:"max-w-full",children:f.map(u=>e.jsx(fe,{children:typeof u=="string"?u:u.value},typeof u=="string"?u:u.value))})]},o))}),e.jsx("div",{children:e.jsxs("div",{className:"border border-default-200 rounded-medium p-4",children:[e.jsx("h4",{className:"text-sm font-medium mb-2",children:"Preview"}),e.jsx("div",{className:"aspect-video mb-4 cursor-pointer",onClick:()=>n([S],0),children:e.jsx(z,{imagePath:S,productCode:r||"",className:"w-full h-full object-cover rounded-medium",onClick:()=>n([S],0)},S)}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h5",{className:"text-xs font-medium text-default-500",children:"Selected Options:"}),Object.keys(w).length>0?e.jsx("ul",{className:"text-sm space-y-1",children:Object.entries(w).map(([o,f])=>e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(v,{icon:"lucide:check",className:"text-success",width:14}),e.jsxs("span",{className:"font-medium",children:[o,":"]})," ",f]},o))}):e.jsx("p",{className:"text-sm text-default-500",children:"No options selected yet. Choose from the available options."})]})]})})]})})})},"options"),e.jsx(G,{title:"Option Impact",children:e.jsx(q,{children:e.jsx(U,{className:"p-6",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"text-lg font-medium",children:"How Options Affect Your Product"}),e.jsx("p",{className:"text-default-600",children:"Different options can impact the appearance, durability, and functionality of your product. Below is a summary of how each option affects your selection."})]}),e.jsx("div",{className:"space-y-4",children:Object.entries(i).map(([o,f])=>e.jsxs("div",{className:"border-b border-default-200 pb-4 last:border-0",children:[e.jsx("h5",{className:"font-medium mb-2",children:o}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:f.map((u,j)=>{const P=typeof u=="string"?u:u.value,O=typeof u=="object"&&u.imageUrl?u.imageUrl:null;return e.jsxs("div",{className:"p-3 border border-default-200 rounded-medium",children:[O&&e.jsx("div",{className:"aspect-video mb-2 rounded-small overflow-hidden cursor-pointer",onClick:()=>n([O],0),children:e.jsx(z,{imagePath:O,productCode:r||"",className:"w-full h-full object-cover",onClick:()=>n([O],0)})}),e.jsx("div",{className:"font-medium",children:P}),e.jsxs("div",{className:"text-sm text-default-500",children:[j===0&&"Standard option with included features",j===1&&"Enhanced durability and premium finish",j===2&&"Maximum performance and longevity"]})]},P)})})]},o))})]})})})},"impact"),e.jsx(G,{title:"Pricing Impact",children:e.jsx(q,{children:e.jsx(U,{className:"p-6",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"text-lg font-medium",children:"Option Pricing"}),e.jsx("p",{className:"text-default-600",children:"Different configuration options affect the final price of your product. Below is a breakdown of how each selection impacts pricing."})]}),e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-default-200",children:[e.jsx("th",{className:"py-2 px-4 text-left font-medium",children:"Option"}),e.jsx("th",{className:"py-2 px-4 text-left font-medium",children:"Selection"}),e.jsx("th",{className:"py-2 px-4 text-right font-medium",children:"Price Impact"})]})}),e.jsx("tbody",{children:Object.entries(i).map(([o,f])=>e.jsx(M.Fragment,{children:f.map((u,j)=>{const P=typeof u=="string"?u:u.value;return e.jsxs("tr",{className:"border-b border-default-100",children:[j===0?e.jsx("td",{className:"py-2 px-4 align-top",rowSpan:f.length,children:o}):null,e.jsxs("td",{className:"py-2 px-4",children:[P,j===0&&e.jsx("span",{className:"text-xs text-default-400 ml-2",children:"(Standard)"})]}),e.jsx("td",{className:"py-2 px-4 text-right",children:j===0?"Included":`+$${(j*250+Math.random()*100).toFixed(0)}`})]},`${o}-${P}`)})},o))})]}),e.jsx("div",{className:"bg-default-50 p-4 rounded-medium",children:e.jsxs("p",{className:"text-sm text-default-600",children:[e.jsx(v,{icon:"lucide:info",className:"inline-block mr-2",width:16}),"For exact pricing including all options and installation, please complete the form in the next step and our team will provide a detailed quote."]})})]})})})},"pricing")]}),e.jsx(K,{images:I,productCode:r||"",open:N,initialIndex:b,onClose:h})]})},Fe=({data:t})=>{const{currentStep:a,selections:s,isSubmitting:r,isSubmitted:p,updateSelection:c,nextStep:l,previousStep:i,goToStep:x,canProceedToStep:w}=R(),g=window.urbanaDebugMode||!1,_=t.stepperForm.steps.length,m=y.useMemo(()=>{var u;if(!s.individualProduct)return{};const n=t.stepperForm.steps[4],h=(u=n==null?void 0:n.productOptions)==null?void 0:u[s.individualProduct];if(!h)return{};const o={},f=Object.keys(h);return Object.entries(s.options).forEach(([j,P])=>{f.includes(j)&&(o[j]=P)}),o},[s.individualProduct,s.options,t.stepperForm.steps]);y.useEffect(()=>{g&&(console.log("[ProductStepper] currentStep:",a),console.log("[ProductStepper] selections:",s),console.log("[ProductStepper] stepData:",t.stepperForm.steps[a-1]),console.log("[ProductStepper] validProductOptions:",m))},[a,s,t.stepperForm.steps,m,g]);const S=y.useCallback(async()=>{var n;R.getState().setSubmitting(!0);try{const h={productGroup:s.productGroup,productRange:s.productRange,individualProduct:s.individualProduct,options:m,contactInfo:s.contactInfo};if(g&&console.log("Submitting form data:",h),!(await fetch("/wp-json/urbana/v1/submit-form",{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":((n=window.urbanaPublic)==null?void 0:n.nonce)||""},body:JSON.stringify({selections:h,submittedAt:new Date().toISOString()})})).ok)throw new Error("Failed to submit form");R.getState().setSubmitted(!0)}catch(h){console.error("Error submitting form:",h),alert("Failed to submit form. Please try again.")}finally{R.getState().setSubmitting(!1)}},[s,m]),k=n=>{x(n)},N=()=>{l()},C=()=>{i()},b=M.useCallback(()=>{const n=t.stepperForm.steps[a-1];switch(a){case 1:return e.jsx(Ee,{data:{categories:(n==null?void 0:n.categories)||[],productGroups:(n==null?void 0:n.productGroups)||[]},selection:s.productGroup||null,onSelect:o=>c("productGroup",o)});case 2:return e.jsx(De,{data:{ranges:(n==null?void 0:n.ranges)||{},productRanges:(n==null?void 0:n.productRanges)||[],relationships:n==null?void 0:n.relationships},productGroup:s.productGroup||"",selection:s.productRange||null,onSelect:o=>c("productRange",o)});case 3:return e.jsx(Re,{data:{products:(n==null?void 0:n.products)||{},productsData:(n==null?void 0:n.productsData)||[],relationships:n==null?void 0:n.relationships},productRange:s.productRange||"",selection:s.individualProduct||null,onSelect:o=>c("individualProduct",o)});case 4:const h=s.individualProduct||"unknown-product";return console.log("Step 4 Data:",n==null?void 0:n.productDetails),console.log("Product ID:",h),e.jsx(qe,{data:{productDetails:(n==null?void 0:n.productDetails)||{}},productId:h});case 5:return e.jsx(Ae,{data:{options:(n==null?void 0:n.options)||{},productOptions:(n==null?void 0:n.productOptions)||{},dynamicUpdates:(n==null?void 0:n.dynamicUpdates)||{updateImages:!1,updateFiles:!1}},options:s.options||{},onOptionsChange:o=>c("options",o),selectedProductCode:s.individualProduct||void 0});case 6:return e.jsx(Y,{data:{fields:(n==null?void 0:n.fields)||[]},contactInfo:s.contactInfo,onContactInfoChange:o=>c("contactInfo",o),isSubmitting:r,isSubmitted:p,onSubmit:S});default:return e.jsx("div",{children:"Unknown step"})}},[a,t.stepperForm.steps,s,c,r,p,S]),D=w(a+1),I=a===_,d={hidden:{opacity:0,x:10},visible:{opacity:1,x:0},exit:{opacity:0,x:-10}};return e.jsxs("div",{className:"space-y-6",children:[e.jsx(Pe,{currentStep:a,totalSteps:_,steps:t.stepperForm.steps,selections:s,onStepClick:k}),e.jsx(q,{className:"shadow-sm",children:e.jsx(U,{className:"p-6",children:e.jsxs(E.div,{initial:"hidden",animate:"visible",exit:"exit",variants:d,transition:{duration:.25},children:[e.jsx("h2",{className:"text-xl font-semibold mb-6",children:t.stepperForm.steps[a-1].title}),b()]},a)})}),e.jsx(Ce,{currentStep:a,totalSteps:_,onNext:N,onPrevious:C,canProceed:D,isLastStep:I,isSubmitting:r,isSubmitted:p,onSubmit:S})]})};function Ge(){const{productData:t,initializeProductData:a}=R(),[s,r]=y.useState(!0),[p,c]=y.useState(null),l=window.urbanaDebugMode||!1;return y.useEffect(()=>{try{const i=window.urbanaPublic;i!=null&&i.productData?(l&&console.log("Loading product data from database:",i.productData),a(),c(null)):(l&&console.warn("No product data found in window.urbanaPublic, using default data"),R.getState().setProductData(Q),c("Using default product data - database may be empty"))}catch(i){l&&console.error("Error initializing product data:",i),c("Failed to load product data"),R.getState().setProductData(Q)}finally{r(!1)}},[a]),s?e.jsx("div",{className:"min-h-screen bg-background",children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx(ge,{size:"lg"}),e.jsx("p",{className:"text-foreground-600",children:"Loading product configuration..."})]})})}):t?e.jsx("div",{className:"min-h-screen bg-background",children:e.jsx("div",{className:"py-12 px-4 sm:px-6",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-2xl font-semibold text-foreground",children:"Product Configuration"}),e.jsx("p",{className:"text-foreground-500 mt-2",children:"Select and customize your product in a few simple steps"})]}),p&&e.jsx(Z,{color:"warning",variant:"flat",className:"mb-6",title:"Development Notice",description:p,startContent:e.jsx(v,{icon:"lucide:info",width:20})}),e.jsx(Fe,{data:t})]})})}):e.jsx("div",{className:"min-h-screen bg-background",children:e.jsx("div",{className:"py-12 px-4 sm:px-6",children:e.jsx("div",{className:"max-w-4xl mx-auto",children:e.jsx(Z,{color:"danger",variant:"flat",className:"mb-6",title:"Configuration Error",description:"Unable to load product configuration data. Please contact support.",startContent:e.jsx(v,{icon:"lucide:alert-triangle",width:20})})})})})}class ze extends M.Component{constructor(a){super(a),this.state={hasError:!1,error:null}}static getDerivedStateFromError(a){return{hasError:!0,error:a}}componentDidCatch(a,s){try{console.error("ErrorBoundary caught error",a,s),window.__urbana_diag=window.__urbana_diag||{errors:[]},window.__urbana_diag.errors.push({type:"error_boundary",message:a.message,stack:a.stack||null,info:s})}catch{}}render(){var a,s,r,p,c;if(this.state.hasError){const l=typeof window<"u"&&(window.urbanaDebugMode||((a=window.urbanaAdmin)==null?void 0:a.debugMode)||((s=window.urbanaPublic)==null?void 0:s.debugMode)||!1);return e.jsxs("div",{className:"p-8 bg-danger/5 border border-danger/10 rounded-medium text-center",children:[e.jsx("h2",{className:"text-lg font-semibold text-danger mb-2",children:"Something went wrong"}),e.jsx("p",{className:"text-sm text-default-600 mb-4",children:"An unexpected error occurred while rendering this application."}),e.jsx("pre",{className:"text-xs text-default-400 whitespace-pre-wrap",children:(r=this.state.error)==null?void 0:r.message}),l&&((p=this.state.error)==null?void 0:p.stack)&&e.jsxs("details",{className:"mt-3 text-left text-xs text-default-400",children:[e.jsx("summary",{className:"cursor-pointer",children:"View stack trace"}),e.jsx("pre",{className:"whitespace-pre-wrap",children:(c=this.state.error)==null?void 0:c.stack})]})]})}return this.props.children}}var se,ae;if(typeof window<"u"){window.__urbana_diag=window.__urbana_diag||{errors:[]};try{(window.urbanaDebugMode||((se=window.urbanaAdmin)==null?void 0:se.debugMode)||((ae=window.urbanaPublic)==null?void 0:ae.debugMode)||!1)&&console.warn("[Urbana Stepper] ENTRY: bundle evaluated"),window.__urbana_diag.entryEvaluated=!0}catch{}}try{xe.createRoot(document.getElementById("urbana-stepper-root")).render(e.jsx(M.StrictMode,{children:e.jsxs(_e,{children:[e.jsx(ye,{}),e.jsx(ze,{children:e.jsx("main",{className:"text-foreground bg-background",children:e.jsx(Ge,{})})})]})}))}catch(t){console.error("[Urbana Stepper] render call failed",t);try{window.__urbana_diag=window.__urbana_diag||{errors:[]},window.__urbana_diag.errors.push({type:"render_error",message:String(t),stack:t&&t.stack?t.stack:null})}catch{}}var re,ne;if(typeof window<"u"){window.__urbana_diag=window.__urbana_diag||{errors:[]},window.addEventListener("error",t=>{try{const a=t&&(t.error&&t.error.message?t.error.message:t.message||String(t));console.error("[Urbana diag] global error:",a,t.error||t),window.__urbana_diag.errors.push({type:"error",message:a,stack:t&&t.error&&t.error.stack?t.error.stack:null})}catch{}},!0),window.addEventListener("unhandledrejection",t=>{try{const a=t&&(t.reason&&t.reason.message?t.reason.message:String(t.reason));console.error("[Urbana diag] unhandledrejection:",a,t.reason||t),window.__urbana_diag.errors.push({type:"unhandledrejection",message:a,stack:t&&t.reason&&t.reason.stack?t.reason.stack:null})}catch{}},!0);try{window.urbanaStepperEntry=!0;const t=window.urbanaDebugMode||((re=window.urbanaAdmin)==null?void 0:re.debugMode)||((ne=window.urbanaPublic)==null?void 0:ne.debugMode)||!1;t&&(console.warn("[Urbana Stepper] module entry"),console.log("[Urbana Stepper] attempting to render"));try{window.urbanaStepperLoaded=!0,t&&console.log("[Urbana Stepper] main bundle loaded")}catch(a){throw console.error("[Urbana Stepper] error setting loaded flag",a),window.__urbana_diag.errors.push({type:"flag_error",message:String(a),stack:a&&a.stack?a.stack:null}),a}}catch(t){console.error("[Urbana Stepper] module initialization error",t);try{window.__urbana_diag.errors.push({type:"init_error",message:String(t),stack:t&&t.stack?t.stack:null})}catch{}}}
