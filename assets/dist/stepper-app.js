import{f as xe,u as ve,a as Ne,c as Se,j as e,b as s,d as $,I as v,w as O,e as z,g as U,h as F,i as L,k as R,l as Q,m as ae,n as ee,s as he,o as fe,F as _e,p as ke,R as Ce}from"./iconPatch.js";import{i as Pe,a as Ee,b as ie,p as se,c as oe,T as De}from"./productData.js";import{m as D}from"./proxy.js";import{c as Oe,t as ge,a as H}from"./chunk-ML27DD5T.js";import{t as be,c as we,a as Me,d as Ie,p as Le,H as je}from"./middleware.js";import"./accelerated-values.js";import"./create-visual-element.js";var ye=xe((t,n)=>{var r;const{as:i,className:p,children:u,...l}=t,o=i||"div",b=ve(n),{slots:y,classNames:f}=Ne(),_=Se(f==null?void 0:f.footer,p);return e(o,{ref:b,className:(r=y.footer)==null?void 0:r.call(y,{class:_}),...l,children:u})});ye.displayName="HeroUI.CardFooter";var Re=ye;const $e=({currentStep:t,totalSteps:n,onNext:r,onPrevious:i,canProceed:p,isLastStep:u,isSubmitting:l,isSubmitted:o,onSubmit:b})=>s("div",{className:"flex justify-between items-center pt-4",children:[e("div",{children:t>1&&e($,{variant:"flat",color:"default",onPress:i,startContent:e(v,{icon:"lucide:arrow-left",width:18}),children:"Previous"})}),s("div",{className:"text-default-500 text-sm",children:["Step ",t," of ",n]}),e("div",{children:u?e($,{color:"primary",isDisabled:!p||l||o,isLoading:l,onPress:b,endContent:!l&&!o&&e(v,{icon:"lucide:send",width:18}),children:o?s(D.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},className:"flex items-center gap-2",children:[e(v,{icon:"lucide:check",width:18}),"Submitted"]}):"Submit"}):e($,{color:"primary",isDisabled:!p,onPress:r,endContent:e(v,{icon:"lucide:arrow-right",width:18}),children:"Next"})})]}),qe=({currentStep:t,totalSteps:n,steps:r,selections:i,onStepClick:p})=>{const u=l=>l===1?!0:l===2?!!i.productGroup:l===3?!!i.productRange:l===4||l===5||l===6?!!i.individualProduct:!1;return e("div",{className:"hidden md:block mb-8",children:e("div",{className:"flex items-center justify-between",children:r.map(l=>{const o=l.step===t,b=l.step<t,y=u(l.step);return s(O.Fragment,{children:[s("div",{className:"flex flex-col items-center relative",children:[e("button",{className:`w-10 h-10 rounded-full flex items-center justify-center transition-all duration-200 ${o?"bg-primary text-white":b?"bg-success text-white":"bg-default-100 text-default-500"} ${y?"cursor-pointer hover:opacity-80":"cursor-not-allowed opacity-60"}`,onClick:()=>y&&p(l.step),disabled:!y,"aria-label":`Go to step ${l.step}: ${l.title}`,children:b?e(v,{icon:"lucide:check",width:20}):e("span",{children:l.step})}),e("span",{className:`text-xs mt-2 text-center max-w-[80px] ${o?"text-primary font-medium":"text-default-500"}`,children:l.title})]}),l.step<n&&e("div",{className:"flex-1 h-[2px] mx-2 bg-default-200",children:e("div",{className:"h-full bg-primary transition-all duration-300",style:{width:b?"100%":"0%"}})})]},l.step)})})})},Ue=({data:t,selection:n,onSelect:r})=>{const i=z(()=>{var l;return t.productGroups&&Array.isArray(t.productGroups)?t.productGroups.filter(o=>o.active!==!1):((l=t.categories)==null?void 0:l.map(o=>({id:o.toLowerCase().replace(/\s+/g,"-"),name:o,icon:Fe(o),description:Te(o),active:!0})))||[]},[t.productGroups,t.categories]),p={hidden:{opacity:0},show:{opacity:1,transition:{staggerChildren:.1}}},u={hidden:{opacity:0,y:20},show:{opacity:1,y:0}};return s("div",{children:[e("p",{className:"text-default-600 mb-6",children:"Please select a product category to begin your configuration."}),e(D.div,{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4",variants:p,initial:"hidden",animate:"show",children:i.map(l=>e(D.div,{variants:u,children:e(U,{isPressable:!0,onPress:()=>r(l.name),className:`transition-all duration-200 ${n===l.name?"border-2 border-primary shadow-md":"border border-default-200 hover:border-primary hover:shadow-sm"}`,children:s(F,{className:"flex flex-col items-center text-center p-6",children:[e("div",{className:`w-12 h-12 rounded-full flex items-center justify-center mb-3 ${n===l.name?"bg-primary text-white":"bg-default-100 text-default-500"}`,children:e(v,{icon:l.icon,width:24})}),e("h3",{className:"text-lg font-medium",children:l.name}),e("p",{className:"text-default-500 text-sm mt-1",children:l.description})]})})},l.id))})]})};function Fe(t){return{Shelter:"lucide:home",Toilet:"lucide:bath",Bridge:"lucide:route",Access:"lucide:wheelchair",Seating:"lucide:armchair",Lighting:"lucide:lamp"}[t]||"lucide:box"}function Te(t){return{Shelter:"Outdoor structures for shade and protection",Toilet:"Public and portable sanitation facilities",Bridge:"Pedestrian and light vehicle crossings",Access:"Ramps, stairs, and accessibility solutions",Seating:"Benches and outdoor furniture options",Lighting:"Outdoor and pathway lighting solutions"}[t]||"Product category"}const Ae=({data:t,productGroup:n,selection:r,onSelect:i})=>{t.ranges[n];const p=z(()=>{var b,y;if(t.productRanges&&t.relationships){const f=n.toLowerCase().replace(/\s+/g,"-"),_=((b=t.relationships.groupToRanges)==null?void 0:b[f])||[];return t.productRanges.filter(h=>_.includes(h.id)&&h.active!==!1)}return(((y=t.ranges)==null?void 0:y[n])||[]).map(f=>({id:f.toLowerCase().replace(/\s+/g,"-"),name:f,image:"",description:Ge(f),tags:ze(f),active:!0}))},[t.productRanges,t.relationships,t.ranges,n]),u={hidden:{opacity:0},show:{opacity:1,transition:{staggerChildren:.1}}},l={hidden:{opacity:0,y:20},show:{opacity:1,y:0}};return s("div",{children:[s("p",{className:"text-default-600 mb-6",children:["Select a product range from the ",n," category:"]}),e(D.div,{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",variants:u,initial:"hidden",animate:"show",children:p.map((o,b)=>{const y=r===o.name;return e(D.div,{variants:l,children:e(U,{isPressable:!0,onPress:()=>i(o.name),className:`transition-all duration-200 ${y?"border-2 border-primary shadow-md":"border border-default-200 hover:border-primary hover:shadow-sm"}`,children:e(F,{className:"p-0",children:s("div",{className:"flex flex-col sm:flex-row",children:[o.image&&e(Oe,{className:"p-0",children:e(Pe,{src:o.image,alt:o.name,className:"w-full h-40 object-cover",radius:"none"})}),s("div",{className:"p-4 flex-1",children:[e("h3",{className:"text-lg font-medium",children:o.name}),e("p",{className:"text-default-500 text-sm mt-2",children:o.description}),e("div",{className:"mt-3 flex flex-wrap gap-2",children:o.tags.map(f=>e("span",{className:"text-xs px-2 py-1 bg-default-100 text-default-700 rounded-medium",children:f},f))})]})]})})})},o.id)})})]})};function Ge(t){return{Peninsula:"Modern shelters with excellent weather protection for parks and urban settings",Whyalla:"Robust shelters designed for coastal and high-wind environments",Coastal:"Corrosion-resistant designs perfect for beachfront and marine locations",Urban:"Contemporary designs that blend with modern city landscapes",Heritage:"Traditional designs that complement historic and cultural settings",EcoSan:"Environmentally friendly composting toilet solutions with minimal water usage",Standard:"Reliable and cost-effective public toilet facilities",Accessible:"Fully compliant accessible toilet facilities with enhanced features",Premium:"High-end toilet facilities with superior finishes and amenities",Compact:"Space-saving designs for areas with limited footprint","Small Span":"Compact bridges for garden paths and small water crossings","Large Span":"Extended bridges for wider crossings and heavier loads",Pedestrian:"Dedicated walkways designed for high foot traffic areas","Decorative Bridge":"Ornamental bridges that serve as landscape features","Heavy Duty":"Reinforced bridges capable of supporting maintenance vehicles",Ramp:"Gentle slope access solutions for wheelchairs and strollers",Staircase:"Step access with various configurations and safety features",Pathway:"Connected walkway systems for parks and public spaces",Boardwalk:"Elevated walkways for wetlands and sensitive environments",Platform:"Viewing platforms and elevated observation areas",Bench:"Traditional seating options for parks and public spaces","Table Setting":"Combined table and seating arrangements for picnic areas",Lounge:"Comfortable extended seating for relaxation areas",Stadium:"Tiered seating solutions for sports and event venues",Custom:"Bespoke seating arrangements designed to specification",Solar:"Self-sufficient lighting powered by renewable energy","Mains Powered":"Connected lighting solutions with reliable performance","Decorative Light":"Aesthetic lighting features that enhance landscapes",Security:"High visibility lighting for safety and security","Pathway Light":"Directional lighting for walkways and pedestrian areas"}[t]||`${t} product line with various options and configurations.`}function ze(t,n){const r={Peninsula:["Modern","Weather-resistant","Versatile"],Whyalla:["Robust","Wind-resistant","Durable"],Coastal:["Corrosion-resistant","Salt-proof","UV-stable"],Urban:["Contemporary","Modular","Space-efficient"],Heritage:["Traditional","Ornate","Classic"],EcoSan:["Eco-friendly","Low-water","Composting"],Standard:["Cost-effective","Reliable","Low-maintenance"],Accessible:["ADA Compliant","Spacious","Universal"],Premium:["High-end","Enhanced features","Superior finishes"],Compact:["Space-saving","Efficient","Urban-friendly"],"Small Span":["Compact","Decorative","Easy-install"],"Large Span":["Extended","Reinforced","Heavy-load"],Pedestrian:["High-traffic","Safety-focused","Accessible"],Decorative:["Ornamental","Artistic","Feature piece"],"Heavy Duty":["Vehicle-rated","Industrial","Maximum strength"],default:["Quality","Durable","Customizable"]};return r[t]||r.default}const Be=({data:t,productRange:n,selection:r,onSelect:i})=>{t.products[n];const p=z(()=>{var b;if(t.productsData&&t.relationships){const y=n.toLowerCase().replace(/\s+/g,"-"),f=t.relationships.rangeToProducts[y]||[];return t.productsData.filter(_=>f.includes(_.id)&&_.active!==!1)}return(((b=t.products)==null?void 0:b[n])||[]).map(y=>({id:y.toLowerCase(),code:y,name:`${y} Product`,overview:le(y),description:le(y),specifications:[],imageGallery:[],files:{},active:!0}))},[t.productsData,t.relationships,t.products,n]),u={hidden:{opacity:0},show:{opacity:1,transition:{staggerChildren:.05}}},l={hidden:{opacity:0,y:10},show:{opacity:1,y:0}};return s("div",{children:[s("p",{className:"text-default-600 mb-6",children:["Select a specific product from the ",n," range:"]}),e(D.div,{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4",variants:u,initial:"hidden",animate:"show",children:p.map(o=>{const b=r===o.code;return o.imageGallery.length>0,e(D.div,{variants:l,children:s(U,{isPressable:!0,onPress:()=>i(o.code),className:`h-full w-full transition-all duration-200 ${b?"border-2 border-primary shadow-md":"border border-default-200 hover:border-primary hover:shadow-sm"}`,children:[s(F,{className:"p-4",children:[e("div",{className:"flex items-center justify-center mb-3",children:e("h3",{className:"text-lg font-medium",children:o.name})}),e("p",{className:"text-default-500 text-sm text-center",children:o.overview||o.description}),o.specifications.length>0&&s("div",{className:"space-y-1",children:[e("p",{className:"text-xs font-semibold text-default-700 text-center",children:"Key Features:"}),s("div",{className:"text-xs text-default-500",children:[o.specifications.slice(0,3).map((y,f)=>s("div",{className:"flex items-start justify-center",children:[e(v,{icon:"lucide:check",width:14,className:"mr-1 mt-0.5 text-success"}),e("span",{children:y})]},f)),o.specifications.length>3&&s("div",{className:"text-default-400 mt-1",children:["+",o.specifications.length-3," more features"]})]})]})]}),Object.keys(o.files).length>0&&e(Re,{className:"border-t border-default-100 px-4 py-2 justify-center",children:s("div",{className:"flex items-center gap-2 text-xs text-default-600",children:[e(v,{icon:"lucide:file-text",width:14}),s("span",{children:[Object.keys(o.files).length," document",Object.keys(o.files).length!==1?"s":""," available"]})]})})]})},o.id)})})]})};function le(t){const n=t.match(/[A-Z]+\d+/),r=n?n[0]:t;return{K301:"Compact shelter with modern design, suitable for parks and urban settings.",K302:"Medium-sized shelter with extended roof coverage for picnic areas.",K308:"Large shelter with multiple seating options and enhanced weather protection.",K310:"Premium shelter with architectural design elements and superior materials.",K315:"Deluxe shelter with integrated seating and optional power connections.",E201:"Eco-friendly toilet with composting technology and minimal water usage.",E202:"Solar-powered toilet facility with self-contained waste management.",SS101:"Small pedestrian bridge for garden paths and decorative water crossings.",SS102:"Compact bridge with enhanced load capacity for light maintenance vehicles.",R101:"ADA compliant access ramp with gentle slope and non-slip surface.",R102:"Modular ramp system adaptable to various height requirements."}[r]||`${t} model with standard features and customization options.`}const B=new Map,J=new Map;async function X(t,n){if(!t)return null;if(B.has(t))return B.get(t);if(J.has(t))return J.get(t);const r=(async()=>{var l,o;const i=((l=window.urbanaPublic)==null?void 0:l.nonce)||((o=window.urbanaAdmin)==null?void 0:o.nonce)||"",p=await fetch("/wp-json/urbana/v1/image-proxy",{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":i},body:JSON.stringify({image_path:t})});if(!p.ok)throw new Error(`HTTP ${p.status}: ${p.statusText}`);const u=await p.json();if(u.success&&u.method==="presigned_url"&&u.image_url){const b={url:u.image_url,method:"presigned_url"};return B.set(t,b),J.delete(t),b}if(u.success&&u.image_data){const b={url:u.image_data,method:u.method||"base64"};return B.set(t,b),J.delete(t),b}throw J.delete(t),new Error(u.error||u.message||"Failed to fetch image")})();return J.set(t,r),r}const K=({imagePath:t,productCode:n,className:r="",alt:i="Product image",onClick:p,loading:u="lazy",fetchPriority:l="auto"})=>{var E,w;const[o,b]=L(""),[y,f]=L(!0),[_,h]=L(""),[N,k]=L(""),S=window.urbanaDebugMode||((E=window.urbanaAdmin)==null?void 0:E.debugMode)||((w=window.urbanaPublic)==null?void 0:w.debugMode)||!1;return R(()=>{t&&(async()=>{var j,I;try{f(!0),h("");const d=((j=window.urbanaPublic)==null?void 0:j.nonce)||((I=window.urbanaAdmin)==null?void 0:I.nonce)||"";S&&console.log(`[SecureImage] Fetching: ${t}`,{productCode:n,nonce:d?"present":"missing",debugMode:S});try{const c=B.get(t);if(c){S&&console.log("[SecureImage] Using cached signed URL",t),k(c.method||"cached"),b(c.url);return}const m=await X(t,n);if(m){S&&console.log("[SecureImage] Prefetch result",m),k(m.method||"fetched"),b(m.url);return}}catch(c){S&&console.warn("[SecureImage] prefetchImage failed, falling back to inline fetch",c)}const g=await fetch("/wp-json/urbana/v1/image-proxy",{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":d},body:JSON.stringify({image_path:t})});if(!g.ok)throw new Error(`HTTP ${g.status}: ${g.statusText}`);const a=await g.json();if(S&&console.log(`[SecureImage] Response for ${t}:`,{method:a.method,success:a.success,hasImageUrl:!!a.image_url,hasImageData:!!a.image_data,error:a.error,message:a.message}),a.success)if(a.method==="presigned_url"&&a.image_url)S&&console.log("âœ… Using presigned URL method (instant loading from DO)"),k("presigned_url"),b(a.image_url),B.set(t,{url:a.image_url,method:"presigned_url"});else if(a.method==="base64_fallback"&&a.image_data)S&&console.log("âš ï¸ Using base64 fallback method (slower, full data transfer)"),k("base64_fallback"),b(a.image_data),B.set(t,{url:a.image_data,method:"base64_fallback"});else if(a.image_data)S&&console.log("âš ï¸ Using legacy base64 format"),k("base64_legacy"),b(a.image_data),B.set(t,{url:a.image_data,method:"base64_legacy"});else if(a.imageData)S&&console.log("âš ï¸ Using legacy imageData format"),k("imageData_legacy"),b(a.imageData),B.set(t,{url:a.imageData,method:"imageData_legacy"});else throw S&&console.error("No image URL or data received from server"),new Error("No image URL or data received");else if(a.use_svg_icon)S&&console.warn("Server requested SVG icon fallback:",a.error),k("svg_fallback"),h("Failed to load image - using SVG icon instead");else throw new Error(a.error||a.message||"Failed to get image")}catch(d){S&&console.error(`[SecureImage] Fetch error for ${t}:`,d.message,d),h(d.message)}finally{f(!1)}})()},[t,n]),y?e("div",{className:`${r} bg-gray-100 animate-pulse flex items-center justify-center`,children:s("svg",{width:"16",height:"16",viewBox:"0 0 24 24",className:"text-gray-400",children:[e("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"2",fill:"none"}),e("path",{d:"M12 6v6l4 2",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]})}):_||!o?s("div",{className:`${r} bg-orange-100 border-2 border-orange-300 flex items-center justify-center relative group`,title:_||"Image failed to load",children:[s("svg",{width:"16",height:"16",viewBox:"0 0 24 24",className:"text-orange-600",children:[e("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"2",fill:"none"}),e("line",{x1:"12",y1:"8",x2:"12",y2:"12",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"}),e("line",{x1:"12",y1:"16",x2:"12.01",y2:"16",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})]}),S&&_&&s("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 bg-gray-900 text-white text-xs rounded px-2 py-1 whitespace-nowrap opacity-0 group-hover:opacity-100 transition-opacity z-10 pointer-events-none",children:[_.substring(0,50),"..."]})]}):s("div",{className:"relative group h-full",children:[e("img",{src:o,alt:i,className:r,loading:u,decoding:"async",fetchpriority:l,onClick:M=>{var I,d;(window.urbanaDebugMode||((I=window.urbanaAdmin)==null?void 0:I.debugMode)||((d=window.urbanaPublic)==null?void 0:d.debugMode)||!1)&&console.log("[SecureImage] image clicked",t),p&&p(M)},title:S&&N?`Loaded via: ${N}`:"",onError:()=>{h("Image load failed")}}),S&&N&&e("div",{className:"absolute top-0 left-0 bg-blue-500 text-white text-xs px-1.5 py-0.5 rounded opacity-70 group-hover:opacity-100 transition-opacity font-semibold",title:`Method: ${N}`,children:N==="presigned_url"?"ðŸ”— URL":N==="base64_fallback"?"ðŸ“¦ B64":"âš ï¸"})]})},Z=({data:t,contactInfo:n,onContactInfoChange:r,isSubmitting:i,isSubmitted:p,onSubmit:u,submitLabel:l,maxMessageLength:o=2e3})=>{O.useEffect(()=>{try{if(!$)try{window.__urbana_diag=window.__urbana_diag||{errors:[],events:[]},window.__urbana_diag.events.push({type:"missing_button_import",timestamp:new Date().toISOString()})}catch{}}catch{}},[]);const[b,y]=O.useState(!1),[f,_]=O.useState({}),h=(w,M)=>{const j=w==="message"&&typeof M=="string"?M.slice(0,o):M;r({...n,[w]:j}),f[w]&&_({...f,[w]:""})},N=()=>{const w={};return n.fullName.trim()||(w.fullName="Full name is required"),n.email.trim()?/^\S+@\S+\.\S+$/.test(n.email)||(w.email="Please enter a valid email address"):w.email="Email is required",b||(w.terms="You must accept the terms and conditions"),_(w),Object.keys(w).length===0},k=()=>{N()&&u()},S={hidden:{opacity:0},show:{opacity:1,transition:{staggerChildren:.1}}},E={hidden:{opacity:0,y:20},show:{opacity:1,y:0}};return p?s(D.div,{className:"text-center py-8",initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:.5},children:[e("div",{className:"w-16 h-16 bg-success/20 rounded-full flex items-center justify-center mx-auto mb-6",children:e(v,{icon:"lucide:check",className:"text-success",width:32})}),e("h3",{className:"text-xl font-semibold mb-2",children:"Thank You!"}),e("p",{className:"text-default-600 max-w-md mx-auto mb-6",children:"Your product configuration has been submitted successfully. Our team will review your selections and contact you shortly with pricing and next steps."})]}):s(D.div,{className:"space-y-6",variants:S,initial:"hidden",animate:"show",children:[e(D.p,{variants:E,className:"text-default-600",children:"Please provide your contact information to receive a detailed quote for your configured product."}),s(D.div,{variants:E,className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e(Q,{label:"Full Name",placeholder:"Enter your full name",value:n.fullName,onValueChange:w=>h("fullName",w),isRequired:!0,isInvalid:!!f.fullName,errorMessage:f.fullName}),e(Q,{label:"Email Address",placeholder:"Enter your email address",type:"email",value:n.email,onValueChange:w=>h("email",w),isRequired:!0,isInvalid:!!f.email,errorMessage:f.email})]}),s(D.div,{variants:E,className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e(Q,{label:"Phone Number",placeholder:"Enter your phone number",type:"tel",value:n.phone,onValueChange:w=>h("phone",w)}),e(Q,{label:"Company/Organization",placeholder:"Enter your company or organization",value:n.company,onValueChange:w=>h("company",w)})]}),s(D.div,{variants:E,children:[e(be,{label:"Additional Notes",placeholder:"Enter any specific requirements or questions",value:n.message,onValueChange:w=>h("message",w),minRows:3}),s("div",{className:"text-xs text-default-500 mt-1",children:[(n.message||"").length,"/",o," characters"]})]}),s(D.div,{variants:E,className:"space-y-4",children:[e(we,{isSelected:b,onValueChange:y,isInvalid:!!f.terms,children:s("div",{className:"flex flex-col",children:[e("span",{children:"I agree to the Terms and Conditions and Privacy Policy"}),f.terms&&e("span",{className:"text-danger text-xs mt-1",children:f.terms})]})}),e("div",{className:"bg-default-50 p-4 rounded-medium text-sm text-default-600",children:s("p",{className:"flex items-start gap-2",children:[e(v,{icon:"lucide:shield",className:"text-default-500 mt-0.5 flex-shrink-0",width:16}),e("span",{children:"Your information is secure and will only be used to process your product inquiry. We will never share your details with third parties without your consent."})]})})]}),e(D.div,{variants:E,className:"pt-4",children:e($,{color:"primary",size:"lg",className:"w-full md:w-auto",isDisabled:i,isLoading:i,onPress:k,endContent:!i&&e(v,{icon:"lucide:send",width:18}),children:l??"Submit Configuration"})})]})},ce={productGroup:null,productRange:null,individualProduct:null,options:{},contactInfo:{fullName:"",email:"",phone:"",company:"",message:""}},q=Me()(Ie(Le((t,n)=>({productData:null,currentStep:1,selections:ce,isSubmitting:!1,isSubmitted:!1,initializeProductData:()=>{const r=window.urbanaPublic;r!=null&&r.productData?(console.log("Initializing stepper with database product data"),t({productData:r.productData})):console.warn("No database product data found in window.urbanaPublic")},setProductData:r=>{t({productData:r})},setCurrentStep:r=>t({currentStep:r}),updateSelection:(r,i)=>t(p=>{const u={...p.selections};return r==="productGroup"?(u.productGroup=i,u.productRange=null,u.individualProduct=null):r==="productRange"?(u.productRange=i,u.individualProduct=null):r==="options"?u.options={...u.options,...i}:r==="contactInfo"?u.contactInfo={...u.contactInfo,...i}:u[r]=i,{selections:u}}),nextStep:()=>t(r=>({currentStep:Math.min(r.currentStep+1,6)})),previousStep:()=>t(r=>({currentStep:Math.max(r.currentStep-1,1)})),goToStep:r=>{var l,o;const{selections:i,productData:p}=n(),u=((o=(l=p==null?void 0:p.stepperForm)==null?void 0:l.steps)==null?void 0:o.length)||6;return r<1||r>u?!1:r===1||r===2&&i.productGroup||r===3&&i.productRange||r>=4&&i.individualProduct?(t({currentStep:r}),!0):!1},setSubmitting:r=>t({isSubmitting:r}),setSubmitted:r=>t({isSubmitted:r}),resetStepper:()=>t({currentStep:1,selections:ce,isSubmitting:!1,isSubmitted:!1}),canProceedToStep:r=>{var l,o;const{selections:i,productData:p}=n(),u=((o=(l=p==null?void 0:p.stepperForm)==null?void 0:l.steps)==null?void 0:o.length)||6;if(r>u)return!1;switch(r){case 1:return!0;case 2:return!!i.productGroup;case 3:return!!i.productRange;case 4:case 5:case 6:return!!i.individualProduct;default:return!1}}}),{name:"urbana-stepper-storage",partialize:t=>({selections:t.selections,currentStep:t.currentStep})}),{name:"urbana-stepper"})),T=({open:t,onClose:n})=>{var M,j,I,d;const r=q(g=>g.productData),i=q(g=>g.selections),p=q(g=>g.setSubmitting),u=q(g=>g.setSubmitted);q(g=>g.updateSelection);const[l,o]=O.useState(()=>({...i.contactInfo})),[b,y]=O.useState(!1),[f,_]=O.useState(!1),[h,N]=O.useState(null);O.useEffect(()=>{t&&(o({...i.contactInfo,message:""}),_(!1))},[t,i.contactInfo]);const k=((I=(j=(M=r==null?void 0:r.stepperForm)==null?void 0:M.steps)==null?void 0:j[5])==null?void 0:I.fields)||[],S=g=>{o(g)};O.useEffect(()=>{try{if(!Z)try{window.__urbana_diag=window.__urbana_diag||{errors:[],events:[]},window.__urbana_diag.events.push({type:"missing_step6_component",timestamp:new Date().toISOString()})}catch{}}catch{}},[]);const E=async()=>{var g;try{y(!0),p(!0);const a={productGroup:i.productGroup,productRange:i.productRange,individualProduct:i.individualProduct,options:i.options,contactInfo:l},c=await fetch("/wp-json/urbana/v1/submit-form",{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":((g=window.urbanaPublic)==null?void 0:g.nonce)||""},body:JSON.stringify({selections:a,submittedAt:new Date().toISOString()})});let m=null;try{m=await c.json()}catch{try{m=await c.text()}catch{m=null}}try{window.__urbana_diag=window.__urbana_diag||{errors:[],events:[]},window.__urbana_diag.events.push({type:"submit_response",timestamp:new Date().toISOString(),status:c.status,body:m})}catch{}_(!0),u(!0)}catch(a){console.error("Failed to submit enquiry",a),alert("Failed to submit enquiry. Please try again.")}finally{y(!1),p(!1)}};if(!t)return null;const w=O.useRef(null);if(O.useEffect(()=>{if(f&&w.current)try{w.current.focus()}catch{}},[f,h]),O.useEffect(()=>{try{window.__urbana_diag=window.__urbana_diag||{errors:[],events:[]},window.__urbana_diag.events.push({type:"contact_modal_mount",timestamp:new Date().toISOString(),open:t})}catch{}return()=>{try{window.__urbana_diag.events.push({type:"contact_modal_unmount",timestamp:new Date().toISOString()})}catch{}}},[]),f){try{window.__urbana_diag=window.__urbana_diag||{errors:[],events:[]},window.__urbana_diag.events.push({type:"submit_ui_shown",timestamp:new Date().toISOString(),status:(h==null?void 0:h.status)??null})}catch{}return s("div",{className:"fixed inset-0 z-60 flex items-center justify-center p-4",role:"dialog","aria-modal":"true",children:[e("div",{className:"fixed inset-0 bg-black/60",onClick:n,"aria-hidden":"true"}),s("div",{className:"relative w-full max-w-2xl bg-white rounded-medium shadow-lg z-10 p-6 max-h-[85vh] overflow-auto",children:[s("div",{className:"text-center py-8",children:[e("div",{className:"w-16 h-16 bg-success/20 rounded-full flex items-center justify-center mx-auto mb-6",children:e(v,{icon:"lucide:check",className:"text-success",width:32})}),e("h3",{className:"text-xl font-semibold mb-2",children:"Thank You!"}),s("p",{className:"text-default-600 max-w-md mx-auto mb-6",children:["Your enquiry has been submitted successfully.",(d=h==null?void 0:h.body)!=null&&d.id?s("span",{children:[" Reference: ",String(h.body.id)]}):null]}),h&&s("div",{className:"mt-4 p-3 bg-default-50 rounded text-xs text-default-600",children:[e("strong",{children:"Server response:"}),s("div",{children:["Status: ",String(h.status)]}),e("pre",{className:"mt-2 text-xs whitespace-pre-wrap",children:typeof h.body=="string"?h.body:JSON.stringify(h.body,null,2)})]})]}),e("div",{className:"mt-6 flex justify-end",children:e($,{ref:w,color:"primary",onPress:n,"aria-label":"Close enquiry dialog",children:"Close"})})]})]})}return s("div",{className:"fixed inset-0 z-60 flex items-center justify-center p-4",role:"dialog","aria-modal":"true",children:[e("div",{className:"fixed inset-0 bg-black/60",onClick:f?n:void 0,"aria-hidden":"true"}),s("div",{className:"relative w-full max-w-2xl bg-white rounded-medium shadow-lg z-10 p-6 max-h-[85vh] overflow-auto",children:[s("div",{className:"flex items-start justify-between gap-4 mb-4",children:[s("div",{children:[e("h3",{className:"text-lg font-semibold",children:"Enquire about this product"}),e("p",{className:"text-sm text-default-500",children:"Leave your contact details and we will get back to you with pricing and next steps."})]}),s("div",{className:"flex items-center gap-2",children:[e($,{variant:"flat",color:"default",onPress:()=>o({fullName:"",email:"",phone:"",company:"",message:""}),"aria-label":"Clear enquiry form",children:"Clear"}),e($,{variant:"flat",color:"default",onPress:n,"aria-label":"Close enquiry dialog",children:e(v,{icon:"lucide:x",width:18})})]})]}),e("div",{children:(()=>{if(typeof Z!="function")return s("div",{className:"p-4 bg-warning/5 border border-warning/10 rounded-medium",children:[e("h4",{className:"font-semibold mb-2",children:"Error loading enquiry form"}),e("p",{className:"text-sm text-default-600",children:"The contact form component could not be rendered. This is likely a build/import issue. See the console for diagnostic details."}),e("pre",{className:"text-xs mt-2",children:JSON.stringify({Step6ContactInfo:typeof Z,Input:typeof Q,Textarea:typeof be,Checkbox:typeof we,Button:typeof $},null,2)})]});try{return e(Z,{data:{fields:k},contactInfo:l,onContactInfoChange:g=>S(g),isSubmitting:b,isSubmitted:f,onSubmit:E,submitLabel:"Enquire Now",maxMessageLength:2e3})}catch(g){try{window.__urbana_diag=window.__urbana_diag||{errors:[],events:[]},window.__urbana_diag.errors.push({type:"render_error_step6",message:String(g&&g.message),stack:g&&g.stack})}catch{}return s("div",{className:"p-4 bg-warning/5 border border-warning/10 rounded-medium",children:[e("h4",{className:"font-semibold mb-2",children:"Error rendering enquiry form"}),e("p",{className:"text-sm text-default-600",children:"An unexpected error occurred while rendering the form. See diagnostics for details."}),e("pre",{className:"text-xs mt-2",children:String(g&&g.message)})]})}})()}),h&&s("div",{className:"mt-4 p-3 bg-default-50 rounded text-xs text-default-600",children:[e("strong",{children:"Last submission:"}),s("div",{children:["Status: ",String(h.status)]}),e("pre",{className:"mt-2 text-xs whitespace-pre-wrap",children:typeof h.body=="string"?h.body:JSON.stringify(h.body,null,2)})]}),f&&e("div",{className:"mt-6 flex justify-end",children:e($,{ref:w,color:"primary",onPress:n,"aria-label":"Close enquiry dialog",children:"Close"})})]})]})},te=({images:t,productCode:n="",open:r,initialIndex:i=0,onClose:p,onIndexChange:u})=>{var f,_;const[l,o]=O.useState(i);try{(window.urbanaDebugMode||((f=window.urbanaAdmin)==null?void 0:f.debugMode)||((_=window.urbanaPublic)==null?void 0:_.debugMode)||!1)&&console.warn("[Lightbox] props",{open:r,initialIndex:i,imagesLength:t==null?void 0:t.length,productCode:n})}catch{}if(R(()=>{o(i)},[i]),R(()=>{if(r)try{t[l+1]&&X(t[l+1],n).catch(()=>{}),t[l-1]&&X(t[l-1],n).catch(()=>{})}catch{}},[r,l,t,n]),R(()=>{var k,S;if((window.urbanaDebugMode||((k=window.urbanaAdmin)==null?void 0:k.debugMode)||((S=window.urbanaPublic)==null?void 0:S.debugMode)||!1)&&console.warn("[Lightbox] effect open changed",{open:r,index:l,imagesLength:t.length}),!r)return;const N=E=>{console.warn("[Lightbox] keydown",E.key),E.key==="Escape"&&p(),E.key==="ArrowLeft"&&o(w=>Math.max(0,w-1)),E.key==="ArrowRight"&&o(w=>Math.min(t.length-1,w+1))};return window.addEventListener("keydown",N),()=>window.removeEventListener("keydown",N)},[r,t.length,p]),R(()=>{window.urbanaDebugMode&&console.log(`[Lightbox] open: ${r}, index: ${l}, images: ${t.length}`)},[r,l,t.length]),R(()=>{u&&u(l)},[l]),!r)return null;const b=()=>{window.urbanaDebugMode&&console.log("[Lightbox] prev clicked"),o(h=>Math.max(0,h-1))},y=()=>{window.urbanaDebugMode&&console.log("[Lightbox] next clicked"),o(h=>Math.min(t.length-1,h+1))};return e("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/70 p-4",children:s("div",{className:"relative w-full max-w-6xl mx-auto",children:[e("button",{"aria-label":"Close",onClick:()=>{window.urbanaDebugMode&&console.log("[Lightbox] close clicked"),p()},className:"absolute right-2 top-2 z-50 rounded-full bg-white/10 hover:bg-white/20 p-2 text-white",children:e(v,{icon:"lucide:x",width:18})}),s("div",{className:"flex items-center justify-center",children:[e("button",{"aria-label":"Previous",onClick:b,className:"flex items-center justify-center w-10 h-10 md:w-12 md:h-12 rounded-full bg-white/10 hover:bg-white/20 text-white mr-4",children:e(v,{icon:"lucide:chevron-left",width:20})}),e("div",{className:"flex-1 flex items-center justify-center",children:e("div",{className:"max-h-[85vh] w-full flex items-center justify-center",children:e(K,{imagePath:t[l],productCode:n,className:"max-w-full max-h-[85vh] object-contain",alt:`Image ${l+1} of ${t.length}`,loading:"eager",fetchPriority:"high"})})}),e("button",{"aria-label":"Next",onClick:y,className:"flex items-center justify-center w-10 h-10 md:w-12 md:h-12 rounded-full bg-white/10 hover:bg-white/20 text-white ml-4",children:e(v,{icon:"lucide:chevron-right",width:20})})]}),t.length>1&&e("div",{className:"mt-4 flex gap-2 overflow-x-auto px-2",children:t.map((h,N)=>e("button",{onClick:()=>o(N),onMouseEnter:()=>X(h).catch(()=>{}),className:`flex-shrink-0 w-20 h-20 rounded-small overflow-hidden border-2 ${N===l?"border-primary":"border-transparent"}`,"aria-label":`View image ${N+1}`,children:e(K,{imagePath:h,productCode:n,className:"w-full h-full object-cover",alt:`Thumb ${N+1}`,loading:"lazy"})},N))})]})})},Ve=({data:t,productId:n})=>{const r=t.productDetails[n],i=window.urbanaDebugMode||!1;R(()=>{try{const a=[];K||a.push("SecureImage"),te||a.push("Lightbox"),T||a.push("ContactModal"),v||a.push("Icon"),a.length>0&&console.error("[Step4] Missing imports detected:",a)}catch{}},[]);const p=ae(async(a,c)=>{try{const m=a.includes("digitaloceanspaces.com");let x=a;if(m)try{let A=(new URL(a).pathname||"").replace(/^\//,"");if(A){const V=new URL("/wp-json/urbana/v1/proxy-download",window.location.origin);V.searchParams.set("path",A),x=V.toString()}else{const V=new URL("/wp-json/urbana/v1/proxy-download",window.location.origin);V.searchParams.set("url",a),x=V.toString()}}catch{const A=new URL("/wp-json/urbana/v1/proxy-download",window.location.origin);A.searchParams.set("url",a),x=A.toString()}else if(!/^https?:\/\//i.test(a)){const C=new URL("/wp-json/urbana/v1/proxy-download",window.location.origin);C.searchParams.set("path",a),x=C.toString()}const P=document.createElement("a");P.href=x,P.download=c,P.style.display="none",P.target="_blank",document.body.appendChild(P),P.click(),document.body.removeChild(P)}catch(m){i&&console.error("Download failed:",m),alert("Failed to download file. Please try again or contact support.")}},[]);if(!r)return s("div",{className:"text-center p-8",children:[e(v,{icon:"lucide:file-question",className:"mx-auto mb-4 text-default-400",width:48}),e("h3",{className:"text-xl font-medium mb-2",children:"Product Information Unavailable"}),s("p",{className:"text-default-500",children:["Detailed information for ",n," is not available at this time. Please continue to the next step or contact our support team for assistance."]})]});const u={hidden:{opacity:0},show:{opacity:1,transition:{duration:.5}}},l=r.imageGallery.length>0?r.imageGallery[0]:"",o=ee(null),[b,y]=L(!1),[f,_]=L(0),[h,N]=L({});R(()=>{i&&console.log("[Step4] Product Details:",r),i&&r.coreDesignElement&&(console.log("[Step4] Core Design Element Fields:",r.coreDesignElement),r.coreDesignElement.forEach(c=>{console.log(`[Step4] Field "${c.label}" - type: ${c.type}, defaultValue: ${c.defaultValue}, values: ${JSON.stringify(c.values)}`)}));const a={};r.coreDesignElement&&r.coreDesignElement.forEach(c=>{c.type==="dropdown"&&c.defaultValue&&(console.log(`[Step4] Setting default for ${c.label}: ${c.defaultValue}`),a[c.id]=c.defaultValue)}),console.log("[Step4] Initial selections:",a),N(a)},[r.coreDesignElement,i]);const k=a=>{i&&console.warn(`[Step4] openLightboxAt called with index: ${a}`),_(a),y(!0)},S=a=>!a.conditions||a.conditions.length===0?!0:a.conditions.every(c=>h[c.fieldId]===c.value);R(()=>{i&&console.warn("[Step4] lightboxOpen state changed",{lightboxOpen:b,lightboxIndex:f})},[b,f]);const E=()=>y(!1),[w,M]=L(!1),[j,I]=L(null),d=()=>{try{if(typeof T!="function"){I("ContactModal is not a function - check import/export");try{window.__urbana_diag=window.__urbana_diag||{errors:[],events:[]},window.__urbana_diag.events.push({type:"contact_modal_invalid",value:String(T)})}catch{}return}}catch(a){try{window.__urbana_diag=window.__urbana_diag||{errors:[],events:[]},window.__urbana_diag.errors.push({type:"step4_open_enquire_error",message:String(a&&a.message)})}catch{}}I(null),M(!0)},g=()=>M(!1);return R(()=>{i&&console.log("[Step4] useEffect mount â€” Step4ProductContent mounted",{galleryRefPresent:!!o.current});const a=c=>{var m,x;try{const P=o.current;if(!P)return;i&&console.log("[Step4 gallery container click] event",c.type,"target:",(m=c.target)==null?void 0:m.tagName,"defaultPrevented",c.defaultPrevented);let C=c.target;for(;C&&C!==P;){if(C.nodeType!==Node.ELEMENT_NODE){C=C.parentNode;continue}const G=C,W=(x=G.getAttribute)==null?void 0:x.call(G,"data-gallery-index");if(W!=null){i&&console.log(`[Step4 gallery container click] index found: ${W}`),k(parseInt(W,10));return}const Y=window.getComputedStyle(G);i&&console.log("[Step4 gallery container click] ancestor:",G.tagName,"pointer-events:",Y.pointerEvents),C=C.parentNode}const A=c.clientX,V=c.clientY,re=P.querySelectorAll("[data-gallery-index]");for(let G=0;G<re.length;G++){const W=re[G],Y=W.getBoundingClientRect();if(A>=Y.left&&A<=Y.right&&V>=Y.top&&V<=Y.bottom){const ne=W.getAttribute("data-gallery-index");i&&console.log(`[Step4 gallery container click] bounding-match index: ${ne}`),k(parseInt(ne||"0",10));return}}}catch(P){console.error("Gallery handler error",P)}};return document.addEventListener("click",a,!0),()=>document.removeEventListener("click",a,!0)},[o,k,i]),s(D.div,{className:"space-y-8",initial:"hidden",animate:"show",variants:u,children:[s("div",{className:"flex flex-col md:flex-row gap-6",children:[e("div",{className:"w-full md:w-1/2",children:l?e("div",{"data-gallery-index":0,className:"cursor-pointer",onClick:()=>{i&&console.log("[Step4] featured image clicked index: 0"),k(0)},onMouseEnter:()=>{X(l).catch(()=>{})},children:e(K,{imagePath:l,productCode:n,alt:r.name,className:"w-full h-64 object-cover rounded-medium",onClick:()=>k(0),loading:"eager",fetchPriority:"high"})}):e("div",{className:"w-full h-64 bg-gray-100 rounded-medium flex items-center justify-center",children:e(v,{icon:"lucide:image",width:48,className:"text-gray-400"})})}),s("div",{className:"w-full md:w-1/2",children:[e("h3",{className:"text-xl font-semibold mb-2",children:r.name}),e("p",{className:"text-default-600 mb-4",children:r.overview}),r.coreDesignElement&&r.coreDesignElement.length>0?e("div",{className:"space-y-5",children:e("div",{className:"space-y-4",children:r.coreDesignElement.map(a=>{var c;return S(a)&&e("div",{children:a.type==="text"?s("div",{children:[s("span",{className:"font-semibold",children:[a.label,":"]}),e("span",{className:"ml-2",children:a.value})]}):a.type==="dropdown"?s("div",{children:[e("label",{className:"text-sm font-medium mb-2 block",children:a.label}),e(he,{selectedKeys:h[a.id]?[h[a.id]]:[],onSelectionChange:m=>{const x=Array.from(m)[0];N({...h,[a.id]:x})},placeholder:`Select ${a.label}`,size:"sm",className:"w-full",children:(c=a.values)==null?void 0:c.map(m=>e(fe,{value:m,children:m},m))})]}):null},a.id)})})}):s("div",{className:"space-y-4",children:[s("div",{className:"flex items-center gap-2",children:[e(v,{icon:"lucide:check-circle",className:"text-success",width:20}),e("span",{children:"In Stock"})]}),s("div",{className:"flex items-center gap-2",children:[e(v,{icon:"lucide:truck",className:"text-default-500",width:20}),e("span",{children:"Standard Delivery: 2-4 weeks"})]}),s("div",{className:"flex items-center gap-2",children:[e(v,{icon:"lucide:shield",className:"text-default-500",width:20}),e("span",{children:"10 Year Warranty"})]})]}),e("div",{className:"mt-4",children:e($,{color:"primary",size:"md",onPress:d,endContent:e(v,{icon:"lucide:arrow-right",width:18}),"aria-label":"Enquire Now",children:"Enquire Now"})})]})]}),(()=>{if(!w)return null;try{if(T==null||typeof T!="function"&&typeof T!="object"){console.error("[Step4] ContactModal invalid at render",T);try{window.__urbana_diag=window.__urbana_diag||{errors:[]},window.__urbana_diag.errors.push({type:"contact_modal_invalid",value:String(T)})}catch{}return s("div",{className:"p-4 bg-warning/5 border border-warning/10 rounded-medium",children:[e("h4",{className:"font-semibold mb-2",children:"Enquiry form failed to open"}),e("p",{className:"text-sm text-default-600",children:"The enquiry form component is not available. This is likely a build/import issue. See the console for diagnostic details."}),e("pre",{className:"text-xs mt-2",children:JSON.stringify({ContactModal:String(T),typeofContactModal:typeof T},null,2)})]})}return e(T,{open:w,onClose:g})}catch(a){console.error("[Step4] Error mounting ContactModal",a,a&&a.stack);try{window.__urbana_diag=window.__urbana_diag||{errors:[]},window.__urbana_diag.errors.push({type:"contact_modal_mount_error",message:String(a&&a.message),stack:a&&a.stack})}catch{}return s("div",{className:"p-4 bg-warning/5 border border-warning/10 rounded-medium",children:[e("h4",{className:"font-semibold mb-2",children:"Enquiry form failed to open"}),e("p",{className:"text-sm text-default-600",children:"An error occurred while opening the enquiry form. See console for details."}),e("pre",{className:"text-xs mt-2",children:String(a&&a.message)})]})}})(),s(ge,{"aria-label":"Product information tabs",variant:"underlined",color:"primary",children:[e(H,{title:"Details",children:e(U,{children:e(F,{className:"p-6",children:s("div",{className:"prose max-w-none",children:[e("p",{className:"text-default-700",children:r.description}),e("h4",{className:"text-lg font-medium mt-6 mb-3",children:"Specifications"}),e("ul",{className:"space-y-2",children:r.specifications.map((a,c)=>s("li",{className:"flex items-start gap-2",children:[e(v,{icon:"lucide:chevron-right",className:"text-primary mt-1 flex-shrink-0",width:16}),e("span",{children:a})]},c))})]})})})},"details"),e(H,{title:"Image Gallery",children:e(U,{children:e(F,{className:"p-6",children:e("div",{ref:o,className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4",children:r.imageGallery.map((a,c)=>e("div",{"data-gallery-index":c,className:"aspect-square cursor-pointer pointer-events-auto",onClick:m=>{i&&console.log(`[Step4 wrapper click] index: ${c}`),m.stopPropagation(),k(c)},onMouseEnter:()=>{X(a).catch(()=>{})},children:e(K,{imagePath:a,productCode:n,alt:`${r.name} - Image ${c+1}`,className:"w-full h-full object-cover rounded-medium",onClick:()=>k(c),loading:"lazy"})},c))})})})},"gallery"),e(H,{title:"Downloads",children:e(U,{children:e(F,{className:"p-6",children:s("div",{className:"space-y-4",children:[e("p",{className:"text-default-600 mb-4",children:"Download product documentation and technical files:"}),e("div",{className:"space-y-3",children:Object.entries(r.files).map(([a,c])=>s("div",{className:"flex items-center justify-between p-3 border border-default-200 rounded-medium hover:border-primary transition-colors",children:[s("div",{className:"flex items-center gap-3",children:[e("div",{className:"p-2 bg-default-100 rounded-medium",children:e(v,{icon:We(c),className:"text-default-600",width:20})}),s("div",{children:[e("p",{className:"font-medium",children:a}),e("p",{className:"text-xs text-default-500",children:He(c)})]})]}),e($,{size:"sm",variant:"flat",color:"primary",onPress:()=>p(c,Ke(c,a)),endContent:e(v,{icon:"lucide:download",width:16}),children:"Download"})]},c))})]})})})},"files"),e(H,{title:"FAQ",children:e(U,{children:e(F,{className:"p-6",children:e(Ee,{children:r.faqs&&r.faqs.length>0?r.faqs.map((a,c)=>e(ie,{title:a.question,children:a.answer},c)):[{q:"What is the installation process?",a:"Installation typically requires a concrete foundation and can be completed by our certified installers. The process usually takes 1-3 days depending on the product complexity and site conditions."},{q:"What maintenance is required?",a:"Our products are designed for minimal maintenance. We recommend a visual inspection every 6 months and cleaning as needed. Specific maintenance schedules are provided in the product documentation."},{q:"Are customizations available?",a:"Yes, most products can be customized with different colors, materials, and additional features. Custom options can be selected in the next step of this configuration process."},{q:"What warranty is provided?",a:"Standard warranty is 10 years on structural components and 5 years on other elements. Extended warranties are available for purchase. All warranties cover manufacturing defects and normal wear."}].map((a,c)=>e(ie,{title:a.q,children:a.a},`fallback-${c}`))})})})},"faq")]}),e(te,{images:r.imageGallery,productCode:n,open:b,initialIndex:f,onClose:E})]})};function We(t){var i;const n=(i=t.split(".").pop())==null?void 0:i.toLowerCase(),r={pdf:"lucide:file-text",dwg:"lucide:file-cog",rvt:"lucide:file-3d",doc:"lucide:file-text",docx:"lucide:file-text",xls:"lucide:file-spreadsheet",xlsx:"lucide:file-spreadsheet",zip:"lucide:file-archive",default:"lucide:file"};return r[n||""]||r.default}function He(t){var i;const n=(i=t.split(".").pop())==null?void 0:i.toLowerCase(),r={pdf:"2.4 MB",dwg:"5.8 MB",rvt:"12.6 MB",doc:"1.2 MB",docx:"1.5 MB",xls:"3.1 MB",xlsx:"3.4 MB",zip:"8.7 MB",default:"1.0 MB"};return r[n||""]||r.default}function Ke(t,n){try{let i="";try{i=(new URL(t).pathname||"").split("/").pop()||""}catch{const u=t.split("/");i=u[u.length-1]||""}if(i=i.split("?")[0].split("#")[0],i&&i.includes("."))return decodeURIComponent(i)}catch(i){debugMode&&console.error("Error extracting filename from URL:",i)}const r=(t.split(".").pop()||"").toLowerCase().split("?")[0].split("#")[0];return r&&!n.includes(".")?`${n}.${r}`:n}const Ye=({data:t,options:n,onOptionsChange:r,selectedProductCode:i})=>{const p=window.urbanaDebugMode||!1,u=ee(i),l=ee(null),o=z(()=>{var a;return i?(a=t.productOptions)!=null&&a[i]?t.productOptions[i]:{}:t.options},[i,t.productOptions,t.options]);p&&console.log(t);const b=z(()=>Object.keys(o).length>0,[o]),y=z(()=>{const a={};return Object.keys(o).forEach(m=>{n[m]&&(a[m]=n[m])}),a},[n,o]);R(()=>{if(u.current!==i){u.current=i;const a=Object.keys(o),c=Object.keys(n);if(c.some(x=>!a.includes(x))||c.length===0){const x={};c.forEach(C=>{a.includes(C)&&(x[C]=n[C])}),JSON.stringify(x)!==JSON.stringify(n)&&r(x)}}},[i,o]);const f=ae((a,c)=>{l.current=a,r({...y,[a]:c})},[y,r]),_=z(()=>{var c;const a=Object.keys(o);if(a.length===0)return null;if(l.current&&n[l.current]){const m=(c=o[l.current])==null?void 0:c.find(x=>x.value===n[l.current]);if(m!=null&&m.imageUrl)return m.imageUrl}for(let m=a.length-1;m>=0;m--){const x=a[m],P=n[x];if(P&&o[x]){const C=o[x].find(A=>A.value===P);if(C!=null&&C.imageUrl)return C.imageUrl}}return null},[n,o]),h=z(()=>{var a;if(i&&((a=t.productDetails)!=null&&a[i])){const c=t.productDetails[i].imageGallery;if(c&&c.length>0)return c[0]}return"https://img.heroui.chat/image/landscape?w=800&h=600&u=preview_default"},[i,t.productDetails]),N=_||h,k={hidden:{opacity:0},show:{opacity:1,transition:{duration:.5}}};if(!b)return e(D.div,{className:"space-y-6",initial:"hidden",animate:"show",variants:k,children:e(U,{children:s(F,{className:"p-8 text-center",children:[e(v,{icon:"lucide:settings",width:48,className:"text-default-300 mx-auto mb-4"}),e("h3",{className:"text-lg font-medium mb-2",children:"No Configuration Options"}),e("p",{className:"text-default-600",children:i?s(_e,{children:["This product doesn't have any configurable options.",s("span",{className:"block mt-2 text-sm",children:["Product: ",e("strong",{children:i})]})]}):"Please select a product first to see available configuration options."}),e("p",{className:"text-sm text-default-500 mt-4",children:i?"Proceed to the next step to complete your inquiry.":"Go back to the previous step and select a product."})]})})});const[S,E]=L(!1),[w,M]=L(0),[j,I]=L([]),d=(a,c=0)=>{I(a||[]),M(c),E(!0)},g=()=>E(!1);return s(D.div,{className:"space-y-6",initial:"hidden",animate:"show",variants:k,children:[i&&s("div",{className:"flex items-center gap-2 text-sm text-default-600",children:[e(v,{icon:"lucide:package",width:16}),s("span",{children:["Configuring options for: ",e("strong",{children:i})]})]}),e("p",{className:"text-default-600 mb-4",children:"Customize your product by selecting from the available options below:"}),s(ge,{"aria-label":"Product configuration tabs",variant:"underlined",color:"primary",children:[e(H,{title:"Configuration Options",children:e(U,{children:e(F,{className:"p-6",children:s("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e("div",{className:"space-y-4",children:Object.entries(o).map(([a,c])=>s("div",{className:"space-y-2",children:[e("label",{className:"text-sm font-medium text-default-700",children:a}),e(he,{label:a,placeholder:`Select ${a}`,selectedKeys:n[a]?[n[a]]:[],onChange:m=>{const x=m.target.value;l.current=a,f(a,x)},className:"max-w-full",children:c.map(m=>e(fe,{children:typeof m=="string"?m:m.value},typeof m=="string"?m:m.value))})]},a))}),e("div",{children:s("div",{className:"border border-default-200 rounded-medium p-4",children:[e("h4",{className:"text-sm font-medium mb-2",children:"Preview"}),e("div",{className:"aspect-video mb-4 cursor-pointer",onClick:()=>d([N],0),children:e(K,{imagePath:N,productCode:i||"",className:"w-full h-full object-cover rounded-medium",onClick:()=>d([N],0)},N)}),s("div",{className:"space-y-2",children:[e("h5",{className:"text-xs font-medium text-default-500",children:"Selected Options:"}),Object.keys(y).length>0?e("ul",{className:"text-sm space-y-1",children:Object.entries(y).map(([a,c])=>s("li",{className:"flex items-center gap-2",children:[e(v,{icon:"lucide:check",className:"text-success",width:14}),s("span",{className:"font-medium",children:[a,":"]})," ",c]},a))}):e("p",{className:"text-sm text-default-500",children:"No options selected yet. Choose from the available options."})]})]})})]})})})},"options"),e(H,{title:"Option Impact",children:e(U,{children:e(F,{className:"p-6",children:s("div",{className:"space-y-6",children:[s("div",{className:"space-y-2",children:[e("h4",{className:"text-lg font-medium",children:"How Options Affect Your Product"}),e("p",{className:"text-default-600",children:"Different options can impact the appearance, durability, and functionality of your product. Below is a summary of how each option affects your selection."})]}),e("div",{className:"space-y-4",children:Object.entries(o).map(([a,c])=>s("div",{className:"border-b border-default-200 pb-4 last:border-0",children:[e("h5",{className:"font-medium mb-2",children:a}),e("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:c.map((m,x)=>{const P=typeof m=="string"?m:m.value,C=typeof m=="object"&&m.imageUrl?m.imageUrl:null;return s("div",{className:"p-3 border border-default-200 rounded-medium",children:[C&&e("div",{className:"aspect-video mb-2 rounded-small overflow-hidden cursor-pointer",onClick:()=>d([C],0),children:e(K,{imagePath:C,productCode:i||"",className:"w-full h-full object-cover",onClick:()=>d([C],0)})}),e("div",{className:"font-medium",children:P}),s("div",{className:"text-sm text-default-500",children:[x===0&&"Standard option with included features",x===1&&"Enhanced durability and premium finish",x===2&&"Maximum performance and longevity"]})]},P)})})]},a))})]})})})},"impact"),e(H,{title:"Pricing Impact",children:e(U,{children:e(F,{className:"p-6",children:s("div",{className:"space-y-6",children:[s("div",{className:"space-y-2",children:[e("h4",{className:"text-lg font-medium",children:"Option Pricing"}),e("p",{className:"text-default-600",children:"Different configuration options affect the final price of your product. Below is a breakdown of how each selection impacts pricing."})]}),s("table",{className:"w-full text-sm",children:[e("thead",{children:s("tr",{className:"border-b border-default-200",children:[e("th",{className:"py-2 px-4 text-left font-medium",children:"Option"}),e("th",{className:"py-2 px-4 text-left font-medium",children:"Selection"}),e("th",{className:"py-2 px-4 text-right font-medium",children:"Price Impact"})]})}),e("tbody",{children:Object.entries(o).map(([a,c])=>e(O.Fragment,{children:c.map((m,x)=>{const P=typeof m=="string"?m:m.value;return s("tr",{className:"border-b border-default-100",children:[x===0?e("td",{className:"py-2 px-4 align-top",rowSpan:c.length,children:a}):null,s("td",{className:"py-2 px-4",children:[P,x===0&&e("span",{className:"text-xs text-default-400 ml-2",children:"(Standard)"})]}),e("td",{className:"py-2 px-4 text-right",children:x===0?"Included":`+$${(x*250+Math.random()*100).toFixed(0)}`})]},`${a}-${P}`)})},a))})]}),e("div",{className:"bg-default-50 p-4 rounded-medium",children:s("p",{className:"text-sm text-default-600",children:[e(v,{icon:"lucide:info",className:"inline-block mr-2",width:16}),"For exact pricing including all options and installation, please complete the form in the next step and our team will provide a detailed quote."]})})]})})})},"pricing")]}),e(te,{images:j,productCode:i||"",open:S,initialIndex:w,onClose:g})]})},Je=({data:t})=>{const{currentStep:n,selections:r,isSubmitting:i,isSubmitted:p,updateSelection:u,nextStep:l,previousStep:o,goToStep:b,canProceedToStep:y}=q(),f=window.urbanaDebugMode||!1,_=t.stepperForm.steps.length,h=z(()=>{var m;if(!r.individualProduct)return{};const d=t.stepperForm.steps[4],g=(m=d==null?void 0:d.productOptions)==null?void 0:m[r.individualProduct];if(!g)return{};const a={},c=Object.keys(g);return Object.entries(r.options).forEach(([x,P])=>{c.includes(x)&&(a[x]=P)}),a},[r.individualProduct,r.options,t.stepperForm.steps]);R(()=>{f&&(console.log("[ProductStepper] currentStep:",n),console.log("[ProductStepper] selections:",r),console.log("[ProductStepper] stepData:",t.stepperForm.steps[n-1]),console.log("[ProductStepper] validProductOptions:",h))},[n,r,t.stepperForm.steps,h,f]);const N=ae(async()=>{var d;q.getState().setSubmitting(!0);try{const g={productGroup:r.productGroup,productRange:r.productRange,individualProduct:r.individualProduct,options:h,contactInfo:r.contactInfo};if(f&&console.log("Submitting form data:",g),!(await fetch("/wp-json/urbana/v1/submit-form",{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":((d=window.urbanaPublic)==null?void 0:d.nonce)||""},body:JSON.stringify({selections:g,submittedAt:new Date().toISOString()})})).ok)throw new Error("Failed to submit form");q.getState().setSubmitted(!0)}catch(g){console.error("Error submitting form:",g),alert("Failed to submit form. Please try again.")}finally{q.getState().setSubmitting(!1)}},[r,h]),k=d=>{b(d)},S=()=>{l()},E=()=>{o()},w=O.useCallback(()=>{const d=t.stepperForm.steps[n-1];switch(n){case 1:return e(Ue,{data:{categories:(d==null?void 0:d.categories)||[],productGroups:(d==null?void 0:d.productGroups)||[]},selection:r.productGroup||null,onSelect:a=>u("productGroup",a)});case 2:return e(Ae,{data:{ranges:(d==null?void 0:d.ranges)||{},productRanges:(d==null?void 0:d.productRanges)||[],relationships:d==null?void 0:d.relationships},productGroup:r.productGroup||"",selection:r.productRange||null,onSelect:a=>u("productRange",a)});case 3:return e(Be,{data:{products:(d==null?void 0:d.products)||{},productsData:(d==null?void 0:d.productsData)||[],relationships:d==null?void 0:d.relationships},productRange:r.productRange||"",selection:r.individualProduct||null,onSelect:a=>u("individualProduct",a)});case 4:const g=r.individualProduct||"unknown-product";return console.log("Step 4 Data:",d==null?void 0:d.productDetails),console.log("Product ID:",g),e(Ve,{data:{productDetails:(d==null?void 0:d.productDetails)||{}},productId:g});case 5:return e(Ye,{data:{options:(d==null?void 0:d.options)||{},productOptions:(d==null?void 0:d.productOptions)||{},dynamicUpdates:(d==null?void 0:d.dynamicUpdates)||{updateImages:!1,updateFiles:!1}},options:r.options||{},onOptionsChange:a=>u("options",a),selectedProductCode:r.individualProduct||void 0});case 6:return e(Z,{data:{fields:(d==null?void 0:d.fields)||[]},contactInfo:r.contactInfo,onContactInfoChange:a=>u("contactInfo",a),isSubmitting:i,isSubmitted:p,onSubmit:N});default:return e("div",{children:"Unknown step"})}},[n,t.stepperForm.steps,r,u,i,p,N]),M=y(n+1),j=n===_,I={hidden:{opacity:0,x:10},visible:{opacity:1,x:0},exit:{opacity:0,x:-10}};return s("div",{className:"space-y-6",children:[e(qe,{currentStep:n,totalSteps:_,steps:t.stepperForm.steps,selections:r,onStepClick:k}),e(U,{className:"shadow-sm",children:e(F,{className:"p-6",children:s(D.div,{initial:"hidden",animate:"visible",exit:"exit",variants:I,transition:{duration:.25},children:[e("h2",{className:"text-xl font-semibold mb-6",children:t.stepperForm.steps[n-1].title}),w()]},n)})}),e($e,{currentStep:n,totalSteps:_,onNext:S,onPrevious:E,canProceed:M,isLastStep:j,isSubmitting:i,isSubmitted:p,onSubmit:N})]})};function Xe(){const{productData:t,initializeProductData:n}=q(),[r,i]=L(!0),[p,u]=L(null),l=window.urbanaDebugMode||!1;return R(()=>{try{const o=window.urbanaPublic;o!=null&&o.productData?(l&&console.log("Loading product data from database:",o.productData),n(),u(null)):(l&&console.warn("No product data found in window.urbanaPublic, using default data"),q.getState().setProductData(se),u("Using default product data - database may be empty"))}catch(o){l&&console.error("Error initializing product data:",o),u("Failed to load product data"),q.getState().setProductData(se)}finally{i(!1)}},[n]),r?e("div",{className:"min-h-screen bg-background",children:e("div",{className:"flex items-center justify-center h-64",children:s("div",{className:"flex flex-col items-center gap-4",children:[e(ke,{size:"lg"}),e("p",{className:"text-foreground-600",children:"Loading product configuration..."})]})})}):t?e("div",{className:"min-h-screen bg-background",children:e("div",{className:"py-12 px-4 sm:px-6",children:s("div",{className:"max-w-4xl mx-auto",children:[s("div",{className:"text-center mb-8",children:[e("h1",{className:"text-2xl font-semibold text-foreground",children:"Product Configuration"}),e("p",{className:"text-foreground-500 mt-2",children:"Select and customize your product in a few simple steps"})]}),p&&e(oe,{color:"warning",variant:"flat",className:"mb-6",title:"Development Notice",description:p,startContent:e(v,{icon:"lucide:info",width:20})}),e(Je,{data:t})]})})}):e("div",{className:"min-h-screen bg-background",children:e("div",{className:"py-12 px-4 sm:px-6",children:e("div",{className:"max-w-4xl mx-auto",children:e(oe,{color:"danger",variant:"flat",className:"mb-6",title:"Configuration Error",description:"Unable to load product configuration data. Please contact support.",startContent:e(v,{icon:"lucide:alert-triangle",width:20})})})})})}class Qe extends O.Component{constructor(n){super(n),this.state={hasError:!1,error:null}}static getDerivedStateFromError(n){return{hasError:!0,error:n}}componentDidCatch(n,r){try{console.error("ErrorBoundary caught error",n,r),window.__urbana_diag=window.__urbana_diag||{errors:[]},window.__urbana_diag.errors.push({type:"error_boundary",message:n.message,stack:n.stack||null,info:r})}catch{}}render(){var n,r,i,p,u;if(this.state.hasError){const l=typeof window<"u"&&(window.urbanaDebugMode||((n=window.urbanaAdmin)==null?void 0:n.debugMode)||((r=window.urbanaPublic)==null?void 0:r.debugMode)||!1);return s("div",{className:"p-8 bg-danger/5 border border-danger/10 rounded-medium text-center",children:[e("h2",{className:"text-lg font-semibold text-danger mb-2",children:"Something went wrong"}),e("p",{className:"text-sm text-default-600 mb-4",children:"An unexpected error occurred while rendering this application."}),e("pre",{className:"text-xs text-default-400 whitespace-pre-wrap",children:(i=this.state.error)==null?void 0:i.message}),l&&((p=this.state.error)==null?void 0:p.stack)&&s("details",{className:"mt-3 text-left text-xs text-default-400",children:[e("summary",{className:"cursor-pointer",children:"View stack trace"}),e("pre",{className:"whitespace-pre-wrap",children:(u=this.state.error)==null?void 0:u.stack})]})]})}return this.props.children}}var de,ue;if(typeof window<"u"){window.__urbana_diag=window.__urbana_diag||{errors:[]};try{(window.urbanaDebugMode||((de=window.urbanaAdmin)==null?void 0:de.debugMode)||((ue=window.urbanaPublic)==null?void 0:ue.debugMode)||!1)&&console.warn("[Urbana Stepper] ENTRY: bundle evaluated"),window.__urbana_diag.entryEvaluated=!0}catch{}}try{Ce.createRoot(document.getElementById("urbana-stepper-root")).render(e(O.StrictMode,{children:s(je,{children:[e(De,{}),e(Qe,{children:e("main",{className:"text-foreground bg-background",children:e(Xe,{})})})]})}))}catch(t){console.error("[Urbana Stepper] render call failed",t);try{window.__urbana_diag=window.__urbana_diag||{errors:[]},window.__urbana_diag.errors.push({type:"render_error",message:String(t),stack:t&&t.stack?t.stack:null})}catch{}}var me,pe;if(typeof window<"u"){window.__urbana_diag=window.__urbana_diag||{errors:[]},window.addEventListener("error",t=>{try{const n=t&&(t.error&&t.error.message?t.error.message:t.message||String(t));console.error("[Urbana diag] global error:",n,t.error||t),window.__urbana_diag.errors.push({type:"error",message:n,stack:t&&t.error&&t.error.stack?t.error.stack:null})}catch{}},!0),window.addEventListener("unhandledrejection",t=>{try{const n=t&&(t.reason&&t.reason.message?t.reason.message:String(t.reason));console.error("[Urbana diag] unhandledrejection:",n,t.reason||t),window.__urbana_diag.errors.push({type:"unhandledrejection",message:n,stack:t&&t.reason&&t.reason.stack?t.reason.stack:null})}catch{}},!0);try{window.urbanaStepperEntry=!0;const t=window.urbanaDebugMode||((me=window.urbanaAdmin)==null?void 0:me.debugMode)||((pe=window.urbanaPublic)==null?void 0:pe.debugMode)||!1;t&&(console.warn("[Urbana Stepper] module entry"),console.log("[Urbana Stepper] attempting to render"));try{window.urbanaStepperLoaded=!0,t&&console.log("[Urbana Stepper] main bundle loaded")}catch(n){throw console.error("[Urbana Stepper] error setting loaded flag",n),window.__urbana_diag.errors.push({type:"flag_error",message:String(n),stack:n&&n.stack?n.stack:null}),n}}catch(t){console.error("[Urbana Stepper] module initialization error",t);try{window.__urbana_diag.errors.push({type:"init_error",message:String(t),stack:t&&t.stack?t.stack:null})}catch{}}}
