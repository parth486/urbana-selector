import{f as fe,u as ge,a as be,c as we,j as e,b as i,d as R,I as N,w as M,e as G,g as T,h as $,i as j,k as q,l as J,m as ee,n as Q,F as ye,s as xe,o as ve,p as Ne,R as Se}from"./iconPatch.js";import{i as _e,a as ke,b as ae,p as re,c as ne,T as Ce}from"./productData.js";import{m as E}from"./proxy.js";import{c as Pe,t as ue,a as W}from"./chunk-ML27DD5T.js";import{t as me,c as pe,a as Oe,d as Ee,p as Me,H as De}from"./middleware.js";import"./accelerated-values.js";import"./create-visual-element.js";var he=fe((t,r)=>{var a;const{as:n,className:h,children:d,...c}=t,o=n||"div",w=ge(r),{slots:x,classNames:b}=be(),k=we(b==null?void 0:b.footer,h);return e(o,{ref:w,className:(a=x.footer)==null?void 0:a.call(x,{class:k}),...c,children:d})});he.displayName="HeroUI.CardFooter";var Ie=he;const Le=({currentStep:t,totalSteps:r,onNext:a,onPrevious:n,canProceed:h,isLastStep:d,isSubmitting:c,isSubmitted:o,onSubmit:w})=>i("div",{className:"flex justify-between items-center pt-4",children:[e("div",{children:t>1&&e(R,{variant:"flat",color:"default",onPress:n,startContent:e(N,{icon:"lucide:arrow-left",width:18}),children:"Previous"})}),i("div",{className:"text-default-500 text-sm",children:["Step ",t," of ",r]}),e("div",{children:d?e(R,{color:"primary",isDisabled:!h||c||o,isLoading:c,onPress:w,endContent:!c&&!o&&e(N,{icon:"lucide:send",width:18}),children:o?i(E.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},className:"flex items-center gap-2",children:[e(N,{icon:"lucide:check",width:18}),"Submitted"]}):"Submit"}):e(R,{color:"primary",isDisabled:!h,onPress:a,endContent:e(N,{icon:"lucide:arrow-right",width:18}),children:"Next"})})]}),je=({currentStep:t,totalSteps:r,steps:a,selections:n,onStepClick:h})=>{const d=c=>c===1?!0:c===2?!!n.productGroup:c===3?!!n.productRange:c===4||c===5||c===6?!!n.individualProduct:!1;return e("div",{className:"hidden md:block mb-8",children:e("div",{className:"flex items-center justify-between",children:a.map(c=>{const o=c.step===t,w=c.step<t,x=d(c.step);return i(M.Fragment,{children:[i("div",{className:"flex flex-col items-center relative",children:[e("button",{className:`w-10 h-10 rounded-full flex items-center justify-center transition-all duration-200 ${o?"bg-primary text-white":w?"bg-success text-white":"bg-default-100 text-default-500"} ${x?"cursor-pointer hover:opacity-80":"cursor-not-allowed opacity-60"}`,onClick:()=>x&&h(c.step),disabled:!x,"aria-label":`Go to step ${c.step}: ${c.title}`,children:w?e(N,{icon:"lucide:check",width:20}):e("span",{children:c.step})}),e("span",{className:`text-xs mt-2 text-center max-w-[80px] ${o?"text-primary font-medium":"text-default-500"}`,children:c.title})]}),c.step<r&&e("div",{className:"flex-1 h-[2px] mx-2 bg-default-200",children:e("div",{className:"h-full bg-primary transition-all duration-300",style:{width:w?"100%":"0%"}})})]},c.step)})})})},Re=({data:t,selection:r,onSelect:a})=>{const n=G(()=>{var c;return t.productGroups&&Array.isArray(t.productGroups)?t.productGroups.filter(o=>o.active!==!1):((c=t.categories)==null?void 0:c.map(o=>({id:o.toLowerCase().replace(/\s+/g,"-"),name:o,icon:qe(o),description:Ue(o),active:!0})))||[]},[t.productGroups,t.categories]),h={hidden:{opacity:0},show:{opacity:1,transition:{staggerChildren:.1}}},d={hidden:{opacity:0,y:20},show:{opacity:1,y:0}};return i("div",{children:[e("p",{className:"text-default-600 mb-6",children:"Please select a product category to begin your configuration."}),e(E.div,{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4",variants:h,initial:"hidden",animate:"show",children:n.map(c=>e(E.div,{variants:d,children:e(T,{isPressable:!0,onPress:()=>a(c.name),className:`transition-all duration-200 ${r===c.name?"border-2 border-primary shadow-md":"border border-default-200 hover:border-primary hover:shadow-sm"}`,children:i($,{className:"flex flex-col items-center text-center p-6",children:[e("div",{className:`w-12 h-12 rounded-full flex items-center justify-center mb-3 ${r===c.name?"bg-primary text-white":"bg-default-100 text-default-500"}`,children:e(N,{icon:c.icon,width:24})}),e("h3",{className:"text-lg font-medium",children:c.name}),e("p",{className:"text-default-500 text-sm mt-1",children:c.description})]})})},c.id))})]})};function qe(t){return{Shelter:"lucide:home",Toilet:"lucide:bath",Bridge:"lucide:route",Access:"lucide:wheelchair",Seating:"lucide:armchair",Lighting:"lucide:lamp"}[t]||"lucide:box"}function Ue(t){return{Shelter:"Outdoor structures for shade and protection",Toilet:"Public and portable sanitation facilities",Bridge:"Pedestrian and light vehicle crossings",Access:"Ramps, stairs, and accessibility solutions",Seating:"Benches and outdoor furniture options",Lighting:"Outdoor and pathway lighting solutions"}[t]||"Product category"}const Te=({data:t,productGroup:r,selection:a,onSelect:n})=>{t.ranges[r];const h=G(()=>{var w,x;if(t.productRanges&&t.relationships){const b=r.toLowerCase().replace(/\s+/g,"-"),k=((w=t.relationships.groupToRanges)==null?void 0:w[b])||[];return t.productRanges.filter(p=>k.includes(p.id)&&p.active!==!1)}return(((x=t.ranges)==null?void 0:x[r])||[]).map(b=>({id:b.toLowerCase().replace(/\s+/g,"-"),name:b,image:"",description:$e(b),tags:Ae(b),active:!0}))},[t.productRanges,t.relationships,t.ranges,r]),d={hidden:{opacity:0},show:{opacity:1,transition:{staggerChildren:.1}}},c={hidden:{opacity:0,y:20},show:{opacity:1,y:0}};return i("div",{children:[i("p",{className:"text-default-600 mb-6",children:["Select a product range from the ",r," category:"]}),e(E.div,{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",variants:d,initial:"hidden",animate:"show",children:h.map((o,w)=>{const x=a===o.name;return e(E.div,{variants:c,children:e(T,{isPressable:!0,onPress:()=>n(o.name),className:`transition-all duration-200 ${x?"border-2 border-primary shadow-md":"border border-default-200 hover:border-primary hover:shadow-sm"}`,children:e($,{className:"p-0",children:i("div",{className:"flex flex-col sm:flex-row",children:[o.image&&e(Pe,{className:"p-0",children:e(_e,{src:o.image,alt:o.name,className:"w-full h-40 object-cover",radius:"none"})}),i("div",{className:"p-4 flex-1",children:[e("h3",{className:"text-lg font-medium",children:o.name}),e("p",{className:"text-default-500 text-sm mt-2",children:o.description}),e("div",{className:"mt-3 flex flex-wrap gap-2",children:o.tags.map(b=>e("span",{className:"text-xs px-2 py-1 bg-default-100 text-default-700 rounded-medium",children:b},b))})]})]})})})},o.id)})})]})};function $e(t){return{Peninsula:"Modern shelters with excellent weather protection for parks and urban settings",Whyalla:"Robust shelters designed for coastal and high-wind environments",Coastal:"Corrosion-resistant designs perfect for beachfront and marine locations",Urban:"Contemporary designs that blend with modern city landscapes",Heritage:"Traditional designs that complement historic and cultural settings",EcoSan:"Environmentally friendly composting toilet solutions with minimal water usage",Standard:"Reliable and cost-effective public toilet facilities",Accessible:"Fully compliant accessible toilet facilities with enhanced features",Premium:"High-end toilet facilities with superior finishes and amenities",Compact:"Space-saving designs for areas with limited footprint","Small Span":"Compact bridges for garden paths and small water crossings","Large Span":"Extended bridges for wider crossings and heavier loads",Pedestrian:"Dedicated walkways designed for high foot traffic areas","Decorative Bridge":"Ornamental bridges that serve as landscape features","Heavy Duty":"Reinforced bridges capable of supporting maintenance vehicles",Ramp:"Gentle slope access solutions for wheelchairs and strollers",Staircase:"Step access with various configurations and safety features",Pathway:"Connected walkway systems for parks and public spaces",Boardwalk:"Elevated walkways for wetlands and sensitive environments",Platform:"Viewing platforms and elevated observation areas",Bench:"Traditional seating options for parks and public spaces","Table Setting":"Combined table and seating arrangements for picnic areas",Lounge:"Comfortable extended seating for relaxation areas",Stadium:"Tiered seating solutions for sports and event venues",Custom:"Bespoke seating arrangements designed to specification",Solar:"Self-sufficient lighting powered by renewable energy","Mains Powered":"Connected lighting solutions with reliable performance","Decorative Light":"Aesthetic lighting features that enhance landscapes",Security:"High visibility lighting for safety and security","Pathway Light":"Directional lighting for walkways and pedestrian areas"}[t]||`${t} product line with various options and configurations.`}function Ae(t,r){const a={Peninsula:["Modern","Weather-resistant","Versatile"],Whyalla:["Robust","Wind-resistant","Durable"],Coastal:["Corrosion-resistant","Salt-proof","UV-stable"],Urban:["Contemporary","Modular","Space-efficient"],Heritage:["Traditional","Ornate","Classic"],EcoSan:["Eco-friendly","Low-water","Composting"],Standard:["Cost-effective","Reliable","Low-maintenance"],Accessible:["ADA Compliant","Spacious","Universal"],Premium:["High-end","Enhanced features","Superior finishes"],Compact:["Space-saving","Efficient","Urban-friendly"],"Small Span":["Compact","Decorative","Easy-install"],"Large Span":["Extended","Reinforced","Heavy-load"],Pedestrian:["High-traffic","Safety-focused","Accessible"],Decorative:["Ornamental","Artistic","Feature piece"],"Heavy Duty":["Vehicle-rated","Industrial","Maximum strength"],default:["Quality","Durable","Customizable"]};return a[t]||a.default}const Fe=({data:t,productRange:r,selection:a,onSelect:n})=>{t.products[r];const h=G(()=>{var w;if(t.productsData&&t.relationships){const x=r.toLowerCase().replace(/\s+/g,"-"),b=t.relationships.rangeToProducts[x]||[];return t.productsData.filter(k=>b.includes(k.id)&&k.active!==!1)}return(((w=t.products)==null?void 0:w[r])||[]).map(x=>({id:x.toLowerCase(),code:x,name:`${x} Product`,overview:ie(x),description:ie(x),specifications:[],imageGallery:[],files:{},active:!0}))},[t.productsData,t.relationships,t.products,r]),d={hidden:{opacity:0},show:{opacity:1,transition:{staggerChildren:.05}}},c={hidden:{opacity:0,y:10},show:{opacity:1,y:0}};return i("div",{children:[i("p",{className:"text-default-600 mb-6",children:["Select a specific product from the ",r," range:"]}),e(E.div,{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4",variants:d,initial:"hidden",animate:"show",children:h.map(o=>{const w=a===o.code;return o.imageGallery.length>0,e(E.div,{variants:c,children:i(T,{isPressable:!0,onPress:()=>n(o.code),className:`h-full w-full transition-all duration-200 ${w?"border-2 border-primary shadow-md":"border border-default-200 hover:border-primary hover:shadow-sm"}`,children:[i($,{className:"p-4",children:[e("div",{className:"flex items-center justify-center mb-3",children:e("h3",{className:"text-lg font-medium",children:o.name})}),e("p",{className:"text-default-500 text-sm text-center",children:o.overview||o.description}),o.specifications.length>0&&i("div",{className:"space-y-1",children:[e("p",{className:"text-xs font-semibold text-default-700 text-center",children:"Key Features:"}),i("div",{className:"text-xs text-default-500",children:[o.specifications.slice(0,3).map((x,b)=>i("div",{className:"flex items-start justify-center",children:[e(N,{icon:"lucide:check",width:14,className:"mr-1 mt-0.5 text-success"}),e("span",{children:x})]},b)),o.specifications.length>3&&i("div",{className:"text-default-400 mt-1",children:["+",o.specifications.length-3," more features"]})]})]})]}),Object.keys(o.files).length>0&&e(Ie,{className:"border-t border-default-100 px-4 py-2 justify-center",children:i("div",{className:"flex items-center gap-2 text-xs text-default-600",children:[e(N,{icon:"lucide:file-text",width:14}),i("span",{children:[Object.keys(o.files).length," document",Object.keys(o.files).length!==1?"s":""," available"]})]})})]})},o.id)})})]})};function ie(t){const r=t.match(/[A-Z]+\d+/),a=r?r[0]:t;return{K301:"Compact shelter with modern design, suitable for parks and urban settings.",K302:"Medium-sized shelter with extended roof coverage for picnic areas.",K308:"Large shelter with multiple seating options and enhanced weather protection.",K310:"Premium shelter with architectural design elements and superior materials.",K315:"Deluxe shelter with integrated seating and optional power connections.",E201:"Eco-friendly toilet with composting technology and minimal water usage.",E202:"Solar-powered toilet facility with self-contained waste management.",SS101:"Small pedestrian bridge for garden paths and decorative water crossings.",SS102:"Compact bridge with enhanced load capacity for light maintenance vehicles.",R101:"ADA compliant access ramp with gentle slope and non-slip surface.",R102:"Modular ramp system adaptable to various height requirements."}[a]||`${t} model with standard features and customization options.`}const z=new Map,Y=new Map;async function K(t,r){if(!t)return null;if(z.has(t))return z.get(t);if(Y.has(t))return Y.get(t);const a=(async()=>{var c,o;const n=((c=window.urbanaPublic)==null?void 0:c.nonce)||((o=window.urbanaAdmin)==null?void 0:o.nonce)||"",h=await fetch("/wp-json/urbana/v1/image-proxy",{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":n},body:JSON.stringify({image_path:t})});if(!h.ok)throw new Error(`HTTP ${h.status}: ${h.statusText}`);const d=await h.json();if(d.success&&d.method==="presigned_url"&&d.image_url){const w={url:d.image_url,method:"presigned_url"};return z.set(t,w),Y.delete(t),w}if(d.success&&d.image_data){const w={url:d.image_data,method:d.method||"base64"};return z.set(t,w),Y.delete(t),w}throw Y.delete(t),new Error(d.error||d.message||"Failed to fetch image")})();return Y.set(t,a),a}const H=({imagePath:t,productCode:r,className:a="",alt:n="Product image",onClick:h,loading:d="lazy",fetchPriority:c="auto"})=>{var P,y;const[o,w]=j(""),[x,b]=j(!0),[k,p]=j(""),[_,C]=j(""),S=window.urbanaDebugMode||((P=window.urbanaAdmin)==null?void 0:P.debugMode)||((y=window.urbanaPublic)==null?void 0:y.debugMode)||!1;return q(()=>{t&&(async()=>{var L,u;try{b(!0),p("");const s=((L=window.urbanaPublic)==null?void 0:L.nonce)||((u=window.urbanaAdmin)==null?void 0:u.nonce)||"";S&&console.log(`[SecureImage] Fetching: ${t}`,{productCode:r,nonce:s?"present":"missing",debugMode:S});try{const g=z.get(t);if(g){S&&console.log("[SecureImage] Using cached signed URL",t),C(g.method||"cached"),w(g.url);return}const m=await K(t,r);if(m){S&&console.log("[SecureImage] Prefetch result",m),C(m.method||"fetched"),w(m.url);return}}catch(g){S&&console.warn("[SecureImage] prefetchImage failed, falling back to inline fetch",g)}const f=await fetch("/wp-json/urbana/v1/image-proxy",{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":s},body:JSON.stringify({image_path:t})});if(!f.ok)throw new Error(`HTTP ${f.status}: ${f.statusText}`);const l=await f.json();if(S&&console.log(`[SecureImage] Response for ${t}:`,{method:l.method,success:l.success,hasImageUrl:!!l.image_url,hasImageData:!!l.image_data,error:l.error,message:l.message}),l.success)if(l.method==="presigned_url"&&l.image_url)S&&console.log("âœ… Using presigned URL method (instant loading from DO)"),C("presigned_url"),w(l.image_url),z.set(t,{url:l.image_url,method:"presigned_url"});else if(l.method==="base64_fallback"&&l.image_data)S&&console.log("âš ï¸ Using base64 fallback method (slower, full data transfer)"),C("base64_fallback"),w(l.image_data),z.set(t,{url:l.image_data,method:"base64_fallback"});else if(l.image_data)S&&console.log("âš ï¸ Using legacy base64 format"),C("base64_legacy"),w(l.image_data),z.set(t,{url:l.image_data,method:"base64_legacy"});else if(l.imageData)S&&console.log("âš ï¸ Using legacy imageData format"),C("imageData_legacy"),w(l.imageData),z.set(t,{url:l.imageData,method:"imageData_legacy"});else throw S&&console.error("No image URL or data received from server"),new Error("No image URL or data received");else if(l.use_svg_icon)S&&console.warn("Server requested SVG icon fallback:",l.error),C("svg_fallback"),p("Failed to load image - using SVG icon instead");else throw new Error(l.error||l.message||"Failed to get image")}catch(s){S&&console.error(`[SecureImage] Fetch error for ${t}:`,s.message,s),p(s.message)}finally{b(!1)}})()},[t,r]),x?e("div",{className:`${a} bg-gray-100 animate-pulse flex items-center justify-center`,children:i("svg",{width:"16",height:"16",viewBox:"0 0 24 24",className:"text-gray-400",children:[e("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"2",fill:"none"}),e("path",{d:"M12 6v6l4 2",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]})}):k||!o?i("div",{className:`${a} bg-orange-100 border-2 border-orange-300 flex items-center justify-center relative group`,title:k||"Image failed to load",children:[i("svg",{width:"16",height:"16",viewBox:"0 0 24 24",className:"text-orange-600",children:[e("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"2",fill:"none"}),e("line",{x1:"12",y1:"8",x2:"12",y2:"12",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"}),e("line",{x1:"12",y1:"16",x2:"12.01",y2:"16",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})]}),S&&k&&i("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 bg-gray-900 text-white text-xs rounded px-2 py-1 whitespace-nowrap opacity-0 group-hover:opacity-100 transition-opacity z-10 pointer-events-none",children:[k.substring(0,50),"..."]})]}):i("div",{className:"relative group h-full",children:[e("img",{src:o,alt:n,className:a,loading:d,decoding:"async",fetchpriority:c,onClick:I=>{var u,s;(window.urbanaDebugMode||((u=window.urbanaAdmin)==null?void 0:u.debugMode)||((s=window.urbanaPublic)==null?void 0:s.debugMode)||!1)&&console.log("[SecureImage] image clicked",t),h&&h(I)},title:S&&_?`Loaded via: ${_}`:"",onError:()=>{p("Image load failed")}}),S&&_&&e("div",{className:"absolute top-0 left-0 bg-blue-500 text-white text-xs px-1.5 py-0.5 rounded opacity-70 group-hover:opacity-100 transition-opacity font-semibold",title:`Method: ${_}`,children:_==="presigned_url"?"ðŸ”— URL":_==="base64_fallback"?"ðŸ“¦ B64":"âš ï¸"})]})},X=({data:t,contactInfo:r,onContactInfoChange:a,isSubmitting:n,isSubmitted:h,onSubmit:d,submitLabel:c,maxMessageLength:o=2e3})=>{M.useEffect(()=>{try{if(!R)try{window.__urbana_diag=window.__urbana_diag||{errors:[],events:[]},window.__urbana_diag.events.push({type:"missing_button_import",timestamp:new Date().toISOString()})}catch{}}catch{}},[]);const[w,x]=M.useState(!1),[b,k]=M.useState({}),p=(y,I)=>{const L=y==="message"&&typeof I=="string"?I.slice(0,o):I;a({...r,[y]:L}),b[y]&&k({...b,[y]:""})},_=()=>{const y={};return r.fullName.trim()||(y.fullName="Full name is required"),r.email.trim()?/^\S+@\S+\.\S+$/.test(r.email)||(y.email="Please enter a valid email address"):y.email="Email is required",w||(y.terms="You must accept the terms and conditions"),k(y),Object.keys(y).length===0},C=()=>{_()&&d()},S={hidden:{opacity:0},show:{opacity:1,transition:{staggerChildren:.1}}},P={hidden:{opacity:0,y:20},show:{opacity:1,y:0}};return h?i(E.div,{className:"text-center py-8",initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:.5},children:[e("div",{className:"w-16 h-16 bg-success/20 rounded-full flex items-center justify-center mx-auto mb-6",children:e(N,{icon:"lucide:check",className:"text-success",width:32})}),e("h3",{className:"text-xl font-semibold mb-2",children:"Thank You!"}),e("p",{className:"text-default-600 max-w-md mx-auto mb-6",children:"Your product configuration has been submitted successfully. Our team will review your selections and contact you shortly with pricing and next steps."})]}):i(E.div,{className:"space-y-6",variants:S,initial:"hidden",animate:"show",children:[e(E.p,{variants:P,className:"text-default-600",children:"Please provide your contact information to receive a detailed quote for your configured product."}),i(E.div,{variants:P,className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e(J,{label:"Full Name",placeholder:"Enter your full name",value:r.fullName,onValueChange:y=>p("fullName",y),isRequired:!0,isInvalid:!!b.fullName,errorMessage:b.fullName}),e(J,{label:"Email Address",placeholder:"Enter your email address",type:"email",value:r.email,onValueChange:y=>p("email",y),isRequired:!0,isInvalid:!!b.email,errorMessage:b.email})]}),i(E.div,{variants:P,className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e(J,{label:"Phone Number",placeholder:"Enter your phone number",type:"tel",value:r.phone,onValueChange:y=>p("phone",y)}),e(J,{label:"Company/Organization",placeholder:"Enter your company or organization",value:r.company,onValueChange:y=>p("company",y)})]}),i(E.div,{variants:P,children:[e(me,{label:"Additional Notes",placeholder:"Enter any specific requirements or questions",value:r.message,onValueChange:y=>p("message",y),minRows:3}),i("div",{className:"text-xs text-default-500 mt-1",children:[(r.message||"").length,"/",o," characters"]})]}),i(E.div,{variants:P,className:"space-y-4",children:[e(pe,{isSelected:w,onValueChange:x,isInvalid:!!b.terms,children:i("div",{className:"flex flex-col",children:[e("span",{children:"I agree to the Terms and Conditions and Privacy Policy"}),b.terms&&e("span",{className:"text-danger text-xs mt-1",children:b.terms})]})}),e("div",{className:"bg-default-50 p-4 rounded-medium text-sm text-default-600",children:i("p",{className:"flex items-start gap-2",children:[e(N,{icon:"lucide:shield",className:"text-default-500 mt-0.5 flex-shrink-0",width:16}),e("span",{children:"Your information is secure and will only be used to process your product inquiry. We will never share your details with third parties without your consent."})]})})]}),e(E.div,{variants:P,className:"pt-4",children:e(R,{color:"primary",size:"lg",className:"w-full md:w-auto",isDisabled:n,isLoading:n,onPress:C,endContent:!n&&e(N,{icon:"lucide:send",width:18}),children:c??"Submit Configuration"})})]})},se={productGroup:null,productRange:null,individualProduct:null,options:{},contactInfo:{fullName:"",email:"",phone:"",company:"",message:""}},U=Oe()(Ee(Me((t,r)=>({productData:null,currentStep:1,selections:se,isSubmitting:!1,isSubmitted:!1,initializeProductData:()=>{const a=window.urbanaPublic;a!=null&&a.productData?(console.log("Initializing stepper with database product data"),t({productData:a.productData})):console.warn("No database product data found in window.urbanaPublic")},setProductData:a=>{t({productData:a})},setCurrentStep:a=>t({currentStep:a}),updateSelection:(a,n)=>t(h=>{const d={...h.selections};return a==="productGroup"?(d.productGroup=n,d.productRange=null,d.individualProduct=null):a==="productRange"?(d.productRange=n,d.individualProduct=null):a==="options"?d.options={...d.options,...n}:a==="contactInfo"?d.contactInfo={...d.contactInfo,...n}:d[a]=n,{selections:d}}),nextStep:()=>t(a=>({currentStep:Math.min(a.currentStep+1,6)})),previousStep:()=>t(a=>({currentStep:Math.max(a.currentStep-1,1)})),goToStep:a=>{var c,o;const{selections:n,productData:h}=r(),d=((o=(c=h==null?void 0:h.stepperForm)==null?void 0:c.steps)==null?void 0:o.length)||6;return a<1||a>d?!1:a===1||a===2&&n.productGroup||a===3&&n.productRange||a>=4&&n.individualProduct?(t({currentStep:a}),!0):!1},setSubmitting:a=>t({isSubmitting:a}),setSubmitted:a=>t({isSubmitted:a}),resetStepper:()=>t({currentStep:1,selections:se,isSubmitting:!1,isSubmitted:!1}),canProceedToStep:a=>{var c,o;const{selections:n,productData:h}=r(),d=((o=(c=h==null?void 0:h.stepperForm)==null?void 0:c.steps)==null?void 0:o.length)||6;if(a>d)return!1;switch(a){case 1:return!0;case 2:return!!n.productGroup;case 3:return!!n.productRange;case 4:case 5:case 6:return!!n.individualProduct;default:return!1}}}),{name:"urbana-stepper-storage",partialize:t=>({selections:t.selections,currentStep:t.currentStep})}),{name:"urbana-stepper"})),F=({open:t,onClose:r})=>{var I,L,u,s;const a=U(f=>f.productData),n=U(f=>f.selections),h=U(f=>f.setSubmitting),d=U(f=>f.setSubmitted);U(f=>f.updateSelection);const[c,o]=M.useState(()=>({...n.contactInfo})),[w,x]=M.useState(!1),[b,k]=M.useState(!1),[p,_]=M.useState(null);M.useEffect(()=>{t&&(o({...n.contactInfo,message:""}),k(!1))},[t,n.contactInfo]);const C=((u=(L=(I=a==null?void 0:a.stepperForm)==null?void 0:I.steps)==null?void 0:L[5])==null?void 0:u.fields)||[],S=f=>{o(f)};M.useEffect(()=>{try{if(!X)try{window.__urbana_diag=window.__urbana_diag||{errors:[],events:[]},window.__urbana_diag.events.push({type:"missing_step6_component",timestamp:new Date().toISOString()})}catch{}}catch{}},[]);const P=async()=>{var f;try{x(!0),h(!0);const l={productGroup:n.productGroup,productRange:n.productRange,individualProduct:n.individualProduct,options:n.options,contactInfo:c},g=await fetch("/wp-json/urbana/v1/submit-form",{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":((f=window.urbanaPublic)==null?void 0:f.nonce)||""},body:JSON.stringify({selections:l,submittedAt:new Date().toISOString()})});let m=null;try{m=await g.json()}catch{try{m=await g.text()}catch{m=null}}try{window.__urbana_diag=window.__urbana_diag||{errors:[],events:[]},window.__urbana_diag.events.push({type:"submit_response",timestamp:new Date().toISOString(),status:g.status,body:m})}catch{}k(!0),d(!0)}catch(l){console.error("Failed to submit enquiry",l),alert("Failed to submit enquiry. Please try again.")}finally{x(!1),h(!1)}};if(!t)return null;const y=M.useRef(null);if(M.useEffect(()=>{if(b&&y.current)try{y.current.focus()}catch{}},[b,p]),M.useEffect(()=>{try{window.__urbana_diag=window.__urbana_diag||{errors:[],events:[]},window.__urbana_diag.events.push({type:"contact_modal_mount",timestamp:new Date().toISOString(),open:t})}catch{}return()=>{try{window.__urbana_diag.events.push({type:"contact_modal_unmount",timestamp:new Date().toISOString()})}catch{}}},[]),b){try{window.__urbana_diag=window.__urbana_diag||{errors:[],events:[]},window.__urbana_diag.events.push({type:"submit_ui_shown",timestamp:new Date().toISOString(),status:(p==null?void 0:p.status)??null})}catch{}return i("div",{className:"fixed inset-0 z-60 flex items-center justify-center p-4",role:"dialog","aria-modal":"true",children:[e("div",{className:"fixed inset-0 bg-black/60",onClick:r,"aria-hidden":"true"}),i("div",{className:"relative w-full max-w-2xl bg-white rounded-medium shadow-lg z-10 p-6 max-h-[85vh] overflow-auto",children:[i("div",{className:"text-center py-8",children:[e("div",{className:"w-16 h-16 bg-success/20 rounded-full flex items-center justify-center mx-auto mb-6",children:e(N,{icon:"lucide:check",className:"text-success",width:32})}),e("h3",{className:"text-xl font-semibold mb-2",children:"Thank You!"}),i("p",{className:"text-default-600 max-w-md mx-auto mb-6",children:["Your enquiry has been submitted successfully.",(s=p==null?void 0:p.body)!=null&&s.id?i("span",{children:[" Reference: ",String(p.body.id)]}):null]}),p&&i("div",{className:"mt-4 p-3 bg-default-50 rounded text-xs text-default-600",children:[e("strong",{children:"Server response:"}),i("div",{children:["Status: ",String(p.status)]}),e("pre",{className:"mt-2 text-xs whitespace-pre-wrap",children:typeof p.body=="string"?p.body:JSON.stringify(p.body,null,2)})]})]}),e("div",{className:"mt-6 flex justify-end",children:e(R,{ref:y,color:"primary",onPress:r,"aria-label":"Close enquiry dialog",children:"Close"})})]})]})}return i("div",{className:"fixed inset-0 z-60 flex items-center justify-center p-4",role:"dialog","aria-modal":"true",children:[e("div",{className:"fixed inset-0 bg-black/60",onClick:b?r:void 0,"aria-hidden":"true"}),i("div",{className:"relative w-full max-w-2xl bg-white rounded-medium shadow-lg z-10 p-6 max-h-[85vh] overflow-auto",children:[i("div",{className:"flex items-start justify-between gap-4 mb-4",children:[i("div",{children:[e("h3",{className:"text-lg font-semibold",children:"Enquire about this product"}),e("p",{className:"text-sm text-default-500",children:"Leave your contact details and we will get back to you with pricing and next steps."})]}),i("div",{className:"flex items-center gap-2",children:[e(R,{variant:"flat",color:"default",onPress:()=>o({fullName:"",email:"",phone:"",company:"",message:""}),"aria-label":"Clear enquiry form",children:"Clear"}),e(R,{variant:"flat",color:"default",onPress:r,"aria-label":"Close enquiry dialog",children:e(N,{icon:"lucide:x",width:18})})]})]}),e("div",{children:(()=>{if(typeof X!="function")return i("div",{className:"p-4 bg-warning/5 border border-warning/10 rounded-medium",children:[e("h4",{className:"font-semibold mb-2",children:"Error loading enquiry form"}),e("p",{className:"text-sm text-default-600",children:"The contact form component could not be rendered. This is likely a build/import issue. See the console for diagnostic details."}),e("pre",{className:"text-xs mt-2",children:JSON.stringify({Step6ContactInfo:typeof X,Input:typeof J,Textarea:typeof me,Checkbox:typeof pe,Button:typeof R},null,2)})]});try{return e(X,{data:{fields:C},contactInfo:c,onContactInfoChange:f=>S(f),isSubmitting:w,isSubmitted:b,onSubmit:P,submitLabel:"Enquire Now",maxMessageLength:2e3})}catch(f){try{window.__urbana_diag=window.__urbana_diag||{errors:[],events:[]},window.__urbana_diag.errors.push({type:"render_error_step6",message:String(f&&f.message),stack:f&&f.stack})}catch{}return i("div",{className:"p-4 bg-warning/5 border border-warning/10 rounded-medium",children:[e("h4",{className:"font-semibold mb-2",children:"Error rendering enquiry form"}),e("p",{className:"text-sm text-default-600",children:"An unexpected error occurred while rendering the form. See diagnostics for details."}),e("pre",{className:"text-xs mt-2",children:String(f&&f.message)})]})}})()}),p&&i("div",{className:"mt-4 p-3 bg-default-50 rounded text-xs text-default-600",children:[e("strong",{children:"Last submission:"}),i("div",{children:["Status: ",String(p.status)]}),e("pre",{className:"mt-2 text-xs whitespace-pre-wrap",children:typeof p.body=="string"?p.body:JSON.stringify(p.body,null,2)})]}),b&&e("div",{className:"mt-6 flex justify-end",children:e(R,{ref:y,color:"primary",onPress:r,"aria-label":"Close enquiry dialog",children:"Close"})})]})]})},Z=({images:t,productCode:r="",open:a,initialIndex:n=0,onClose:h,onIndexChange:d})=>{var b,k;const[c,o]=M.useState(n);try{(window.urbanaDebugMode||((b=window.urbanaAdmin)==null?void 0:b.debugMode)||((k=window.urbanaPublic)==null?void 0:k.debugMode)||!1)&&console.warn("[Lightbox] props",{open:a,initialIndex:n,imagesLength:t==null?void 0:t.length,productCode:r})}catch{}if(q(()=>{o(n)},[n]),q(()=>{if(a)try{t[c+1]&&K(t[c+1],r).catch(()=>{}),t[c-1]&&K(t[c-1],r).catch(()=>{})}catch{}},[a,c,t,r]),q(()=>{var C,S;if((window.urbanaDebugMode||((C=window.urbanaAdmin)==null?void 0:C.debugMode)||((S=window.urbanaPublic)==null?void 0:S.debugMode)||!1)&&console.warn("[Lightbox] effect open changed",{open:a,index:c,imagesLength:t.length}),!a)return;const _=P=>{console.warn("[Lightbox] keydown",P.key),P.key==="Escape"&&h(),P.key==="ArrowLeft"&&o(y=>Math.max(0,y-1)),P.key==="ArrowRight"&&o(y=>Math.min(t.length-1,y+1))};return window.addEventListener("keydown",_),()=>window.removeEventListener("keydown",_)},[a,t.length,h]),q(()=>{window.urbanaDebugMode&&console.log(`[Lightbox] open: ${a}, index: ${c}, images: ${t.length}`)},[a,c,t.length]),q(()=>{d&&d(c)},[c]),!a)return null;const w=()=>{window.urbanaDebugMode&&console.log("[Lightbox] prev clicked"),o(p=>Math.max(0,p-1))},x=()=>{window.urbanaDebugMode&&console.log("[Lightbox] next clicked"),o(p=>Math.min(t.length-1,p+1))};return e("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/70 p-4",children:i("div",{className:"relative w-full max-w-6xl mx-auto",children:[e("button",{"aria-label":"Close",onClick:()=>{window.urbanaDebugMode&&console.log("[Lightbox] close clicked"),h()},className:"absolute right-2 top-2 z-50 rounded-full bg-white/10 hover:bg-white/20 p-2 text-white",children:e(N,{icon:"lucide:x",width:18})}),i("div",{className:"flex items-center justify-center",children:[e("button",{"aria-label":"Previous",onClick:w,className:"flex items-center justify-center w-10 h-10 md:w-12 md:h-12 rounded-full bg-white/10 hover:bg-white/20 text-white mr-4",children:e(N,{icon:"lucide:chevron-left",width:20})}),e("div",{className:"flex-1 flex items-center justify-center",children:e("div",{className:"max-h-[85vh] w-full flex items-center justify-center",children:e(H,{imagePath:t[c],productCode:r,className:"max-w-full max-h-[85vh] object-contain",alt:`Image ${c+1} of ${t.length}`,loading:"eager",fetchPriority:"high"})})}),e("button",{"aria-label":"Next",onClick:x,className:"flex items-center justify-center w-10 h-10 md:w-12 md:h-12 rounded-full bg-white/10 hover:bg-white/20 text-white ml-4",children:e(N,{icon:"lucide:chevron-right",width:20})})]}),t.length>1&&e("div",{className:"mt-4 flex gap-2 overflow-x-auto px-2",children:t.map((p,_)=>e("button",{onClick:()=>o(_),onMouseEnter:()=>K(p).catch(()=>{}),className:`flex-shrink-0 w-20 h-20 rounded-small overflow-hidden border-2 ${_===c?"border-primary":"border-transparent"}`,"aria-label":`View image ${_+1}`,children:e(H,{imagePath:p,productCode:r,className:"w-full h-full object-cover",alt:`Thumb ${_+1}`,loading:"lazy"})},_))})]})})},Ge=({data:t,productId:r})=>{const a=t.productDetails[r],n=window.urbanaDebugMode||!1;q(()=>{try{const u=[];H||u.push("SecureImage"),Z||u.push("Lightbox"),F||u.push("ContactModal"),N||u.push("Icon"),u.length>0&&console.error("[Step4] Missing imports detected:",u)}catch{}},[]);const h=ee(async(u,s)=>{try{const f=u.includes("digitaloceanspaces.com");let l=u;if(f)try{let v=(new URL(u).pathname||"").replace(/^\//,"");if(v){const O=new URL("/wp-json/urbana/v1/proxy-download",window.location.origin);O.searchParams.set("path",v),l=O.toString()}else{const O=new URL("/wp-json/urbana/v1/proxy-download",window.location.origin);O.searchParams.set("url",u),l=O.toString()}}catch{const v=new URL("/wp-json/urbana/v1/proxy-download",window.location.origin);v.searchParams.set("url",u),l=v.toString()}else if(!/^https?:\/\//i.test(u)){const m=new URL("/wp-json/urbana/v1/proxy-download",window.location.origin);m.searchParams.set("path",u),l=m.toString()}const g=document.createElement("a");g.href=l,g.download=s,g.style.display="none",g.target="_blank",document.body.appendChild(g),g.click(),document.body.removeChild(g)}catch(f){n&&console.error("Download failed:",f),alert("Failed to download file. Please try again or contact support.")}},[]);if(!a)return i("div",{className:"text-center p-8",children:[e(N,{icon:"lucide:file-question",className:"mx-auto mb-4 text-default-400",width:48}),e("h3",{className:"text-xl font-medium mb-2",children:"Product Information Unavailable"}),i("p",{className:"text-default-500",children:["Detailed information for ",r," is not available at this time. Please continue to the next step or contact our support team for assistance."]})]});const d={hidden:{opacity:0},show:{opacity:1,transition:{duration:.5}}},c=a.imageGallery.length>0?a.imageGallery[0]:"",o=Q(null),[w,x]=j(!1),[b,k]=j(0),p=u=>{n&&console.warn(`[Step4] openLightboxAt called with index: ${u}`),k(u),x(!0)};q(()=>{n&&console.warn("[Step4] lightboxOpen state changed",{lightboxOpen:w,lightboxIndex:b})},[w,b]);const _=()=>x(!1),[C,S]=j(!1),[P,y]=j(null),I=()=>{try{if(typeof F!="function"){y("ContactModal is not a function - check import/export");try{window.__urbana_diag=window.__urbana_diag||{errors:[],events:[]},window.__urbana_diag.events.push({type:"contact_modal_invalid",value:String(F)})}catch{}return}}catch(u){try{window.__urbana_diag=window.__urbana_diag||{errors:[],events:[]},window.__urbana_diag.errors.push({type:"step4_open_enquire_error",message:String(u&&u.message)})}catch{}}y(null),S(!0)},L=()=>S(!1);return q(()=>{n&&console.log("[Step4] useEffect mount â€” Step4ProductContent mounted",{galleryRefPresent:!!o.current});const u=s=>{var f,l;try{const g=o.current;if(!g)return;n&&console.log("[Step4 gallery container click] event",s.type,"target:",(f=s.target)==null?void 0:f.tagName,"defaultPrevented",s.defaultPrevented);let m=s.target;for(;m&&m!==g;){if(m.nodeType!==Node.ELEMENT_NODE){m=m.parentNode;continue}const A=m,B=(l=A.getAttribute)==null?void 0:l.call(A,"data-gallery-index");if(B!=null){n&&console.log(`[Step4 gallery container click] index found: ${B}`),p(parseInt(B,10));return}const V=window.getComputedStyle(A);n&&console.log("[Step4 gallery container click] ancestor:",A.tagName,"pointer-events:",V.pointerEvents),m=m.parentNode}const v=s.clientX,O=s.clientY,D=g.querySelectorAll("[data-gallery-index]");for(let A=0;A<D.length;A++){const B=D[A],V=B.getBoundingClientRect();if(v>=V.left&&v<=V.right&&O>=V.top&&O<=V.bottom){const te=B.getAttribute("data-gallery-index");n&&console.log(`[Step4 gallery container click] bounding-match index: ${te}`),p(parseInt(te||"0",10));return}}}catch(g){console.error("Gallery handler error",g)}};return document.addEventListener("click",u,!0),()=>document.removeEventListener("click",u,!0)},[o,p,n]),i(E.div,{className:"space-y-8",initial:"hidden",animate:"show",variants:d,children:[i("div",{className:"flex flex-col md:flex-row gap-6",children:[e("div",{className:"w-full md:w-1/2",children:c?e("div",{"data-gallery-index":0,className:"cursor-pointer",onClick:()=>{n&&console.log("[Step4] featured image clicked index: 0"),p(0)},onMouseEnter:()=>{K(c).catch(()=>{})},children:e(H,{imagePath:c,productCode:r,alt:a.name,className:"w-full h-64 object-cover rounded-medium",onClick:()=>p(0),loading:"eager",fetchPriority:"high"})}):e("div",{className:"w-full h-64 bg-gray-100 rounded-medium flex items-center justify-center",children:e(N,{icon:"lucide:image",width:48,className:"text-gray-400"})})}),i("div",{className:"w-full md:w-1/2",children:[e("h3",{className:"text-xl font-semibold mb-2",children:a.name}),e("p",{className:"text-default-600 mb-4",children:a.overview}),i("div",{className:"space-y-4",children:[i("div",{className:"flex items-center gap-2",children:[e(N,{icon:"lucide:check-circle",className:"text-success",width:20}),e("span",{children:"In Stock"})]}),i("div",{className:"flex items-center gap-2",children:[e(N,{icon:"lucide:truck",className:"text-default-500",width:20}),e("span",{children:"Standard Delivery: 2-4 weeks"})]}),i("div",{className:"flex items-center gap-2",children:[e(N,{icon:"lucide:shield",className:"text-default-500",width:20}),e("span",{children:"10 Year Warranty"})]})]}),e("div",{className:"mt-4",children:e(R,{color:"primary",size:"md",onPress:I,endContent:e(N,{icon:"lucide:arrow-right",width:18}),"aria-label":"Enquire Now",children:"Enquire Now"})})]})]}),(()=>{if(!C)return null;try{if(F==null||typeof F!="function"&&typeof F!="object"){console.error("[Step4] ContactModal invalid at render",F);try{window.__urbana_diag=window.__urbana_diag||{errors:[]},window.__urbana_diag.errors.push({type:"contact_modal_invalid",value:String(F)})}catch{}return i("div",{className:"p-4 bg-warning/5 border border-warning/10 rounded-medium",children:[e("h4",{className:"font-semibold mb-2",children:"Enquiry form failed to open"}),e("p",{className:"text-sm text-default-600",children:"The enquiry form component is not available. This is likely a build/import issue. See the console for diagnostic details."}),e("pre",{className:"text-xs mt-2",children:JSON.stringify({ContactModal:String(F),typeofContactModal:typeof F},null,2)})]})}return e(F,{open:C,onClose:L})}catch(u){console.error("[Step4] Error mounting ContactModal",u,u&&u.stack);try{window.__urbana_diag=window.__urbana_diag||{errors:[]},window.__urbana_diag.errors.push({type:"contact_modal_mount_error",message:String(u&&u.message),stack:u&&u.stack})}catch{}return i("div",{className:"p-4 bg-warning/5 border border-warning/10 rounded-medium",children:[e("h4",{className:"font-semibold mb-2",children:"Enquiry form failed to open"}),e("p",{className:"text-sm text-default-600",children:"An error occurred while opening the enquiry form. See console for details."}),e("pre",{className:"text-xs mt-2",children:String(u&&u.message)})]})}})(),i(ue,{"aria-label":"Product information tabs",variant:"underlined",color:"primary",children:[e(W,{title:"Details",children:e(T,{children:e($,{className:"p-6",children:i("div",{className:"prose max-w-none",children:[e("p",{className:"text-default-700",children:a.description}),e("h4",{className:"text-lg font-medium mt-6 mb-3",children:"Specifications"}),e("ul",{className:"space-y-2",children:a.specifications.map((u,s)=>i("li",{className:"flex items-start gap-2",children:[e(N,{icon:"lucide:chevron-right",className:"text-primary mt-1 flex-shrink-0",width:16}),e("span",{children:u})]},s))})]})})})},"details"),e(W,{title:"Image Gallery",children:e(T,{children:e($,{className:"p-6",children:e("div",{ref:o,className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4",children:a.imageGallery.map((u,s)=>e("div",{"data-gallery-index":s,className:"aspect-square cursor-pointer pointer-events-auto",onClick:f=>{n&&console.log(`[Step4 wrapper click] index: ${s}`),f.stopPropagation(),p(s)},onMouseEnter:()=>{K(u).catch(()=>{})},children:e(H,{imagePath:u,productCode:r,alt:`${a.name} - Image ${s+1}`,className:"w-full h-full object-cover rounded-medium",onClick:()=>p(s),loading:"lazy"})},s))})})})},"gallery"),e(W,{title:"Downloads",children:e(T,{children:e($,{className:"p-6",children:i("div",{className:"space-y-4",children:[e("p",{className:"text-default-600 mb-4",children:"Download product documentation and technical files:"}),e("div",{className:"space-y-3",children:Object.entries(a.files).map(([u,s])=>i("div",{className:"flex items-center justify-between p-3 border border-default-200 rounded-medium hover:border-primary transition-colors",children:[i("div",{className:"flex items-center gap-3",children:[e("div",{className:"p-2 bg-default-100 rounded-medium",children:e(N,{icon:ze(s),className:"text-default-600",width:20})}),i("div",{children:[e("p",{className:"font-medium",children:u}),e("p",{className:"text-xs text-default-500",children:Be(s)})]})]}),e(R,{size:"sm",variant:"flat",color:"primary",onPress:()=>h(s,We(s,u)),endContent:e(N,{icon:"lucide:download",width:16}),children:"Download"})]},s))})]})})})},"files"),e(W,{title:"FAQ",children:e(T,{children:e($,{className:"p-6",children:e(ke,{children:a.faqs&&a.faqs.length>0?a.faqs.map((u,s)=>e(ae,{title:u.question,children:u.answer},s)):[{q:"What is the installation process?",a:"Installation typically requires a concrete foundation and can be completed by our certified installers. The process usually takes 1-3 days depending on the product complexity and site conditions."},{q:"What maintenance is required?",a:"Our products are designed for minimal maintenance. We recommend a visual inspection every 6 months and cleaning as needed. Specific maintenance schedules are provided in the product documentation."},{q:"Are customizations available?",a:"Yes, most products can be customized with different colors, materials, and additional features. Custom options can be selected in the next step of this configuration process."},{q:"What warranty is provided?",a:"Standard warranty is 10 years on structural components and 5 years on other elements. Extended warranties are available for purchase. All warranties cover manufacturing defects and normal wear."}].map((u,s)=>e(ae,{title:u.q,children:u.a},`fallback-${s}`))})})})},"faq")]}),e(Z,{images:a.imageGallery,productCode:r,open:w,initialIndex:b,onClose:_})]})};function ze(t){var n;const r=(n=t.split(".").pop())==null?void 0:n.toLowerCase(),a={pdf:"lucide:file-text",dwg:"lucide:file-cog",rvt:"lucide:file-3d",doc:"lucide:file-text",docx:"lucide:file-text",xls:"lucide:file-spreadsheet",xlsx:"lucide:file-spreadsheet",zip:"lucide:file-archive",default:"lucide:file"};return a[r||""]||a.default}function Be(t){var n;const r=(n=t.split(".").pop())==null?void 0:n.toLowerCase(),a={pdf:"2.4 MB",dwg:"5.8 MB",rvt:"12.6 MB",doc:"1.2 MB",docx:"1.5 MB",xls:"3.1 MB",xlsx:"3.4 MB",zip:"8.7 MB",default:"1.0 MB"};return a[r||""]||a.default}function We(t,r){try{let n="";try{n=(new URL(t).pathname||"").split("/").pop()||""}catch{const d=t.split("/");n=d[d.length-1]||""}if(n=n.split("?")[0].split("#")[0],n&&n.includes("."))return decodeURIComponent(n)}catch(n){debugMode&&console.error("Error extracting filename from URL:",n)}const a=(t.split(".").pop()||"").toLowerCase().split("?")[0].split("#")[0];return a&&!r.includes(".")?`${r}.${a}`:r}const He=({data:t,options:r,onOptionsChange:a,selectedProductCode:n})=>{const h=window.urbanaDebugMode||!1,d=Q(n),c=Q(null),o=G(()=>{var l;return n?(l=t.productOptions)!=null&&l[n]?t.productOptions[n]:{}:t.options},[n,t.productOptions,t.options]);h&&console.log(t);const w=G(()=>Object.keys(o).length>0,[o]),x=G(()=>{const l={};return Object.keys(o).forEach(m=>{r[m]&&(l[m]=r[m])}),l},[r,o]);q(()=>{if(d.current!==n){d.current=n;const l=Object.keys(o),g=Object.keys(r);if(g.some(v=>!l.includes(v))||g.length===0){const v={};g.forEach(D=>{l.includes(D)&&(v[D]=r[D])}),JSON.stringify(v)!==JSON.stringify(r)&&a(v)}}},[n,o]);const b=ee((l,g)=>{c.current=l,a({...x,[l]:g})},[x,a]),k=G(()=>{var g;const l=Object.keys(o);if(l.length===0)return null;if(c.current&&r[c.current]){const m=(g=o[c.current])==null?void 0:g.find(v=>v.value===r[c.current]);if(m!=null&&m.imageUrl)return m.imageUrl}for(let m=l.length-1;m>=0;m--){const v=l[m],O=r[v];if(O&&o[v]){const D=o[v].find(A=>A.value===O);if(D!=null&&D.imageUrl)return D.imageUrl}}return null},[r,o]),p=G(()=>{var l;if(n&&((l=t.productDetails)!=null&&l[n])){const g=t.productDetails[n].imageGallery;if(g&&g.length>0)return g[0]}return"https://img.heroui.chat/image/landscape?w=800&h=600&u=preview_default"},[n,t.productDetails]),_=k||p,C={hidden:{opacity:0},show:{opacity:1,transition:{duration:.5}}};if(!w)return e(E.div,{className:"space-y-6",initial:"hidden",animate:"show",variants:C,children:e(T,{children:i($,{className:"p-8 text-center",children:[e(N,{icon:"lucide:settings",width:48,className:"text-default-300 mx-auto mb-4"}),e("h3",{className:"text-lg font-medium mb-2",children:"No Configuration Options"}),e("p",{className:"text-default-600",children:n?i(ye,{children:["This product doesn't have any configurable options.",i("span",{className:"block mt-2 text-sm",children:["Product: ",e("strong",{children:n})]})]}):"Please select a product first to see available configuration options."}),e("p",{className:"text-sm text-default-500 mt-4",children:n?"Proceed to the next step to complete your inquiry.":"Go back to the previous step and select a product."})]})})});const[S,P]=j(!1),[y,I]=j(0),[L,u]=j([]),s=(l,g=0)=>{u(l||[]),I(g),P(!0)},f=()=>P(!1);return i(E.div,{className:"space-y-6",initial:"hidden",animate:"show",variants:C,children:[n&&i("div",{className:"flex items-center gap-2 text-sm text-default-600",children:[e(N,{icon:"lucide:package",width:16}),i("span",{children:["Configuring options for: ",e("strong",{children:n})]})]}),e("p",{className:"text-default-600 mb-4",children:"Customize your product by selecting from the available options below:"}),i(ue,{"aria-label":"Product configuration tabs",variant:"underlined",color:"primary",children:[e(W,{title:"Configuration Options",children:e(T,{children:e($,{className:"p-6",children:i("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e("div",{className:"space-y-4",children:Object.entries(o).map(([l,g])=>i("div",{className:"space-y-2",children:[e("label",{className:"text-sm font-medium text-default-700",children:l}),e(xe,{label:l,placeholder:`Select ${l}`,selectedKeys:r[l]?[r[l]]:[],onChange:m=>{const v=m.target.value;c.current=l,b(l,v)},className:"max-w-full",children:g.map(m=>e(ve,{children:typeof m=="string"?m:m.value},typeof m=="string"?m:m.value))})]},l))}),e("div",{children:i("div",{className:"border border-default-200 rounded-medium p-4",children:[e("h4",{className:"text-sm font-medium mb-2",children:"Preview"}),e("div",{className:"aspect-video mb-4 cursor-pointer",onClick:()=>s([_],0),children:e(H,{imagePath:_,productCode:n||"",className:"w-full h-full object-cover rounded-medium",onClick:()=>s([_],0)},_)}),i("div",{className:"space-y-2",children:[e("h5",{className:"text-xs font-medium text-default-500",children:"Selected Options:"}),Object.keys(x).length>0?e("ul",{className:"text-sm space-y-1",children:Object.entries(x).map(([l,g])=>i("li",{className:"flex items-center gap-2",children:[e(N,{icon:"lucide:check",className:"text-success",width:14}),i("span",{className:"font-medium",children:[l,":"]})," ",g]},l))}):e("p",{className:"text-sm text-default-500",children:"No options selected yet. Choose from the available options."})]})]})})]})})})},"options"),e(W,{title:"Option Impact",children:e(T,{children:e($,{className:"p-6",children:i("div",{className:"space-y-6",children:[i("div",{className:"space-y-2",children:[e("h4",{className:"text-lg font-medium",children:"How Options Affect Your Product"}),e("p",{className:"text-default-600",children:"Different options can impact the appearance, durability, and functionality of your product. Below is a summary of how each option affects your selection."})]}),e("div",{className:"space-y-4",children:Object.entries(o).map(([l,g])=>i("div",{className:"border-b border-default-200 pb-4 last:border-0",children:[e("h5",{className:"font-medium mb-2",children:l}),e("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:g.map((m,v)=>{const O=typeof m=="string"?m:m.value,D=typeof m=="object"&&m.imageUrl?m.imageUrl:null;return i("div",{className:"p-3 border border-default-200 rounded-medium",children:[D&&e("div",{className:"aspect-video mb-2 rounded-small overflow-hidden cursor-pointer",onClick:()=>s([D],0),children:e(H,{imagePath:D,productCode:n||"",className:"w-full h-full object-cover",onClick:()=>s([D],0)})}),e("div",{className:"font-medium",children:O}),i("div",{className:"text-sm text-default-500",children:[v===0&&"Standard option with included features",v===1&&"Enhanced durability and premium finish",v===2&&"Maximum performance and longevity"]})]},O)})})]},l))})]})})})},"impact"),e(W,{title:"Pricing Impact",children:e(T,{children:e($,{className:"p-6",children:i("div",{className:"space-y-6",children:[i("div",{className:"space-y-2",children:[e("h4",{className:"text-lg font-medium",children:"Option Pricing"}),e("p",{className:"text-default-600",children:"Different configuration options affect the final price of your product. Below is a breakdown of how each selection impacts pricing."})]}),i("table",{className:"w-full text-sm",children:[e("thead",{children:i("tr",{className:"border-b border-default-200",children:[e("th",{className:"py-2 px-4 text-left font-medium",children:"Option"}),e("th",{className:"py-2 px-4 text-left font-medium",children:"Selection"}),e("th",{className:"py-2 px-4 text-right font-medium",children:"Price Impact"})]})}),e("tbody",{children:Object.entries(o).map(([l,g])=>e(M.Fragment,{children:g.map((m,v)=>{const O=typeof m=="string"?m:m.value;return i("tr",{className:"border-b border-default-100",children:[v===0?e("td",{className:"py-2 px-4 align-top",rowSpan:g.length,children:l}):null,i("td",{className:"py-2 px-4",children:[O,v===0&&e("span",{className:"text-xs text-default-400 ml-2",children:"(Standard)"})]}),e("td",{className:"py-2 px-4 text-right",children:v===0?"Included":`+$${(v*250+Math.random()*100).toFixed(0)}`})]},`${l}-${O}`)})},l))})]}),e("div",{className:"bg-default-50 p-4 rounded-medium",children:i("p",{className:"text-sm text-default-600",children:[e(N,{icon:"lucide:info",className:"inline-block mr-2",width:16}),"For exact pricing including all options and installation, please complete the form in the next step and our team will provide a detailed quote."]})})]})})})},"pricing")]}),e(Z,{images:L,productCode:n||"",open:S,initialIndex:y,onClose:f})]})},Ve=({data:t})=>{const{currentStep:r,selections:a,isSubmitting:n,isSubmitted:h,updateSelection:d,nextStep:c,previousStep:o,goToStep:w,canProceedToStep:x}=U(),b=window.urbanaDebugMode||!1,k=t.stepperForm.steps.length,p=G(()=>{var m;if(!a.individualProduct)return{};const s=t.stepperForm.steps[4],f=(m=s==null?void 0:s.productOptions)==null?void 0:m[a.individualProduct];if(!f)return{};const l={},g=Object.keys(f);return Object.entries(a.options).forEach(([v,O])=>{g.includes(v)&&(l[v]=O)}),l},[a.individualProduct,a.options,t.stepperForm.steps]);q(()=>{b&&(console.log("[ProductStepper] currentStep:",r),console.log("[ProductStepper] selections:",a),console.log("[ProductStepper] stepData:",t.stepperForm.steps[r-1]),console.log("[ProductStepper] validProductOptions:",p))},[r,a,t.stepperForm.steps,p,b]);const _=ee(async()=>{var s;U.getState().setSubmitting(!0);try{const f={productGroup:a.productGroup,productRange:a.productRange,individualProduct:a.individualProduct,options:p,contactInfo:a.contactInfo};if(b&&console.log("Submitting form data:",f),!(await fetch("/wp-json/urbana/v1/submit-form",{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":((s=window.urbanaPublic)==null?void 0:s.nonce)||""},body:JSON.stringify({selections:f,submittedAt:new Date().toISOString()})})).ok)throw new Error("Failed to submit form");U.getState().setSubmitted(!0)}catch(f){console.error("Error submitting form:",f),alert("Failed to submit form. Please try again.")}finally{U.getState().setSubmitting(!1)}},[a,p]),C=s=>{w(s)},S=()=>{c()},P=()=>{o()},y=M.useCallback(()=>{const s=t.stepperForm.steps[r-1];switch(r){case 1:return e(Re,{data:{categories:(s==null?void 0:s.categories)||[],productGroups:(s==null?void 0:s.productGroups)||[]},selection:a.productGroup||null,onSelect:l=>d("productGroup",l)});case 2:return e(Te,{data:{ranges:(s==null?void 0:s.ranges)||{},productRanges:(s==null?void 0:s.productRanges)||[],relationships:s==null?void 0:s.relationships},productGroup:a.productGroup||"",selection:a.productRange||null,onSelect:l=>d("productRange",l)});case 3:return e(Fe,{data:{products:(s==null?void 0:s.products)||{},productsData:(s==null?void 0:s.productsData)||[],relationships:s==null?void 0:s.relationships},productRange:a.productRange||"",selection:a.individualProduct||null,onSelect:l=>d("individualProduct",l)});case 4:const f=a.individualProduct||"unknown-product";return console.log("Step 4 Data:",s==null?void 0:s.productDetails),console.log("Product ID:",f),e(Ge,{data:{productDetails:(s==null?void 0:s.productDetails)||{}},productId:f});case 5:return e(He,{data:{options:(s==null?void 0:s.options)||{},productOptions:(s==null?void 0:s.productOptions)||{},dynamicUpdates:(s==null?void 0:s.dynamicUpdates)||{updateImages:!1,updateFiles:!1}},options:a.options||{},onOptionsChange:l=>d("options",l),selectedProductCode:a.individualProduct||void 0});case 6:return e(X,{data:{fields:(s==null?void 0:s.fields)||[]},contactInfo:a.contactInfo,onContactInfoChange:l=>d("contactInfo",l),isSubmitting:n,isSubmitted:h,onSubmit:_});default:return e("div",{children:"Unknown step"})}},[r,t.stepperForm.steps,a,d,n,h,_]),I=x(r+1),L=r===k,u={hidden:{opacity:0,x:10},visible:{opacity:1,x:0},exit:{opacity:0,x:-10}};return i("div",{className:"space-y-6",children:[e(je,{currentStep:r,totalSteps:k,steps:t.stepperForm.steps,selections:a,onStepClick:C}),e(T,{className:"shadow-sm",children:e($,{className:"p-6",children:i(E.div,{initial:"hidden",animate:"visible",exit:"exit",variants:u,transition:{duration:.25},children:[e("h2",{className:"text-xl font-semibold mb-6",children:t.stepperForm.steps[r-1].title}),y()]},r)})}),e(Le,{currentStep:r,totalSteps:k,onNext:S,onPrevious:P,canProceed:I,isLastStep:L,isSubmitting:n,isSubmitted:h,onSubmit:_})]})};function Ye(){const{productData:t,initializeProductData:r}=U(),[a,n]=j(!0),[h,d]=j(null),c=window.urbanaDebugMode||!1;return q(()=>{try{const o=window.urbanaPublic;o!=null&&o.productData?(c&&console.log("Loading product data from database:",o.productData),r(),d(null)):(c&&console.warn("No product data found in window.urbanaPublic, using default data"),U.getState().setProductData(re),d("Using default product data - database may be empty"))}catch(o){c&&console.error("Error initializing product data:",o),d("Failed to load product data"),U.getState().setProductData(re)}finally{n(!1)}},[r]),a?e("div",{className:"min-h-screen bg-background",children:e("div",{className:"flex items-center justify-center h-64",children:i("div",{className:"flex flex-col items-center gap-4",children:[e(Ne,{size:"lg"}),e("p",{className:"text-foreground-600",children:"Loading product configuration..."})]})})}):t?e("div",{className:"min-h-screen bg-background",children:e("div",{className:"py-12 px-4 sm:px-6",children:i("div",{className:"max-w-4xl mx-auto",children:[i("div",{className:"text-center mb-8",children:[e("h1",{className:"text-2xl font-semibold text-foreground",children:"Product Configuration"}),e("p",{className:"text-foreground-500 mt-2",children:"Select and customize your product in a few simple steps"})]}),h&&e(ne,{color:"warning",variant:"flat",className:"mb-6",title:"Development Notice",description:h,startContent:e(N,{icon:"lucide:info",width:20})}),e(Ve,{data:t})]})})}):e("div",{className:"min-h-screen bg-background",children:e("div",{className:"py-12 px-4 sm:px-6",children:e("div",{className:"max-w-4xl mx-auto",children:e(ne,{color:"danger",variant:"flat",className:"mb-6",title:"Configuration Error",description:"Unable to load product configuration data. Please contact support.",startContent:e(N,{icon:"lucide:alert-triangle",width:20})})})})})}class Ke extends M.Component{constructor(r){super(r),this.state={hasError:!1,error:null}}static getDerivedStateFromError(r){return{hasError:!0,error:r}}componentDidCatch(r,a){try{console.error("ErrorBoundary caught error",r,a),window.__urbana_diag=window.__urbana_diag||{errors:[]},window.__urbana_diag.errors.push({type:"error_boundary",message:r.message,stack:r.stack||null,info:a})}catch{}}render(){var r,a,n,h,d;if(this.state.hasError){const c=typeof window<"u"&&(window.urbanaDebugMode||((r=window.urbanaAdmin)==null?void 0:r.debugMode)||((a=window.urbanaPublic)==null?void 0:a.debugMode)||!1);return i("div",{className:"p-8 bg-danger/5 border border-danger/10 rounded-medium text-center",children:[e("h2",{className:"text-lg font-semibold text-danger mb-2",children:"Something went wrong"}),e("p",{className:"text-sm text-default-600 mb-4",children:"An unexpected error occurred while rendering this application."}),e("pre",{className:"text-xs text-default-400 whitespace-pre-wrap",children:(n=this.state.error)==null?void 0:n.message}),c&&((h=this.state.error)==null?void 0:h.stack)&&i("details",{className:"mt-3 text-left text-xs text-default-400",children:[e("summary",{className:"cursor-pointer",children:"View stack trace"}),e("pre",{className:"whitespace-pre-wrap",children:(d=this.state.error)==null?void 0:d.stack})]})]})}return this.props.children}}var oe,le;if(typeof window<"u"){window.__urbana_diag=window.__urbana_diag||{errors:[]};try{(window.urbanaDebugMode||((oe=window.urbanaAdmin)==null?void 0:oe.debugMode)||((le=window.urbanaPublic)==null?void 0:le.debugMode)||!1)&&console.warn("[Urbana Stepper] ENTRY: bundle evaluated"),window.__urbana_diag.entryEvaluated=!0}catch{}}try{Se.createRoot(document.getElementById("urbana-stepper-root")).render(e(M.StrictMode,{children:i(De,{children:[e(Ce,{}),e(Ke,{children:e("main",{className:"text-foreground bg-background",children:e(Ye,{})})})]})}))}catch(t){console.error("[Urbana Stepper] render call failed",t);try{window.__urbana_diag=window.__urbana_diag||{errors:[]},window.__urbana_diag.errors.push({type:"render_error",message:String(t),stack:t&&t.stack?t.stack:null})}catch{}}var ce,de;if(typeof window<"u"){window.__urbana_diag=window.__urbana_diag||{errors:[]},window.addEventListener("error",t=>{try{const r=t&&(t.error&&t.error.message?t.error.message:t.message||String(t));console.error("[Urbana diag] global error:",r,t.error||t),window.__urbana_diag.errors.push({type:"error",message:r,stack:t&&t.error&&t.error.stack?t.error.stack:null})}catch{}},!0),window.addEventListener("unhandledrejection",t=>{try{const r=t&&(t.reason&&t.reason.message?t.reason.message:String(t.reason));console.error("[Urbana diag] unhandledrejection:",r,t.reason||t),window.__urbana_diag.errors.push({type:"unhandledrejection",message:r,stack:t&&t.reason&&t.reason.stack?t.reason.stack:null})}catch{}},!0);try{window.urbanaStepperEntry=!0;const t=window.urbanaDebugMode||((ce=window.urbanaAdmin)==null?void 0:ce.debugMode)||((de=window.urbanaPublic)==null?void 0:de.debugMode)||!1;t&&(console.warn("[Urbana Stepper] module entry"),console.log("[Urbana Stepper] attempting to render"));try{window.urbanaStepperLoaded=!0,t&&console.log("[Urbana Stepper] main bundle loaded")}catch(r){throw console.error("[Urbana Stepper] error setting loaded flag",r),window.__urbana_diag.errors.push({type:"flag_error",message:String(r),stack:r&&r.stack?r.stack:null}),r}}catch(t){console.error("[Urbana Stepper] module initialization error",t);try{window.__urbana_diag.errors.push({type:"init_error",message:String(t),stack:t&&t.stack?t.stack:null})}catch{}}}
