import{f as H,u as V,a as K,c as Y,j as e,b as D,I as f,R as I,r as b,d as P,e as C,s as J,l as Q,i as L,g as X,h as Z}from"./iconify.js";import{m as y}from"./proxy.js";import{c as ee,t as q,a as R}from"./chunk-ML27DD5T.js";import{i as te,a as se,b as _,p as T,c as A,T as ae}from"./productData.js";import{t as ie,c as ne,a as re,d as oe,p as le,H as ce}from"./middleware.js";import"./create-visual-element.js";import"./accelerated-values.js";var B=H((s,i)=>{var t;const{as:n,className:u,children:o,...a}=s,r=n||"div",m=V(i),{slots:p,classNames:h}=K(),j=Y(h==null?void 0:h.footer,u);return e.jsx(r,{ref:m,className:(t=p.footer)==null?void 0:t.call(p,{class:j}),...a,children:o})});B.displayName="HeroUI.CardFooter";var de=B;const ue=({currentStep:s,totalSteps:i,onNext:t,onPrevious:n,canProceed:u,isLastStep:o,isSubmitting:a,isSubmitted:r,onSubmit:m})=>e.jsxs("div",{className:"flex justify-between items-center pt-4",children:[e.jsx("div",{children:s>1&&e.jsx(D,{variant:"flat",color:"default",onPress:n,startContent:e.jsx(f,{icon:"lucide:arrow-left",width:18}),children:"Previous"})}),e.jsxs("div",{className:"text-default-500 text-sm",children:["Step ",s," of ",i]}),e.jsx("div",{children:o?e.jsx(D,{color:"primary",isDisabled:!u||a||r,isLoading:a,onPress:m,endContent:!a&&!r&&e.jsx(f,{icon:"lucide:send",width:18}),children:r?e.jsxs(y.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},className:"flex items-center gap-2",children:[e.jsx(f,{icon:"lucide:check",width:18}),"Submitted"]}):"Submit"}):e.jsx(D,{color:"primary",isDisabled:!u,onPress:t,endContent:e.jsx(f,{icon:"lucide:arrow-right",width:18}),children:"Next"})})]}),me=({currentStep:s,totalSteps:i,steps:t,selections:n,onStepClick:u})=>{const o=a=>a===1?!0:a===2?!!n.productGroup:a===3?!!n.productRange:a===4||a===5||a===6?!!n.individualProduct:!1;return e.jsx("div",{className:"hidden md:block mb-8",children:e.jsx("div",{className:"flex items-center justify-between",children:t.map(a=>{const r=a.step===s,m=a.step<s,p=o(a.step);return e.jsxs(I.Fragment,{children:[e.jsxs("div",{className:"flex flex-col items-center relative",children:[e.jsx("button",{className:`w-10 h-10 rounded-full flex items-center justify-center transition-all duration-200 ${r?"bg-primary text-white":m?"bg-success text-white":"bg-default-100 text-default-500"} ${p?"cursor-pointer hover:opacity-80":"cursor-not-allowed opacity-60"}`,onClick:()=>p&&u(a.step),disabled:!p,"aria-label":`Go to step ${a.step}: ${a.title}`,children:m?e.jsx(f,{icon:"lucide:check",width:20}):e.jsx("span",{children:a.step})}),e.jsx("span",{className:`text-xs mt-2 text-center max-w-[80px] ${r?"text-primary font-medium":"text-default-500"}`,children:a.title})]}),a.step<i&&e.jsx("div",{className:"flex-1 h-[2px] mx-2 bg-default-200",children:e.jsx("div",{className:"h-full bg-primary transition-all duration-300",style:{width:m?"100%":"0%"}})})]},a.step)})})})},pe=({data:s,selection:i,onSelect:t})=>{const n=b.useMemo(()=>{var a;return s.productGroups&&Array.isArray(s.productGroups)?s.productGroups.filter(r=>r.active!==!1):((a=s.categories)==null?void 0:a.map(r=>({id:r.toLowerCase().replace(/\s+/g,"-"),name:r,icon:he(r),description:xe(r),active:!0})))||[]},[s.productGroups,s.categories]),u={hidden:{opacity:0},show:{opacity:1,transition:{staggerChildren:.1}}},o={hidden:{opacity:0,y:20},show:{opacity:1,y:0}};return e.jsxs("div",{children:[e.jsx("p",{className:"text-default-600 mb-6",children:"Please select a product category to begin your configuration."}),e.jsx(y.div,{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4",variants:u,initial:"hidden",animate:"show",children:n.map(a=>e.jsx(y.div,{variants:o,children:e.jsx(P,{isPressable:!0,onPress:()=>t(a.name),className:`transition-all duration-200 ${i===a.name?"border-2 border-primary shadow-md":"border border-default-200 hover:border-primary hover:shadow-sm"}`,children:e.jsxs(C,{className:"flex flex-col items-center text-center p-6",children:[e.jsx("div",{className:`w-12 h-12 rounded-full flex items-center justify-center mb-3 ${i===a.name?"bg-primary text-white":"bg-default-100 text-default-500"}`,children:e.jsx(f,{icon:a.icon,width:24})}),e.jsx("h3",{className:"text-lg font-medium",children:a.name}),e.jsx("p",{className:"text-default-500 text-sm mt-1",children:a.description})]})})},a.id))})]})};function he(s){return{Shelter:"lucide:home",Toilet:"lucide:bath",Bridge:"lucide:route",Access:"lucide:wheelchair",Seating:"lucide:armchair",Lighting:"lucide:lamp"}[s]||"lucide:box"}function xe(s){return{Shelter:"Outdoor structures for shade and protection",Toilet:"Public and portable sanitation facilities",Bridge:"Pedestrian and light vehicle crossings",Access:"Ramps, stairs, and accessibility solutions",Seating:"Benches and outdoor furniture options",Lighting:"Outdoor and pathway lighting solutions"}[s]||"Product category"}const fe=({data:s,productGroup:i,selection:t,onSelect:n})=>{s.ranges[i];const u=b.useMemo(()=>{var m,p;if(s.productRanges&&s.relationships){const h=i.toLowerCase().replace(/\s+/g,"-"),j=((m=s.relationships.groupToRanges)==null?void 0:m[h])||[];return s.productRanges.filter(v=>j.includes(v.id)&&v.active!==!1)}return(((p=s.ranges)==null?void 0:p[i])||[]).map(h=>({id:h.toLowerCase().replace(/\s+/g,"-"),name:h,image:"",description:ge(h),tags:je(h),active:!0}))},[s.productRanges,s.relationships,s.ranges,i]),o={hidden:{opacity:0},show:{opacity:1,transition:{staggerChildren:.1}}},a={hidden:{opacity:0,y:20},show:{opacity:1,y:0}};return e.jsxs("div",{children:[e.jsxs("p",{className:"text-default-600 mb-6",children:["Select a product range from the ",i," category:"]}),e.jsx(y.div,{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",variants:o,initial:"hidden",animate:"show",children:u.map((r,m)=>{const p=t===r.name;return e.jsx(y.div,{variants:a,children:e.jsx(P,{isPressable:!0,onPress:()=>n(r.name),className:`transition-all duration-200 ${p?"border-2 border-primary shadow-md":"border border-default-200 hover:border-primary hover:shadow-sm"}`,children:e.jsx(C,{className:"p-0",children:e.jsxs("div",{className:"flex flex-col sm:flex-row",children:[r.image&&e.jsx(ee,{className:"p-0",children:e.jsx(te,{src:r.image,alt:r.name,className:"w-full h-40 object-cover",radius:"none"})}),e.jsxs("div",{className:"p-4 flex-1",children:[e.jsx("h3",{className:"text-lg font-medium",children:r.name}),e.jsx("p",{className:"text-default-500 text-sm mt-2",children:r.description}),e.jsx("div",{className:"mt-3 flex flex-wrap gap-2",children:r.tags.map(h=>e.jsx("span",{className:"text-xs px-2 py-1 bg-default-100 text-default-700 rounded-medium",children:h},h))})]})]})})})},r.id)})})]})};function ge(s){return{Peninsula:"Modern shelters with excellent weather protection for parks and urban settings",Whyalla:"Robust shelters designed for coastal and high-wind environments",Coastal:"Corrosion-resistant designs perfect for beachfront and marine locations",Urban:"Contemporary designs that blend with modern city landscapes",Heritage:"Traditional designs that complement historic and cultural settings",EcoSan:"Environmentally friendly composting toilet solutions with minimal water usage",Standard:"Reliable and cost-effective public toilet facilities",Accessible:"Fully compliant accessible toilet facilities with enhanced features",Premium:"High-end toilet facilities with superior finishes and amenities",Compact:"Space-saving designs for areas with limited footprint","Small Span":"Compact bridges for garden paths and small water crossings","Large Span":"Extended bridges for wider crossings and heavier loads",Pedestrian:"Dedicated walkways designed for high foot traffic areas","Decorative Bridge":"Ornamental bridges that serve as landscape features","Heavy Duty":"Reinforced bridges capable of supporting maintenance vehicles",Ramp:"Gentle slope access solutions for wheelchairs and strollers",Staircase:"Step access with various configurations and safety features",Pathway:"Connected walkway systems for parks and public spaces",Boardwalk:"Elevated walkways for wetlands and sensitive environments",Platform:"Viewing platforms and elevated observation areas",Bench:"Traditional seating options for parks and public spaces","Table Setting":"Combined table and seating arrangements for picnic areas",Lounge:"Comfortable extended seating for relaxation areas",Stadium:"Tiered seating solutions for sports and event venues",Custom:"Bespoke seating arrangements designed to specification",Solar:"Self-sufficient lighting powered by renewable energy","Mains Powered":"Connected lighting solutions with reliable performance","Decorative Light":"Aesthetic lighting features that enhance landscapes",Security:"High visibility lighting for safety and security","Pathway Light":"Directional lighting for walkways and pedestrian areas"}[s]||`${s} product line with various options and configurations.`}function je(s,i){const t={Peninsula:["Modern","Weather-resistant","Versatile"],Whyalla:["Robust","Wind-resistant","Durable"],Coastal:["Corrosion-resistant","Salt-proof","UV-stable"],Urban:["Contemporary","Modular","Space-efficient"],Heritage:["Traditional","Ornate","Classic"],EcoSan:["Eco-friendly","Low-water","Composting"],Standard:["Cost-effective","Reliable","Low-maintenance"],Accessible:["ADA Compliant","Spacious","Universal"],Premium:["High-end","Enhanced features","Superior finishes"],Compact:["Space-saving","Efficient","Urban-friendly"],"Small Span":["Compact","Decorative","Easy-install"],"Large Span":["Extended","Reinforced","Heavy-load"],Pedestrian:["High-traffic","Safety-focused","Accessible"],Decorative:["Ornamental","Artistic","Feature piece"],"Heavy Duty":["Vehicle-rated","Industrial","Maximum strength"],default:["Quality","Durable","Customizable"]};return t[s]||t.default}const be=({data:s,productRange:i,selection:t,onSelect:n})=>{s.products[i];const u=b.useMemo(()=>{var m;if(s.productsData&&s.relationships){const p=i.toLowerCase().replace(/\s+/g,"-"),h=s.relationships.rangeToProducts[p]||[];return s.productsData.filter(j=>h.includes(j.id)&&j.active!==!1)}return(((m=s.products)==null?void 0:m[i])||[]).map(p=>({id:p.toLowerCase(),code:p,name:`${p} Product`,overview:U(p),description:U(p),specifications:[],imageGallery:[],files:{},active:!0}))},[s.productsData,s.relationships,s.products,i]),o={hidden:{opacity:0},show:{opacity:1,transition:{staggerChildren:.05}}},a={hidden:{opacity:0,y:10},show:{opacity:1,y:0}};return e.jsxs("div",{children:[e.jsxs("p",{className:"text-default-600 mb-6",children:["Select a specific product from the ",i," range:"]}),e.jsx(y.div,{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4",variants:o,initial:"hidden",animate:"show",children:u.map(r=>{const m=t===r.code;return r.imageGallery.length>0,e.jsx(y.div,{variants:a,children:e.jsxs(P,{isPressable:!0,onPress:()=>n(r.code),className:`h-full w-full transition-all duration-200 ${m?"border-2 border-primary shadow-md":"border border-default-200 hover:border-primary hover:shadow-sm"}`,children:[e.jsxs(C,{className:"p-4",children:[e.jsx("div",{className:"flex items-center justify-center mb-3",children:e.jsx("h3",{className:"text-lg font-medium",children:r.name})}),e.jsx("p",{className:"text-default-500 text-sm text-center",children:r.overview||r.description}),r.specifications.length>0&&e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-xs font-semibold text-default-700 text-center",children:"Key Features:"}),e.jsxs("div",{className:"text-xs text-default-500",children:[r.specifications.slice(0,3).map((p,h)=>e.jsxs("div",{className:"flex items-start justify-center",children:[e.jsx(f,{icon:"lucide:check",width:14,className:"mr-1 mt-0.5 text-success"}),e.jsx("span",{children:p})]},h)),r.specifications.length>3&&e.jsxs("div",{className:"text-default-400 mt-1",children:["+",r.specifications.length-3," more features"]})]})]})]}),Object.keys(r.files).length>0&&e.jsx(de,{className:"border-t border-default-100 px-4 py-2 justify-center",children:e.jsxs("div",{className:"flex items-center gap-2 text-xs text-default-600",children:[e.jsx(f,{icon:"lucide:file-text",width:14}),e.jsxs("span",{children:[Object.keys(r.files).length," document",Object.keys(r.files).length!==1?"s":""," available"]})]})})]})},r.id)})})]})};function U(s){const i=s.match(/[A-Z]+\d+/),t=i?i[0]:s;return{K301:"Compact shelter with modern design, suitable for parks and urban settings.",K302:"Medium-sized shelter with extended roof coverage for picnic areas.",K308:"Large shelter with multiple seating options and enhanced weather protection.",K310:"Premium shelter with architectural design elements and superior materials.",K315:"Deluxe shelter with integrated seating and optional power connections.",E201:"Eco-friendly toilet with composting technology and minimal water usage.",E202:"Solar-powered toilet facility with self-contained waste management.",SS101:"Small pedestrian bridge for garden paths and decorative water crossings.",SS102:"Compact bridge with enhanced load capacity for light maintenance vehicles.",R101:"ADA compliant access ramp with gentle slope and non-slip surface.",R102:"Modular ramp system adaptable to various height requirements."}[t]||`${s} model with standard features and customization options.`}const M=({imagePath:s,productCode:i,className:t="",alt:n="Product image"})=>{const[u,o]=b.useState(""),[a,r]=b.useState(!0),[m,p]=b.useState("");return b.useEffect(()=>{s&&(async()=>{var j,v;try{r(!0),p("");const w=((j=window.urbanaPublic)==null?void 0:j.nonce)||((v=window.urbanaAdmin)==null?void 0:v.nonce)||"",d=await fetch("/wp-json/urbana/v1/image-proxy",{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":w},body:JSON.stringify({image_path:s})});if(!d.ok)throw new Error(`HTTP ${d.status}: ${d.statusText}`);const c=await d.json();if(c.success)c.image_data?o(c.image_data):c.imageData?o(c.imageData):(o("data:image/png;base64,PLACEHOLDER_BASE64"),console.warn("No image data in response, using placeholder"));else throw new Error(c.message||"Failed to get image")}catch(w){p(w.message)}finally{r(!1)}})()},[s,i]),a?e.jsx("div",{className:`${t} bg-gray-100 animate-pulse flex items-center justify-center`,children:e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",className:"text-gray-400",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"2",fill:"none"}),e.jsx("path",{d:"M12 6v6l4 2",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]})}):m||!u?e.jsx("div",{className:`${t} bg-orange-100 border-2 border-orange-300 flex items-center justify-center`,children:e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",className:"text-orange-600",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"2",fill:"none"}),e.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"}),e.jsx("line",{x1:"12",y1:"16",x2:"12.01",y2:"16",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})]})}):e.jsx("img",{src:u,alt:n,className:t,onError:()=>{p("Image load failed")}})},ve=({data:s,productId:i})=>{const t=s.productDetails[i],n=b.useCallback(async(a,r)=>{try{const m=a.includes("digitaloceanspaces.com");let p=a;if(m)try{let v=(new URL(a).pathname||"").replace(/^\//,"");if(v){const w=new URL("/wp-json/urbana/v1/proxy-download",window.location.origin);w.searchParams.set("path",v),p=w.toString()}else{const w=new URL("/wp-json/urbana/v1/proxy-download",window.location.origin);w.searchParams.set("url",a),p=w.toString()}}catch{const v=new URL("/wp-json/urbana/v1/proxy-download",window.location.origin);v.searchParams.set("url",a),p=v.toString()}else if(!/^https?:\/\//i.test(a)){const j=new URL("/wp-json/urbana/v1/proxy-download",window.location.origin);j.searchParams.set("path",a),p=j.toString()}const h=document.createElement("a");h.href=p,h.download=r,h.style.display="none",h.target="_blank",document.body.appendChild(h),h.click(),document.body.removeChild(h)}catch(m){console.error("Download failed:",m),alert("Failed to download file. Please try again or contact support.")}},[]);if(!t)return e.jsxs("div",{className:"text-center p-8",children:[e.jsx(f,{icon:"lucide:file-question",className:"mx-auto mb-4 text-default-400",width:48}),e.jsx("h3",{className:"text-xl font-medium mb-2",children:"Product Information Unavailable"}),e.jsxs("p",{className:"text-default-500",children:["Detailed information for ",i," is not available at this time. Please continue to the next step or contact our support team for assistance."]})]});const u={hidden:{opacity:0},show:{opacity:1,transition:{duration:.5}}},o=t.imageGallery.length>0?t.imageGallery[0]:"";return e.jsxs(y.div,{className:"space-y-8",initial:"hidden",animate:"show",variants:u,children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-6",children:[e.jsx("div",{className:"w-full md:w-1/2",children:o?e.jsx(M,{imagePath:o,productCode:i,alt:t.name,className:"w-full h-64 object-cover rounded-medium"}):e.jsx("div",{className:"w-full h-64 bg-gray-100 rounded-medium flex items-center justify-center",children:e.jsx(f,{icon:"lucide:image",width:48,className:"text-gray-400"})})}),e.jsxs("div",{className:"w-full md:w-1/2",children:[e.jsx("h3",{className:"text-xl font-semibold mb-2",children:t.name}),e.jsx("p",{className:"text-default-600 mb-4",children:t.overview}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(f,{icon:"lucide:check-circle",className:"text-success",width:20}),e.jsx("span",{children:"In Stock"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(f,{icon:"lucide:truck",className:"text-default-500",width:20}),e.jsx("span",{children:"Standard Delivery: 2-4 weeks"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(f,{icon:"lucide:shield",className:"text-default-500",width:20}),e.jsx("span",{children:"10 Year Warranty"})]})]})]})]}),e.jsxs(q,{"aria-label":"Product information tabs",variant:"underlined",color:"primary",children:[e.jsx(R,{title:"Details",children:e.jsx(P,{children:e.jsx(C,{className:"p-6",children:e.jsxs("div",{className:"prose max-w-none",children:[e.jsx("p",{className:"text-default-700",children:t.description}),e.jsx("h4",{className:"text-lg font-medium mt-6 mb-3",children:"Specifications"}),e.jsx("ul",{className:"space-y-2",children:t.specifications.map((a,r)=>e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(f,{icon:"lucide:chevron-right",className:"text-primary mt-1 flex-shrink-0",width:16}),e.jsx("span",{children:a})]},r))})]})})})},"details"),e.jsx(R,{title:"Image Gallery",children:e.jsx(P,{children:e.jsx(C,{className:"p-6",children:e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4",children:t.imageGallery.map((a,r)=>e.jsx("div",{className:"aspect-square",children:e.jsx(M,{imagePath:a,productCode:i,alt:`${t.name} - Image ${r+1}`,className:"w-full h-full object-cover rounded-medium"})},r))})})})},"gallery"),e.jsx(R,{title:"Downloads",children:e.jsx(P,{children:e.jsx(C,{className:"p-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-default-600 mb-4",children:"Download product documentation and technical files:"}),e.jsx("div",{className:"space-y-3",children:Object.entries(t.files).map(([a,r])=>e.jsxs("div",{className:"flex items-center justify-between p-3 border border-default-200 rounded-medium hover:border-primary transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-default-100 rounded-medium",children:e.jsx(f,{icon:ye(r),className:"text-default-600",width:20})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:a}),e.jsx("p",{className:"text-xs text-default-500",children:we(r)})]})]}),e.jsx(D,{size:"sm",variant:"flat",color:"primary",onPress:()=>n(r,Ne(r,a)),endContent:e.jsx(f,{icon:"lucide:download",width:16}),children:"Download"})]},r))})]})})})},"files"),e.jsx(R,{title:"FAQ",children:e.jsx(P,{children:e.jsx(C,{className:"p-6",children:e.jsx(se,{children:t.faqs&&t.faqs.length>0?t.faqs.map((a,r)=>e.jsx(_,{title:a.question,children:a.answer},r)):[{q:"What is the installation process?",a:"Installation typically requires a concrete foundation and can be completed by our certified installers. The process usually takes 1-3 days depending on the product complexity and site conditions."},{q:"What maintenance is required?",a:"Our products are designed for minimal maintenance. We recommend a visual inspection every 6 months and cleaning as needed. Specific maintenance schedules are provided in the product documentation."},{q:"Are customizations available?",a:"Yes, most products can be customized with different colors, materials, and additional features. Custom options can be selected in the next step of this configuration process."},{q:"What warranty is provided?",a:"Standard warranty is 10 years on structural components and 5 years on other elements. Extended warranties are available for purchase. All warranties cover manufacturing defects and normal wear."}].map((a,r)=>e.jsx(_,{title:a.q,children:a.a},`fallback-${r}`))})})})},"faq")]})]})};function ye(s){var n;const i=(n=s.split(".").pop())==null?void 0:n.toLowerCase(),t={pdf:"lucide:file-text",dwg:"lucide:file-cog",rvt:"lucide:file-3d",doc:"lucide:file-text",docx:"lucide:file-text",xls:"lucide:file-spreadsheet",xlsx:"lucide:file-spreadsheet",zip:"lucide:file-archive",default:"lucide:file"};return t[i||""]||t.default}function we(s){var n;const i=(n=s.split(".").pop())==null?void 0:n.toLowerCase(),t={pdf:"2.4 MB",dwg:"5.8 MB",rvt:"12.6 MB",doc:"1.2 MB",docx:"1.5 MB",xls:"3.1 MB",xlsx:"3.4 MB",zip:"8.7 MB",default:"1.0 MB"};return t[i||""]||t.default}function Ne(s,i){try{let n="";try{n=(new URL(s).pathname||"").split("/").pop()||""}catch{const o=s.split("/");n=o[o.length-1]||""}if(n=n.split("?")[0].split("#")[0],n&&n.includes("."))return decodeURIComponent(n)}catch(n){console.error("Error extracting filename from URL:",n)}const t=(s.split(".").pop()||"").toLowerCase().split("?")[0].split("#")[0];return t&&!i.includes(".")?`${i}.${t}`:i}const Se=({data:s,options:i,onOptionsChange:t,selectedProductCode:n})=>{const u=b.useRef(n),o=b.useRef(null),a=b.useMemo(()=>{var d;return n?(d=s.productOptions)!=null&&d[n]?s.productOptions[n]:{}:s.options},[n,s.productOptions,s.options]);console.log(s);const r=b.useMemo(()=>Object.keys(a).length>0,[a]),m=b.useMemo(()=>{const d={};return Object.keys(a).forEach(x=>{i[x]&&(d[x]=i[x])}),d},[i,a]);b.useEffect(()=>{if(u.current!==n){u.current=n;const d=Object.keys(a),c=Object.keys(i);if(c.some(g=>!d.includes(g))||c.length===0){const g={};c.forEach(N=>{d.includes(N)&&(g[N]=i[N])}),JSON.stringify(g)!==JSON.stringify(i)&&t(g)}}},[n,a]);const p=b.useCallback((d,c)=>{o.current=d,t({...m,[d]:c})},[m,t]),h=b.useMemo(()=>{var c;const d=Object.keys(a);if(d.length===0)return null;if(o.current&&i[o.current]){const x=(c=a[o.current])==null?void 0:c.find(g=>g.value===i[o.current]);if(x!=null&&x.imageUrl)return x.imageUrl}for(let x=d.length-1;x>=0;x--){const g=d[x],O=i[g];if(O&&a[g]){const N=a[g].find(l=>l.value===O);if(N!=null&&N.imageUrl)return N.imageUrl}}return null},[i,a]),j=b.useMemo(()=>{var d;if(n&&((d=s.productDetails)!=null&&d[n])){const c=s.productDetails[n].imageGallery;if(c&&c.length>0)return c[0]}return"https://img.heroui.chat/image/landscape?w=800&h=600&u=preview_default"},[n,s.productDetails]),v=h||j,w={hidden:{opacity:0},show:{opacity:1,transition:{duration:.5}}};return r?e.jsxs(y.div,{className:"space-y-6",initial:"hidden",animate:"show",variants:w,children:[n&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-default-600",children:[e.jsx(f,{icon:"lucide:package",width:16}),e.jsxs("span",{children:["Configuring options for: ",e.jsx("strong",{children:n})]})]}),e.jsx("p",{className:"text-default-600 mb-4",children:"Customize your product by selecting from the available options below:"}),e.jsxs(q,{"aria-label":"Product configuration tabs",variant:"underlined",color:"primary",children:[e.jsx(R,{title:"Configuration Options",children:e.jsx(P,{children:e.jsx(C,{className:"p-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx("div",{className:"space-y-4",children:Object.entries(a).map(([d,c])=>e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-default-700",children:d}),e.jsx(J,{label:d,placeholder:`Select ${d}`,selectedKeys:i[d]?[i[d]]:[],onChange:x=>{const g=x.target.value;o.current=d,p(d,g)},className:"max-w-full",children:c.map(x=>e.jsx(Q,{children:typeof x=="string"?x:x.value},typeof x=="string"?x:x.value))})]},d))}),e.jsx("div",{children:e.jsxs("div",{className:"border border-default-200 rounded-medium p-4",children:[e.jsx("h4",{className:"text-sm font-medium mb-2",children:"Preview"}),e.jsx("div",{className:"aspect-video mb-4",children:e.jsx(M,{imagePath:v,productCode:n||"",className:"w-full h-full object-cover rounded-medium"},v)}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h5",{className:"text-xs font-medium text-default-500",children:"Selected Options:"}),Object.keys(m).length>0?e.jsx("ul",{className:"text-sm space-y-1",children:Object.entries(m).map(([d,c])=>e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(f,{icon:"lucide:check",className:"text-success",width:14}),e.jsxs("span",{className:"font-medium",children:[d,":"]})," ",c]},d))}):e.jsx("p",{className:"text-sm text-default-500",children:"No options selected yet. Choose from the available options."})]})]})})]})})})},"options"),e.jsx(R,{title:"Option Impact",children:e.jsx(P,{children:e.jsx(C,{className:"p-6",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"text-lg font-medium",children:"How Options Affect Your Product"}),e.jsx("p",{className:"text-default-600",children:"Different options can impact the appearance, durability, and functionality of your product. Below is a summary of how each option affects your selection."})]}),e.jsx("div",{className:"space-y-4",children:Object.entries(a).map(([d,c])=>e.jsxs("div",{className:"border-b border-default-200 pb-4 last:border-0",children:[e.jsx("h5",{className:"font-medium mb-2",children:d}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:c.map((x,g)=>{const O=typeof x=="string"?x:x.value,N=typeof x=="object"&&x.imageUrl?x.imageUrl:null;return e.jsxs("div",{className:"p-3 border border-default-200 rounded-medium",children:[N&&e.jsx("div",{className:"aspect-video mb-2 rounded-small overflow-hidden",children:e.jsx(M,{imagePath:N,productCode:n||"",className:"w-full h-full object-cover"})}),e.jsx("div",{className:"font-medium",children:O}),e.jsxs("div",{className:"text-sm text-default-500",children:[g===0&&"Standard option with included features",g===1&&"Enhanced durability and premium finish",g===2&&"Maximum performance and longevity"]})]},O)})})]},d))})]})})})},"impact"),e.jsx(R,{title:"Pricing Impact",children:e.jsx(P,{children:e.jsx(C,{className:"p-6",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"text-lg font-medium",children:"Option Pricing"}),e.jsx("p",{className:"text-default-600",children:"Different configuration options affect the final price of your product. Below is a breakdown of how each selection impacts pricing."})]}),e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-default-200",children:[e.jsx("th",{className:"py-2 px-4 text-left font-medium",children:"Option"}),e.jsx("th",{className:"py-2 px-4 text-left font-medium",children:"Selection"}),e.jsx("th",{className:"py-2 px-4 text-right font-medium",children:"Price Impact"})]})}),e.jsx("tbody",{children:Object.entries(a).map(([d,c])=>e.jsx(I.Fragment,{children:c.map((x,g)=>{const O=typeof x=="string"?x:x.value;return e.jsxs("tr",{className:"border-b border-default-100",children:[g===0?e.jsx("td",{className:"py-2 px-4 align-top",rowSpan:c.length,children:d}):null,e.jsxs("td",{className:"py-2 px-4",children:[O,g===0&&e.jsx("span",{className:"text-xs text-default-400 ml-2",children:"(Standard)"})]}),e.jsx("td",{className:"py-2 px-4 text-right",children:g===0?"Included":`+$${(g*250+Math.random()*100).toFixed(0)}`})]},`${d}-${O}`)})},d))})]}),e.jsx("div",{className:"bg-default-50 p-4 rounded-medium",children:e.jsxs("p",{className:"text-sm text-default-600",children:[e.jsx(f,{icon:"lucide:info",className:"inline-block mr-2",width:16}),"For exact pricing including all options and installation, please complete the form in the next step and our team will provide a detailed quote."]})})]})})})},"pricing")]})]}):e.jsx(y.div,{className:"space-y-6",initial:"hidden",animate:"show",variants:w,children:e.jsx(P,{children:e.jsxs(C,{className:"p-8 text-center",children:[e.jsx(f,{icon:"lucide:settings",width:48,className:"text-default-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"No Configuration Options"}),e.jsx("p",{className:"text-default-600",children:n?e.jsxs(e.Fragment,{children:["This product doesn't have any configurable options.",e.jsxs("span",{className:"block mt-2 text-sm",children:["Product: ",e.jsx("strong",{children:n})]})]}):"Please select a product first to see available configuration options."}),e.jsx("p",{className:"text-sm text-default-500 mt-4",children:n?"Proceed to the next step to complete your inquiry.":"Go back to the previous step and select a product."})]})})})},Pe=({data:s,contactInfo:i,onContactInfoChange:t,isSubmitting:n,isSubmitted:u,onSubmit:o})=>{const[a,r]=I.useState(!1),[m,p]=I.useState({}),h=(c,x)=>{t({...i,[c]:x}),m[c]&&p({...m,[c]:""})},j=()=>{const c={};return i.fullName.trim()||(c.fullName="Full name is required"),i.email.trim()?/^\S+@\S+\.\S+$/.test(i.email)||(c.email="Please enter a valid email address"):c.email="Email is required",a||(c.terms="You must accept the terms and conditions"),p(c),Object.keys(c).length===0},v=()=>{j()&&o()},w={hidden:{opacity:0},show:{opacity:1,transition:{staggerChildren:.1}}},d={hidden:{opacity:0,y:20},show:{opacity:1,y:0}};return u?e.jsxs(y.div,{className:"text-center py-8",initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:.5},children:[e.jsx("div",{className:"w-16 h-16 bg-success/20 rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx(f,{icon:"lucide:check",className:"text-success",width:32})}),e.jsx("h3",{className:"text-xl font-semibold mb-2",children:"Thank You!"}),e.jsx("p",{className:"text-default-600 max-w-md mx-auto mb-6",children:"Your product configuration has been submitted successfully. Our team will review your selections and contact you shortly with pricing and next steps."})]}):e.jsxs(y.div,{className:"space-y-6",variants:w,initial:"hidden",animate:"show",children:[e.jsx(y.p,{variants:d,className:"text-default-600",children:"Please provide your contact information to receive a detailed quote for your configured product."}),e.jsxs(y.div,{variants:d,className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(L,{label:"Full Name",placeholder:"Enter your full name",value:i.fullName,onValueChange:c=>h("fullName",c),isRequired:!0,isInvalid:!!m.fullName,errorMessage:m.fullName}),e.jsx(L,{label:"Email Address",placeholder:"Enter your email address",type:"email",value:i.email,onValueChange:c=>h("email",c),isRequired:!0,isInvalid:!!m.email,errorMessage:m.email})]}),e.jsxs(y.div,{variants:d,className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(L,{label:"Phone Number",placeholder:"Enter your phone number",type:"tel",value:i.phone,onValueChange:c=>h("phone",c)}),e.jsx(L,{label:"Company/Organization",placeholder:"Enter your company or organization",value:i.company,onValueChange:c=>h("company",c)})]}),e.jsx(y.div,{variants:d,children:e.jsx(ie,{label:"Additional Notes",placeholder:"Enter any specific requirements or questions",value:i.message,onValueChange:c=>h("message",c),minRows:3})}),e.jsxs(y.div,{variants:d,className:"space-y-4",children:[e.jsx(ne,{isSelected:a,onValueChange:r,isInvalid:!!m.terms,children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{children:"I agree to the Terms and Conditions and Privacy Policy"}),m.terms&&e.jsx("span",{className:"text-danger text-xs mt-1",children:m.terms})]})}),e.jsx("div",{className:"bg-default-50 p-4 rounded-medium text-sm text-default-600",children:e.jsxs("p",{className:"flex items-start gap-2",children:[e.jsx(f,{icon:"lucide:shield",className:"text-default-500 mt-0.5 flex-shrink-0",width:16}),e.jsx("span",{children:"Your information is secure and will only be used to process your product inquiry. We will never share your details with third parties without your consent."})]})})]}),e.jsx(y.div,{variants:d,className:"pt-4",children:e.jsx(D,{color:"primary",size:"lg",className:"w-full md:w-auto",isDisabled:n,isLoading:n,onPress:v,endContent:!n&&e.jsx(f,{icon:"lucide:send",width:18}),children:"Submit Configuration"})})]})},$={productGroup:null,productRange:null,individualProduct:null,options:{},contactInfo:{fullName:"",email:"",phone:"",company:"",message:""}},E=re()(oe(le((s,i)=>({productData:null,currentStep:1,selections:$,isSubmitting:!1,isSubmitted:!1,initializeProductData:()=>{const t=window.urbanaPublic;t!=null&&t.productData?(console.log("Initializing stepper with database product data"),s({productData:t.productData})):console.warn("No database product data found in window.urbanaPublic")},setProductData:t=>{s({productData:t})},setCurrentStep:t=>s({currentStep:t}),updateSelection:(t,n)=>s(u=>{const o={...u.selections};return t==="productGroup"?(o.productGroup=n,o.productRange=null,o.individualProduct=null):t==="productRange"?(o.productRange=n,o.individualProduct=null):t==="options"?o.options={...o.options,...n}:t==="contactInfo"?o.contactInfo={...o.contactInfo,...n}:o[t]=n,{selections:o}}),nextStep:()=>s(t=>({currentStep:Math.min(t.currentStep+1,6)})),previousStep:()=>s(t=>({currentStep:Math.max(t.currentStep-1,1)})),goToStep:t=>{var a,r;const{selections:n,productData:u}=i(),o=((r=(a=u==null?void 0:u.stepperForm)==null?void 0:a.steps)==null?void 0:r.length)||6;return t<1||t>o?!1:t===1||t===2&&n.productGroup||t===3&&n.productRange||t>=4&&n.individualProduct?(s({currentStep:t}),!0):!1},setSubmitting:t=>s({isSubmitting:t}),setSubmitted:t=>s({isSubmitted:t}),resetStepper:()=>s({currentStep:1,selections:$,isSubmitting:!1,isSubmitted:!1}),canProceedToStep:t=>{var a,r;const{selections:n,productData:u}=i(),o=((r=(a=u==null?void 0:u.stepperForm)==null?void 0:a.steps)==null?void 0:r.length)||6;if(t>o)return!1;switch(t){case 1:return!0;case 2:return!!n.productGroup;case 3:return!!n.productRange;case 4:case 5:case 6:return!!n.individualProduct;default:return!1}}}),{name:"urbana-stepper-storage",partialize:s=>({selections:s.selections,currentStep:s.currentStep})}),{name:"urbana-stepper"})),Ce=({data:s})=>{const{currentStep:i,selections:t,isSubmitting:n,isSubmitted:u,updateSelection:o,nextStep:a,previousStep:r,goToStep:m,canProceedToStep:p}=E(),h=s.stepperForm.steps.length,j=b.useMemo(()=>{var F;if(!t.individualProduct)return{};const l=s.stepperForm.steps[4],k=(F=l==null?void 0:l.productOptions)==null?void 0:F[t.individualProduct];if(!k)return{};const S={},z=Object.keys(k);return Object.entries(t.options).forEach(([G,W])=>{z.includes(G)&&(S[G]=W)}),S},[t.individualProduct,t.options,s.stepperForm.steps]);b.useEffect(()=>{console.log("[ProductStepper] currentStep:",i),console.log("[ProductStepper] selections:",t),console.log("[ProductStepper] stepData:",s.stepperForm.steps[i-1]),console.log("[ProductStepper] validProductOptions:",j)},[i,t,s.stepperForm.steps,j]);const v=b.useCallback(async()=>{var l;E.getState().setSubmitting(!0);try{const k={productGroup:t.productGroup,productRange:t.productRange,individualProduct:t.individualProduct,options:j,contactInfo:t.contactInfo};if(console.log("Submitting form data:",k),!(await fetch("/wp-json/urbana/v1/submit-form",{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":((l=window.urbanaPublic)==null?void 0:l.nonce)||""},body:JSON.stringify({selections:k,submittedAt:new Date().toISOString()})})).ok)throw new Error("Failed to submit form");E.getState().setSubmitted(!0)}catch(k){console.error("Error submitting form:",k),alert("Failed to submit form. Please try again.")}finally{E.getState().setSubmitting(!1)}},[t,j]),w=l=>{m(l)},d=()=>{a()},c=()=>{r()},x=I.useCallback(()=>{const l=s.stepperForm.steps[i-1];switch(i){case 1:return e.jsx(pe,{data:{categories:(l==null?void 0:l.categories)||[],productGroups:(l==null?void 0:l.productGroups)||[]},selection:t.productGroup||null,onSelect:S=>o("productGroup",S)});case 2:return e.jsx(fe,{data:{ranges:(l==null?void 0:l.ranges)||{},productRanges:(l==null?void 0:l.productRanges)||[],relationships:l==null?void 0:l.relationships},productGroup:t.productGroup||"",selection:t.productRange||null,onSelect:S=>o("productRange",S)});case 3:return e.jsx(be,{data:{products:(l==null?void 0:l.products)||{},productsData:(l==null?void 0:l.productsData)||[],relationships:l==null?void 0:l.relationships},productRange:t.productRange||"",selection:t.individualProduct||null,onSelect:S=>o("individualProduct",S)});case 4:const k=t.individualProduct||"unknown-product";return console.log("Step 4 Data:",l==null?void 0:l.productDetails),console.log("Product ID:",k),e.jsx(ve,{data:{productDetails:(l==null?void 0:l.productDetails)||{}},productId:k});case 5:return e.jsx(Se,{data:{options:(l==null?void 0:l.options)||{},productOptions:(l==null?void 0:l.productOptions)||{},dynamicUpdates:(l==null?void 0:l.dynamicUpdates)||{updateImages:!1,updateFiles:!1}},options:t.options||{},onOptionsChange:S=>o("options",S),selectedProductCode:t.individualProduct||void 0});case 6:return e.jsx(Pe,{data:{fields:(l==null?void 0:l.fields)||[]},contactInfo:t.contactInfo,onContactInfoChange:S=>o("contactInfo",S),isSubmitting:n,isSubmitted:u,onSubmit:v});default:return e.jsx("div",{children:"Unknown step"})}},[i,s.stepperForm.steps,t,o,n,u,v]),g=p(i+1),O=i===h,N={hidden:{opacity:0,x:10},visible:{opacity:1,x:0},exit:{opacity:0,x:-10}};return e.jsxs("div",{className:"space-y-6",children:[e.jsx(me,{currentStep:i,totalSteps:h,steps:s.stepperForm.steps,selections:t,onStepClick:w}),e.jsx(P,{className:"shadow-sm",children:e.jsx(C,{className:"p-6",children:e.jsxs(y.div,{initial:"hidden",animate:"visible",exit:"exit",variants:N,transition:{duration:.25},children:[e.jsx("h2",{className:"text-xl font-semibold mb-6",children:s.stepperForm.steps[i-1].title}),x()]},i)})}),e.jsx(ue,{currentStep:i,totalSteps:h,onNext:d,onPrevious:c,canProceed:g,isLastStep:O,isSubmitting:n,isSubmitted:u,onSubmit:v})]})};function Oe(){const{productData:s,initializeProductData:i}=E(),[t,n]=b.useState(!0),[u,o]=b.useState(null);return b.useEffect(()=>{try{const a=window.urbanaPublic;a!=null&&a.productData?(console.log("Loading product data from database:",a.productData),i(),o(null)):(console.warn("No product data found in window.urbanaPublic, using default data"),E.getState().setProductData(T),o("Using default product data - database may be empty"))}catch(a){console.error("Error initializing product data:",a),o("Failed to load product data"),E.getState().setProductData(T)}finally{n(!1)}},[i]),t?e.jsx("div",{className:"min-h-screen bg-background",children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx(X,{size:"lg"}),e.jsx("p",{className:"text-foreground-600",children:"Loading product configuration..."})]})})}):s?e.jsx("div",{className:"min-h-screen bg-background",children:e.jsx("div",{className:"py-12 px-4 sm:px-6",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-2xl font-semibold text-foreground",children:"Product Configuration"}),e.jsx("p",{className:"text-foreground-500 mt-2",children:"Select and customize your product in a few simple steps"})]}),u&&e.jsx(A,{color:"warning",variant:"flat",className:"mb-6",title:"Development Notice",description:u,startContent:e.jsx(f,{icon:"lucide:info",width:20})}),e.jsx(Ce,{data:s})]})})}):e.jsx("div",{className:"min-h-screen bg-background",children:e.jsx("div",{className:"py-12 px-4 sm:px-6",children:e.jsx("div",{className:"max-w-4xl mx-auto",children:e.jsx(A,{color:"danger",variant:"flat",className:"mb-6",title:"Configuration Error",description:"Unable to load product configuration data. Please contact support.",startContent:e.jsx(f,{icon:"lucide:alert-triangle",width:20})})})})})}Z.createRoot(document.getElementById("urbana-stepper-root")).render(e.jsx(I.StrictMode,{children:e.jsxs(ce,{children:[e.jsx(ae,{}),e.jsx("main",{className:"text-foreground bg-background",children:e.jsx(Oe,{})})]})}));
